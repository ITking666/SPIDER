head	1.6;
access;
symbols;
locks; strict;
comment	@# @;


1.6
date	2019.02.12.17.13.22;	author leith;	state Exp;
branches;
next	1.5;

1.5
date	2019.02.06.19.19.04;	author leith;	state Exp;
branches;
next	1.4;

1.4
date	2019.01.16.19.03.22;	author leith;	state Exp;
branches;
next	1.3;

1.3
date	2019.01.10.16.56.24;	author leith;	state Exp;
branches;
next	1.2;

1.2
date	2019.01.10.16.10.30;	author leith;	state Exp;
branches;
next	1.1;

1.1
date	2019.01.09.20.27.43;	author leith;	state Exp;
branches;
next	;


desc
@@


1.6
log
@update
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>

<head>
    <title>Particle-picking procedure files</title>
</head>

<body>

<p />

<p align="right">
<i>(Updated 2013 Jan 21)</i> </p>

<p> 
<h2 align="center"> <b>Particle verification for single-particle, 
   reference-based reconstruction 
   using multivariate data analysis and classification   </b>         <br />
   As described in <i>J Struct Biol </i> (2008) 
   <b>161   </b>: 41-48. <br />
   <b>Out of date, legacy protocol, with dead links?    </b> 
</h2>
</p>

<hr />

<p>
<a name="top">
<h3 align="left"> <b> Outline </b> </h3> 
</p>

<ul>
    <li><a href="#links">Links</a>                      </li>
    <li><a href="#notes">General notes </a>             </li>
    <li><a href="#mods">Recent modifications</a>        </li>
    <li><a href="#quick">Quick-start guide</a>          </li>
    <li>Procedure files</a>                             </li>
    <ul>
        <li><a href="#start">Getting started</a>        </li>
        <li><a href="#mics">Micrographs</a>             </li>
        <li><a href="#ctf">CTF estimation</a>           </li>
        <li><a href="#particles">Particle-picking</a>   </li>
        <li><a href="#align">Alignment</a>              </li>
        <li><a href="#verify">Particle-verification</a> </li>
        <li><a href="#average">Compute averages</a>     </li>
        <li><a href="#reconstruct">3D reconstruction</a></li>
        <li><a href="#refine">Refinement</a>            </li>
    </ul>
    <li><a href="#other">Additional procedure files</a> </li>
</ul>

<hr />

<p>
<b><font size="4"><a name="links">Links:</a></font></b></p>
<ul>
    <li>verifybyview.py 
        <a href="../../../../spire/tools-docs/verifybyview.html">documentation</a> and
        <a href="../../../../spire/bin/verifybyview.py"> source code</a>                 </li>
    <li><a href="docfiles.htm">Doc file formats</a>                                      </li>
    <li><a href="misc.htm">Miscellaneous procedure files</a>                             </li>
    <li><a href="truncate-neg.htm">Editing <b>order_picked.dat</b></a>                   </li>
    <li><a href="classavgs.htm">Picking whole classes using WEB</a>                      </li>
    <li><a href="truncate-class.htm">Using the "first good" method in WEB</a>            </li>
</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p>
<b><font size="4"><a name="notes">General notes:</a></font></b></p>
<ul>
    <li><font color="teal">Changes from the &quot;normal&quot; flow will be shown in teal</font>.</li>
    <li>Data filenames will be in <b>bold</b>, and menu options will be in <i>italic</i>.        </li>
    <li>Data extension is assumed to be <b>.dat</b>. Adjust accordingly.                         </li>
    <li>Console commands will be in Courier.</li>
</ul>

<p><a href="#top">Return to top</a> </p>


<hr />

<p>
<b><font size="4"><a name="quick">Quick-start guide</a></font></b></p>

<p>Options limited for the sake of simplicity. For more details, see below.</p>

<p><a href="#start">In toplevel directory (<i>e.g.</i>, <b>myproject/</b>):</a></p>
<ol>
    <li>Unpackage 
        <a href="../../recon/spiproject.tar"> projection-matching procedure files</a>    </li>
    <li>Unpackage <a href="../ve20140806.tar"> verification procedure files</a>          </li>
    <li>Copy <b>params</b> file or Run: spider spi/dat @@makeparams                       </li>
    <li>Copy reference volume and/or Run: spider spi/dat @@resizevol                      </li>
</ol>
<p><a href="#mics">In <b>Micrographs/</b></a>: </p>
<ol start=5>
    <li>mkfilenums      ../filenums.dat  mic*.dat      </li>
    <li>spider spi/dat  @@shrink                        </li>
    <li>montagefromdoc  ../sel_micrograph.dat sm-mic*  </li>
</ol>
<p><a href="#ctf">In <b>Power_Spectra/</b></a>: </p>
<ol start=8>
    <li>spider spi/dat @@powdefocus                                </li>
    <li>montagefromdoc ../sel_micrograph.dat Power_Spectra/pw_avg*</li>
    <li>ctfmatch Power_Spectra/ctf* &amp;                         </li>
    <li>spider spi/dat @@defavg                                    </li>
</ol>
<p><a href="#particles">In <b>Particles/</b></a>: </p>
<ol start=14>
    <li>Copy noise file, or spider spi/dat @@noise</li>
    <li>e2boxer.py                               </li>
    <li>spider spi/dat @@eman2spider              </li>
    <li>spider spi/dat @@rewindow                 </li>
    <li>spider spi/dat @@numberparticles          </li>
</ol>
<p><a href="#align">In <b>Alignment/</b></a>: </p>
<ol start=20>
    <li>spider spi/dat   @@sel_by_group           </li>
    <li>spider spi/dat   @@win2stk                </li>
    <li>spider spi/dat   @@refproj                </li>
    <li>./spider spi/dat @@apsh-pubsub &amp;      </li>
</ol>
<p><a href="#verify">In <b>Reconstruction/</b></a>: </p>
<ol start=24>
    <li>spider spi/dat @@selectbyviewall          </li>
    <li>spider spi/dat @@filterbyview             </li>
    <li>spider spi/dat @@classify                 </li>
    <li>verifybyview                             </li>
    <li>spider spi/dat @@combinegoodclasses       </li>
    <li>(optional) spider spi/dat @@recheck       </li>
    <li>(optional) spider spi/dat @@viewaverage   </li>
    <li>spider spi/dat @@histgoodccc              </li>
    <li>spider spi/dat @@goodparticlesbydf        </li>
    <li>spider spi/dat @@dfgoodapsh               </li>
    <li>(optional) spider spi/dat @@select        </li>
    <li>(optional) spider spi/dat @@plotrefviews  </li>
    <li>(optional) spider spi/dat @@display       </li>
    <li>(optional) spider spi/dat @@bestim        </li>
    <li>./spider spi/dat bps-pubsub &amp;        </li>
    <li>(optional) spider spi/dat @@slices        </li>
    <li>spider spi/dat @@plotres                  </li>
    <li>spider spi/dat @@make_matched             </li>
    <li>spider spi/dat @@matchedfilter            </li>
    <li>spider spi/dat @@consecprepare            </li>
</ol>
<p><a href="#refine">In <b>Refinement/</b></a>: </p>
<ol start=44>
    <li>Edit <b>refine_settings</b>              </li>
    <li>./spider pam/dat @@pub_refine &amp;       </li>
    <li>spider spi/dat @@plotrefres               </li>
</ol>

<p><a href="#top">Return to top</a> </p>

<hr />

<p>
<b><font size="4"><a name="start">Getting started</a></font></b></p>
<ul>
   <li>Unpackage the "normal" 
       <a href="../../recon/spiproject.tar"> projection-matching procedures tar archive</a></li>

    <li>In the top-level directory created by unpackaging 'spiproject.tar' unpackage the 
       <a href="../ve20140806.tar"> supplemental, verification procedures tar archive.</a> </li>
    
    <li>If using SPIRE:                                                              </li>
    <ul>
        <li>Type: </li>
            <pre>spire &amp; </pre>
        <li>Type something, anything, under <i>Project title</i>.                    </li>
        <li>Enter data extension under <i>data extension</i>. 
             Here, I will assume <b>.dat</b>, so adjust accordingly.                 </li>
        <li>Under <i>Directory for this project</i>, 
             make sure that the current directory is entered. 
             Sometimes the data extension is appended, thus defining a new directory.</li>
        <li>Under <i>Configuration file</i>, select <b>verify.xml</b>, 
             using the <i>Browse</i> button if necessary.                            </li>
        <li>Uncheck the button <i>Create directories and load procedure files</i>.   </li>
    </ul>
    
    <li>makeparams.spi </li>
    <ul>
        <li>OUTPUT: <b>params</b></li>
    </ul>
    <li><font color="teal">Skip makefilelist.spi -- 
         The Python script  
         <a href="../../../../spire/bin/mkfilenums.py">mkfilenums.py</a>
         is more general.                                                </li>
    <li>Get reference volume                                             </li>
    <li>(optional) resizevol.spi -- interpolates reference-volume        </li>
</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p>
<b><font size="4"><a name="mics">Micrographs</a></font></b> -- in <b>Micrographs/</b> directory</p>
<ul>
    <li><font color="teal">Micrographs are assumed to have the file pattern <b>mic****</b></font> </li>
    <li><font color="teal">To generate a SPIDER doc file containing a list of micrographs, type
         (substitituing the appropriate data extension):                 </li>
         <pre>mkfilenums ../filenums.dat mic*.dat</pre></font>
    
    <li><font color="teal">Shrink the micrographs</font>                 </li>
    <ul>
        <li><font color="teal"><a href="../batch/Micrographs/shrink.spi">shrink.spi</a></font></li>
        <li><font color="teal">PARAMETER: decimation factor (so that 
             the micrograph fits on the screen at 1X)</font></li>
        <li><font color="teal">INPUT: <b>mic****</b> </font></li>
        <li><font color="teal">OUTPUT: <b>sm-mic****</b> </font></li>
    </ul>
    
    <li><font color="teal">(Optional) Screen the micrographs using 
         <a href="../../../../spire/bin/montagefromdoc.py">montagefromdoc.py</a>.</font> </li>
    <ul>
        <li><font color="teal">Run:                                      </li>
            <pre>montagefromdoc </pre> 
            The first popup window will contain hopefully reasonable settings, or
            you can enter <b>filenums</b> and the micrograph file-pattern on the command line 
            (in that order).</font>
        <li><font color="teal">Alternatively, to keep all the micrographs, in the 
                 top-level directory, copy <b>filenums</b> to <b>sel_micrograph</b>.</font></li>
    </ul>
</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p>
<b><font size="4"><a name="ctf">CTF estimation</a></font></b> -- in <b>Power_Spectra/</b>directory</p>
<ul>
    <li>powdefocus.spi (slow)</li>
    <ul>
        <li>INPUT:  <b>Micrographs/mic****</b>                                  </li>
        <li>OUTPUT: <b>Power_Spectra/pw_avg***</b>, <b>Power_Spectra/roo***</b> </li>
    </ul>
    
    <li><font color="teal">Screen the power spectra visually using 
        <a href="../../../../spire/bin/montagefromdoc.py"> montagefromdoc.py</a>..</font> </li>
    <ul>
            <li><font color="teal">Run: <pre>montagefromdoc   </pre> 
                The first popup window will contain hopefully reasonable settings. 
                If not, the input doc file is <b>sel_micrograph</b> and 
                the image file pattern is <b>Power_Spectra/pw_avg****</b>.</font>          </li>
            <li><font color="teal">To enhance the contrast more than is possible in 
                 montagefromdoc.py, you may need to view a power spectrum in JWEB.</font>  </li>
            <li><font color="teal">The output selection doc file, <b>sel_micrograph</b>, 
                 will overwrite the original, however a backup copy will be saved.</font>  </li>
    </ul>
    
    <li>Screen the determined defocus values.                                             </li>
    <ul>
        <li><a href="../../../../spire/tools-docs/ctfmatch.html"> ctfmatch.py</a> 
            is a nice program to display the fitting. 
            If removing bad micrographs, name the list of remaining good micrographs 
            <b>sel_micrograph</b>.                                                         </li>
    </ul>
    </ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p>
<b><font size="4"><a name="particles">Particle-picking</a></font></b> -- in <b>Particles/</b>
 directory</p>
<ul>
    <li>Get noise file, either from previous project or from noise.spi </li>

    <li>Window particles from micrographs (slow).</li>
    <ol>
    <li>pick.spi</li>
        <ul>
            <li>pick.spi calls pick_p.spi. <br />
                Selecting particles from micrographs in WEB is another option.                     </li>
            <li>INPUT: <font color="teal"><b>../batch/Micrographs/mic****</b> 
                      (change from <b>raw****</b>)</font>, <b>../reference_volume</b>, <b>noise</b></li>
            <li>OUTPUT: <b>win/winser_****</b>, <b>coords/sndc****</b>                             </li>
        </ul>
    
    <li>lfc_pick.spi</li>
        <ul>
            <li>lfc_pick.spi calls pickparticle.spi.</li>
            <li>INPUT: <b>../batch/Micrographs/mic****</b> (change from <b>raw****</b>, <b>../reference_volume</b>, <b>noise</b></li>
            <li>OUTPUT: <b>win/winser_****</b>, <b>coords/sndc****</b> </li>
        </ul>
    
    <li>boxer/e2boxer.py in EMAN/EMAN2</li>
        <ul>
            <li>After picking particles with boxer, run 
                <a href="../batch/Particles/eman2spider.spi">eman2spider.spi</a>.
                 <ul>
                      <li>INPUT: <b>../batch/Micrographs/mic****.box</b> (<i>e2boxer</i> coordinate file) </li>
                      <li>OUTPUT: <b>coords/sndc****</b>                                            </li>
                      <li>This procedure file runs Python script 
                         <a href="../../../../spire/bin/emancoords2spiderdoc.py">
                          emancoords2spiderdoc.py</a>.                                  <br />

                          To run a single micrograph, use the syntax (substituting the 
                          appropriate file names/numbers):                                         </li> 
                    <pre>emancoords2spiderdoc input_eman_coords0001.box coords/sndc0001.dat</pre>
<!--                The micrograph is needed for its dimensions, 
                since SPIDER and EMAN use different conventions for the image origin.-->
                </ul>
            <li>Then, window out the images using 
                <a href="../batch/Particles/rewindow.spi">rewindow.spi</a></li>
                 <ul>
                      <li>INPUT: <b>../batch/Micrographs/mic****</b>, <b>coords/sndc****</b>     </li>
                      <li>OUTPUT: <b>win/winser_****</b>                                   </li>
                      <li>This is also a useful procedure file if I want to use a different window size, 
                          or if I've deleted the <b>winser</b> files to free up disk space.</li>
                 </ul>
        </ul>
    </ol>

    <li><font color="teal">(Optional) Select particles from micrograph stacks.</font> <br />
        <font color="teal">lfc_pick.spi sorts particles by high cross-correlation to 
        worst, and will typically lead off each micrograph with 
        ice-condensation blobs and end with noise. You can exclude these bad images at the 
        extremes by specifying the contiguous range that includes all of the good particles.
        This step will save time and disk space and will help the classification.  <br />
        There are two ways to visualize the particles: using WEB or the Python utility  
        <a href="../../../../spire/tools-docs/montagefromdoc.html"> montagefromdoc.py</a>  </li>

    <ol>
        <li><font color="teal">Using montagefromdoc.py -- 
            this will require less preprocessing 
            (e.g., filtershrink.spi) but Python display is slower than WEB. </font></li>
        <ul>
            <li><font color="teal">Run: 
                <pre>montagefromdoc </pre> 
                The first popup window will contain hopefully reasonable settings, 
                such as input <b>coords/sndc****</b> and output <b>good/good****</b>.
                Alternatively, you can enter the doc-file and particle-file names 
                on the command line (in that order), e.g.,
                <pre>montagefromdoc coords/sndc1234 win/winser_1234</pre></font></li>
        </ul>
        <li><font color="teal">Using WEB</font></li>
        <ul>
            <li><font color="teal">Under <i>Options/Image</i> turn on filenames, and 
                you may need to use a small font, set under <i>Options/Font</i>.
                Open the stacks <b>win/winser_****</b>.</font> </li>
            <li>There used to be procedure files 
                <a href="../batch/Particles/filtershrink.spi">filtershrink.spi</a> and
                <a href="../batch/Particles/negmontagedocs.spi">negmontagedocs.spi</a>  
                to filter and break the stacks into a bite-sized number of images, 
                respectively, but 
                I haven't updated them since lfc_pick started using stacks.  Contact 
                me if you would like 
                to have these procedure files updated.  </li>
<!-- 
            <li>In WEB, using <i>Montage from doc file</i>, display montages. <br />
                For example, assuming the montages are in the <b>coords/</b>
                directory, under <i>Image file template</i>; type &quot;<b>../win/ser******</b>&quot;
                (or &quot;<b>../flt/flt******</b>&quot; if you've filtered the particles already). <br />
                For six-digit image-numbers, I recommend using 8-point font in WEB 
                (under <i>Options/Font</i>).</font></li>
            <li><font color="teal">Filter particles and optionally shrink them.</font></li>
            <ul>
                <li><font color="teal"><a href="../batch/Particles/filtershrink.spi">filtershrink.spi</a> 
                    </font> </li>
                <li><font color="teal">INPUT: <b>win/ser******</b> (default will be <b>ali/sar******</b>)</font> </li>
                <li><font color="teal">OUTPUT: <b>flt/flt******</b> </font></li>
            </ul>

            <li><font color="teal">Separate particles into montages that will fit on the screen.</font></li>
            <ul>
                <li><font color="teal"><a href="../batch/Particles/negmontagedocs.spi">negmontagedocs.spi</a> </font></li>
                <li><font color="teal">INPUT: <b>order_picked</b> </font></li>
                <li><font color="teal">OUTPUT: <b>coords/docmontage****_##</b> </font></li>
                <li><font color="teal">The default number of particles per montage is 150.<br />
                    At 65x65 pixels, ten rows of 15 particles fit nicely on a screen.</font> </li>
            </ul>
 -->
        </ul>
    </ol>

    <li><font color="teal">Skip: renumber.spi</font>                                                  </li>
    
    <li><font color="teal">Assign global particle number for each particle. </font></li>
    <ul>
        <li><font color="teal"><a href="../batch/Particles/numberparticles.spi">numberparticles.spi</a> </font></li>
        <li><font color="teal">PARAMETER: maximum particles per micrograph 
            (it is probably safe to err on the side of too many, or 0 will keep all of them) </font>  </li>
        <li><font color="teal">INPUT: <b>win/sel_particle_****</b> 
            (or <b>good/good****</b> if you selected particles from micrograph stacks)</font>         </li>
        <li><font color="teal">OUTPUT: <b>coords/ngood****</b> <b>coords/mic2global</b> </font>       </li>
    </ul>
</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p>
<b><font size="4"><a name="align">Alignment</a></font></b> -- in <b>Alignment/</b> directory</p>
<ul>
    <li>sel_by_group.spi</li>
    <ul>
        <li>INPUT: <b>../batch/Particles/good/ngood{****[mic]}</b></li>
        <li>OUTPUT: <b>sel_particles_***</b>, <b>sel_group</b></li>
    </ul>

    <li>win2stk.spi</li>
    <ul>
        <li>INPUT: <b>../batch/Particles/win/winser_***@@</b>, <b>../batch/Particles/good/ngood{****[mic]}</b></li>
        <li>OUTPUT: <b>data***</b></li>
    </ul>

    <li>refproj.spi </li>
    <ul>
        <li>INPUT: <b>reference</b>, <b>../Power_Spectra/order_defgrps</b> </li>
        <li>OUTPUT: <b>refangles</b>, <b>prj_####@@****</b> </li>
    </ul>
    
<!--    <li>apshgrp.spi </li>
    <ul>
        <li>INPUT: <b>prj_####@@****</b>, <b>data***</b>, <b>sel_particles_***</b></li>
        <li>OUTPUT: <b>align_01_***</b>, <b>dala01_***</b></li>
        <li>To run it using PubSub, change the <i>[pubsub]</i> flag in the procedure file, and 
             copy the SPIDER executable to the local directory, i.e., <b>./spider</b> <br /> 
             The syntax will be:</li>
             <pre>./spider spi/dat @@apshgrp 1 > log1.txt &amp; </pre>
             where:
             <ul>
                  <li><i>1</i> -- is the number of the master results file, and </li>
                  <li><b>log1.txt</b> -- is a file that contains the screen output, 
                       so that you can easily monitor the progress remotely. 
                       To monitor this file in real time, type:                </li>
                       <pre>tail -f log1.txt</pre>
             </ul>
    </ul>  -->
    
   <li><font color="teal">Align particles to reference projections</font>

    <br /><br /><font color="teal">Alignment is CPU-intensive and benefits by parallelization. 
    Whether you are running the alignment in parallel or in series, edit (but do not run)
    <a href="../batch/Alignment/apsh-settings.spi">apsh-settings.spi</a>. </font>
    <ul>
        <li><font color="teal">PARAMETERS: </font></li>
            <ul>
                <li><font color="teal"><i>[shrange]</i> -- translation search range </font></li>
                <li><font color="teal"><i>[step]</i> -- translation step size 
                    <br /> The operation  
                        <a href="../../../man/apsh.html">'AP SH'</a>
                        tries different combinations of shifts in increments of <i>[step]</i> up to <i>[shrange]</i>, 
                        performs an orientational alignment, and chooses the best one.  
                        (See note in the
                        <a href="../../../man/apsh.html">'AP SH' manual</a>.) 
                    <br /> For example, with a <i>[step]</i> and <i>[shrange]</i> both of 2, 
                        'AP SH' will try shifts of (-2,2),(0,2),(2,2),(-2,0),(0,0),(2,0),(-2,-2),(0,-2), and (2,-2).</font> </li>
                <li><font color="teal"><i>[r2]</i> -- outer alignment radius (pixels) 
                    <br /> The sum of <i>[shrange]</i> and <i>[r2]</i> must be less than half the image dimension</font></li>
               <li><font color="teal"><i>[max-wait]</i> -- Will wait up to 10 minutes by default before reading a new group's stack, 
                   in order to distribute disk I/O.</font></li>
            </ul>
        <li><font color="teal">INPUT: <b>projs/prj_***</b>, <b>data***</b> </font> </li>
        <li><font color="teal">OUTPUT: <b>align_01_***, dala01_***</b></font> </li>
    </ul>
    
   <br /><font color="teal">The following options will depend on whether using you are using 
         Publish and Subscribe on a cluster:</font>
   
   <ol>
   <li><font color="teal">Run 
      <a href="../batch/Alignment/apsh-inseries.spi">apsh-inseries.spi</a>.</font></li>
   </ol>

<p><font color="teal">The following is a brief tree of procedure calls:</font>

<font color="teal"><table border="1" style="background-color:eeeeee">

<tr><td valign="top">
<pre>
<a href="../batch/Alignment/apsh-inseries.spi"><b>apsh-inseries</b></a>
    <a href="../batch/Alignment/apsh-settings.spi">apsh-settings</a>
    
    
    <a href="../batch/Alignment/apsh-main.spi">apsh-main</a>
    
</pre>
</td></tr></table>
</font>
</p>
 
</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p>
<font color="teal"><b><font size="4"><a name="verify">Verify Particles</a></font></b> -- 
                                      in <b>Reconstruction/</b> directory</font></p>

<ul>
    <li><font color="teal">Make selection doc for each reference view. </font>                            </li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/selectbyviewall.spi">
             selectbyviewall.spi</a> </font>                                                              </li>
        <li><font color="teal">SUBROUTINE: <a href="../batch/Reconstruction/reversedoc_7col.spi">
             reversedoc_7col.spi</a> </font>                                                              </li>
        <li><font color="teal">INPUT:  <b>align_01_***</b>, <b>../batch/Alignment/sel_particles_***</b> </font> </li>
        <li><font color="teal">OUTPUT: <b>stack2particle***</b>, <b>select/sel***</b></font>              </li>
    </ul>

    <li><font color="teal">Filter and (optionally) shrink particles. </font>           </li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/filterbyview.spi">filterbyview.spi</a> </font></li>
        <li><font color="teal">INPUT: <b>dala01_***</b>, <b>align_01_***</b> </font>    </li>
        <li><font color="teal">OUTPUT: <b>select/prj***/stkfilt</b> </font>             </li>
        <li><font color="teal">The goal with the filter parameters was to be able to ignore CTF effects. 
            So, I chose the first CTF zero of the most-defocused micrograph as the Butterworth stop-band. 
            If you're not sure what filter radii to use, try 
            <a href="../batch/Reconstruction/findctfminima.spi">findctfminima.spi</a>  </font>   </li>
        <li><font color="teal">To test the filter parameters, 
            try running this procedure file on just the particles in one reference view, 
            by setting parameter <i>[last-view]</i> to 1. </font>                       </li>
        <li><font color="teal">If you're using old, X-Window WEB, which
            can't montage a doc file from stacks (NOTE: it can now), run 
            <a href="../batch/Reconstruction/filtershrinksh.spi">filtershrinksh.spi</a>, 
            which instead writes <b>../batch/Particles/flt/flt******</b></font>               </li>
    </ul>

    <li><font color="teal">(Optional) Screen particles without classification. </font>  </li>
    <ul>
        <li><font color="teal">You can optionally screen the particles without classification.
             This could be useful for small data sets that don't warrant classification,
             or if you otherwise want to see all particles before classification. Run:
             <pre> montagefromdoc </pre>
             The first popup window will hopefully have reasonable settings.
             If not, enter <b>select/sortsel001.dat</b>, <b>select/prj001/stkfilt.dat</b>, and 
             <b>select/prj001/goodsel.dat</b> for the input selection filename, particle filename, 
             and output selection file, respectively. </font>                                     </li>
        <li><font color="teal">If you perform this step, skip ahead past combinegoodclasses.spi</font> </li>
        <li><font color="teal">The particles are sorted by correlation coefficient, from highest to lowest. 
             You can display the CCROT values by clicking the checkbutton under <i>Display/Labels</i>,
             but you'll probably need to resize the window.</font>                                </li>
    </ul>

    <li><font color="teal">Run correspondence analysis and separate particles into classes. </font></li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/classify.spi">classify.spi</a> </font>      </li>
        <li><font color="teal">INPUT: <b>select/sel***</b>, <b>select/prj***/stkfilt</b> </font>   </li>
        <li><font color="teal">OUTPUT: <b>select/prj***/{docclass###</b>, <b>classavg###</b>, 
            <b>listclasses</b>} </font></li>
        <li><font color="teal">If you're running X-Windows WEB (or for some other reason ran 
            <a href="../batch/Reconstruction/filtershrinksh.spi">filtershrinksh.spi</a>) instead run 
            <a href="../batch/Reconstruction/unstacked-classify.spi">unstacked-classify.spi</a>, 
            which uses <b>../batch/Particles/flt/flt******</b> as an input.</font>           </li>
        <li><font color="teal">You can select good class-averages for a reference-view as 
            soon as the procedure file starts on a subsequent reference-view (as 
            printed to the screen). As of 2004, you can probably sift through 
            classes faster than SPIDER can calculate them.</font>                       </li>
        <li><font color="teal">During MSA, SPIDER may hang at a particular reference view.
            If this happens, switch to a different MSA method (<i>e.g.,</i> from correspondence 
            analysis to iterative PCA) and restart at that reference view. </font>      </li>
    </ul>
    <li><font color="teal">If you would like to verify particles on a different computer, 
        you should be able to copy the contents of the <b>Reconstruction/select/</b> directory. 
        There are a couple thousand files there total, including the particle stacks, 
        in contrast to ~100,000 files in the case of unstacked particles.</font>        </li>

    <li><font color="teal">There are four options for keeping particles, 
           depending on how much control you want/need:</font>                          </li>

        <ul>
        <li><font color="teal">Option using Python/Tkinter:<br />
            Select classes and particles therein using verifybyview.py. 
            More information found 
            <a href="../../../../spire/tools-docs/verifybyview.html">here</a>.</font>   </li>

        <li><font color="teal"><a name="web">Options using WEB:</a>                     </li>
            <ul>
                <li>First, select good class-averages in WEB using <i>Categorize/Sequential 
                    montage</i> (to show them in sequential order) or <i>Categorize/Doc. 
                    file montage </i>(using <b>listclasses</b>) to show them 
                    from worst cross-correlation to best. </font>                       </li>
                <li><font color="teal">Name the resulting list of good classes <b>goodclasses</b> and 
                    click on the good classes. WEB by default will write a separate 
                    document file for each reference view. </font>                      </li>
                <li><font color="teal">Check member particles -- in 
                    separate WEB window -- using <i>Montage from doc file</i>. using 
                    the appropriate document file <b>docclass{***class#}</b>.          <br />
                    The <i>Image file template</i> in WEB should be 
                    &quot;<b>../batch/Particles/flt******</b>&quot; <br />
                    Particles will be sorted from worst cross-correlation to best.      <br />
                    See <a href="classavgs.htm">here</a> for an illustrated example.</font>     </li>
                <li><font color="teal">There are three levels of control in verifying particles using WEB:</font></li>
                    <ol>
                        <li><font color="teal">Simply click on the good classes as described above.           <br />
                            This will keep all of the particles in the good classes. </font>                  </li>

                        <li><font color="teal">Manually click on the first good particle in each class.       <br />
                            I recommend doing this until you get a feel for which classes are bad.            <br />
                            See <a href="truncate-class.htm">here</a> for an illustrated example.</font></li>
                            <ul>
                                <li><font color="teal">Click on the good classes as described above.</font>   </li>
                                <li><font color="teal">Instead of displaying class-montages with <i>Montage 
                                    from doc file</i>, use <i>Categorize/Doc. file montage</i>. </font>       </li>
                                <li><font color="teal">Name the output file <b>firstgoodparticle</b>. There 
                                    should be one file for each reference-view. </font></li>
                                <li><font color="teal">When prompted for the key, enter the class-number.     <br />
                                    If there isn't a key for each good class, the next procedure 
                                    file (combinegoodclasses.spi) will crash. </font></li>
                                <li><font color="teal">Click on the first good particle for each class that has 
                                    particles you want to keep, e.g., the first one to keep all of them.</font></li>
                            </ul>
                        <li><font color="teal">Manually click on the good particles in each class. <br />
                            The only advantages over fully manual-particle verification is 
                            that the particles are separated by view and aligned. 
                            This is useful if classification didn't do a good job on your particles.</font>      </li>
                            <ul>
                                <li><font color="teal">Click on the good classes as described above.</font>      </li>
                                <li><font color="teal">Display the class-montages using <i>Categorize/Doc. file montage</i>. </font></li>
                                <li><font color="teal">Name the output file <b>byhand{***class#}</b>. </font>    </li>
                                <li><font color="teal">Click on each particle that you would like to keep.</font></li>
                            </ul>

                            <font color="teal">If using WEB, for a given reference-view, you have to use the same method for all 
                            classes.                                                                  <br />
                            That is, if you use the "whole class" mode (option 1) for one class in a 
                            reference-view, you must use it for all classes.                          <br />
                            The same goes for options 2 and 3. 
                            However, you can mix-and-match methods within different reference-views.  <br />
                            The next procedure file will write to the screen which method was used for each view.</font></li>
                    </ol>
            </ul>
        </ul>

    <li><font color="teal">Combine particles from good classes. </font></li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/combinegoodclasses.spi">combinegoodclasses.spi</a> </font></li>
        <li><font color="teal">SUBROUTINE: <a href="../batch/Reconstruction/reversedoc_7col.spi">
            reversedoc_7col.spi</a> </font>                                                                      </li>
        <li><font color="teal">INPUT: <b>select/prj***/{docclass###</b>, <b>goodclasses</b>,<b>select/sel***</b>, 
            <b>firstgoodparticle</b> (optional), <b>byhand</b> (optional)}</font>                                </li>
        <li><font color="teal">OUTPUT: <b>select/prj***/goodsel</b> (one for each reference-view),
         <b>select/combinestats</b> </font>                                                                      </li>
    </ul>

    <li><font color="teal">(Optional) Re-screen the particles by view. </font>                               </li>
        <ol>
            <li><font color="teal">Screen particles using .montagefromdoc </font>                            </li>
            <ul>
                <li><font color="teal">In <b>select/</b>, I included a <b>.montagefromdoc</b> file with hopefully reasonable settings.
                If not, type: <pre>montagefromdoc prj001/goodsel.dat prj001/stkfilt.dat</pre>
                For the output filename, use <b>prj001/notgood</b>.</font>                                   </li>
                <li><font color="teal">To salvage bad particles, do the converse, i.e., 
                    use <b>prj001/badsel.dat</b> and <b>prj001/notbad.dat</b> as the input and output.</font></li>
                <!-- <li><font color="teal"> </font></li> -->
            </ul>

        <li><font color="teal"><a href="../batch/Reconstruction/recheck.spi">recheck.spi</a> </font>                     </li>
            <ul>
                <li><font color="teal">SUBROUTINE: <a href="../batch/Reconstruction/reversedoc_7col.spi">
                    reversedoc_7col.spi</a> </font>                                                             </li>
                <li><font color="teal">INPUT: <b>select/prj***/sortsel</b>, <b>select/prj***/goodsel</b>,
                     <b>select/prj***/badsel</b> <b>select/prj***/notbad</b>, <b>select/prj***/notgood</b></font></li>
                <li><font color="teal">OUTPUT: <b>select/prj***/goodselB</b>, <b>select/prj***/badselB</b> </font></li>
                <li><font color="teal">For the output doc files, I used a letter to distinguish from prior output. 
                    A number might cause problems for montagefromdoc.py.</font>                                   </li>
            </ul>
        </ol>

    <li><font color="teal">(Optional) Average images by view</font></li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/viewaverage.spi">viewaverage.spi</a> </font>               </li>
        <li><font color="teal">INPUT: <b>select/prj***/goodsel</b> <br />
             If you ran recheck.spi, add the tiebreaker (e.g., <i>B</i>) to the filename. </font>                 </li>
        <li><font color="teal">OUTPUT: <b>select/prj***/goodavg</b>,<b>select/prj***/goodvar</b> (optional)</font></li>
        <li><font color="teal">One advantage of this procedure file over average.spi is that it combines all defocus groups.</font></li>
        <li><font color="teal">You can use verifybyview.py to link the averages to the retained particles.  
             To do so, run verifybyview from <b>Reconstruction/select/</b> 
             (so as to not overwrite the settings in <b>Reconstruction/</b>). 
             The default settings in <b>.verifybyview</b> will hopefully be reasonable.  
             In principle, you could re-screen your particles if there are still bad ones.</font>                 </li>
    </ul>

    <li><font color="teal">Compute CCC histogram of particles</font></li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/histgoodccc.spi">histgoodccc.spi</a> </font>         </li>
        <li><font color="teal">INPUT: <b>select/prj***/goodsel</b>, <b>select/prj***/badsel</b>             <br />
             If you ran recheck.spi, add the tiebreaker (e.g., <i>B</i>) to the filename. </font>           </li>
        <li><font color="teal">OUTPUT: <b>combinedgood</b>, <b>histcccgood</b>, <b>histcccbad</b></font>    </li>
        <li><font color="teal">Check histogram using <a href="../batch/Reconstruction/fit.gnu">fit.gnu</a>, 
            modifying file extension and fit, if needed. Type  
            <pre>gnuplot </pre> and then at the prompt, type (including the single quotes):
            <pre>load 'fit.gnu'</pre>
            Normally, the histogram should look Gaussian.  If there is a tail or a second mode 
            at the low-CCC end, there may be non-particles remaining.  You can filter them out
            by using a fractional cutoff in a later step, or you can go back and more stringently 
            go through the particles.</font></li>
    </ul>

    <li><font color="teal">Separate total good-particle list by defocus-group. </font>                      </li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/goodparticlesbydf.spi">goodparticlesbydf.spi</a> </font></li>
        <li><font color="teal">PARAMETER: fractional cutoff (optional, use 0.0 to keep all)</font>             </li>
        <li><font color="teal">INPUTS: <b>combinedgood</b>, <b>stack2particle***</b></font>                    </li>
        <li><font color="teal">OUTPUT: <b>df***/goodparticles</b>, <b>sel_group_cclim</b>, <b>sel_group_cclim_sorted</b> </font> </li>
        <li><font color="teal">For large particle sets, this procedure file may crash, in which case try 
            <a href="../batch/Reconstruction/big-goodparticlesbydf.spi">big-goodparticlesbydf.spi</a> </font>           </li>
    </ul>
    
    <li><font color="teal">Generate alignment documents with only good particles</font>                        </li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/dfgoodapsh.spi">dfgoodapsh.spi</a> </font></li>
        <li><font color="teal">INPUT: <b>../batch/Alignment/align_01_***</b>, <b>df***/goodparticles</b></font>      </li>
        <li><font color="teal">OUTPUT: <b>../batch/Alignment/good-align_01_***</b>, <b>sel_particles***</b></font>   </li>
        <li><font color="teal">The <b>sel_particles***</b> files are essentially equivalent to 
            <b>df***/goodparticles</b>, lacking only the <i>CCROT</i> column. </font>                          </li>
    </ul>
</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p><b><font size="4"><a name="average">Compute averages</a></font></b> -- 
   also in <b>Reconstruction/</b> directory</p>

<ul>
    <li>select.spi (optional, necessary for display.spi or plotrefviews.spi)
        -- for each defocus-group, separates particles by reference-view                                          </li>
    <ul>
        <li><font color="teal">INPUT: Use <b>good-align_01_***</b> instead of <b>align_01_***</b></font>          </li>
        <li>OUTPUT: <b>df***/select/sel###</b>, <b>df***/how_many</b>, <b>how_many</b>                            </li>
    </ul>

    <li><font color="teal">Skip average.spi -- The equivalent was performed above by viewaverage.spi</font>       </li>
    <li><font color="teal">Skip cchistogram.spi -- The equivalent was performed above by histgoodccc.spi</font>   </li>
    <li><font color="teal">Skip ccthresh.spi  -- The equivalent was performed above by histgoodccc.spi</font>     </li>
    <li><font color="teal">Skip dftotals.spi -- The equivalent was performed above by goodparticlesbydf.spi</font></li>

    <li>plotrefviews.spi, display.spi (optional) -- graphically show distribution of views                        </li>
    <ul>
        <li>INPUT: <b>df***/how_many</b>                                                                          </li>
        <li>OUTPUT: <b>gnuplot_view</b>, <b>display/cndis***</b>                                                  </li>
    </ul>

    <li>bestim.spi (optional) -- truncate <b>seltotal</b> files for overrepresented views                         </li>
</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p><b><font size="4"><a name="reconstruct">3D reconstruction</a></font></b> -- 
   still in <b>Reconstruction/</b> directory</p>

<ul>
    <li><font color="teal">Compute 3D reconstruction</font>
   
   <ol>
   <li><font color="teal">Run 
      <a href="../batch/Reconstruction/bps-inseries.spi">bps-inseries.spi</a>.</font></li>
   </ol>

    <p><font color="teal">Like alignment, 3D reconstruction is CPU-intensive and benefits by parallelization. 
    Whether you are running the alignment in parallel or in series, edit (but do not run)
    <a href="../batch/Reconstruction/bps-settings.spi">bps-settings.spi</a>. </font>
    
    <li><font color="teal">PARAMETERS: </font>                                                                 </li>
        <ul>
            <li><font color="teal"><i>[bp-method]</i> -- backprojection method: BP CG, BP 32F, or BP RP</font> </li>
            <li><font color="teal"><i>[stk-opt]</i> -- Stack options (<i>e.g.</i>, 0 to read from original location, 
                1 to copy into RAM, or 2 to copy temporarily to disk).</font>                                  </li>
            <li><font color="teal"><i>[max-wait]</i> -- Will wait up to 10 minutes by default before reading a new group's stack, 
               in order to distribute disk I/O.</font>                                                         </li>
        </ul>
    <li><font color="teal">INPUT: <b>dala01_***</b>, <b>../batch/Alignment/align_01_***</b>, 
        <b>sel_particles_***</b> </font>                                                                       </li>
    <li><font color="teal">OUTPUT: <b>df***/{vol01_odd, vol01_even}, df***/docfscmasked, summary-bps</b></font> </li>
        

<p><font color="teal">The following is a brief tree of procedure calls:</font>
<font color="teal"><table border="1" style="background-color:eeeeee">

<tr>
<td valign="top">
<pre>
<a href="../batch/Reconstruction/bps-inseries.spi"><b>bps-inseries</b></a>
    <a href="../batch/Reconstruction/bps-settings.spi">bps-settings</a>
    

    <a href="../batch/Reconstruction/bps-main.spi">bps-main</a>
    
        <a href="../batch/Reconstruction/bps-calcres.spi">bps-calcres</a>
    <a href="../batch/Reconstruction/bps-combine.spi">bps-combine</a>
        <a href="../batch/Reconstruction/bps-calcres.spi">bps-calcres</a>
   </pre>                                                        
</td>

</tr>
</table></font>
</p>

    <li>slices.spi (optional)</li>
    <ul>
        <li>INPUT: <b>df***/vol01_odd</b></li>
        <li>OUTPUT: <b>slices/slice***</b></li>
    </ul>

    <li>plotres.spi </li>
    <ul>
        <li>INPUT: <font color="teal"><b>df***/docfscmasked</b> (change from <b>df***/fscdoc</b>)</font>, 
            <font color="teal"><b>docfscmasked</b> (change from <b>combires</b>)</font>, <b>resolution</b></li>
        <li>OUTPUT: <b>gnuplot_res</b></li>
    </ul>

    <li><font color="teal">Generate a matched-filter profile</font>                                 </li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/make_matched.spi">make_matched.spi</a></font></li>
        <li><font color="teal">INPUT: <b>vol01_odd</b>, <b>vol01_even</b> </font>                   </li>
        <li><font color="teal">OUTPUT: <b>docmatched_vol01</b> </font>                              </li>
        <li><font color="teal">Information at spatial frequencies above the cutoff value is 
            considered to be uncorrelated noise, and should be filtered out. 
            The resolution curve itself is used to determine the shape of the filter.
            This concept is described in Huang and Penczek (2004) <i>JSB</i> <b>145</b>: 29-40.</font></li>
    </ul>
    
    <li><font color="teal">Apply the filter profile</font>                                            </li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/matchedfilter.spi">matchedfilter.spi</a></font></li>
        <li><font color="teal">INPUT: <b>docmatched_vol01</b>, <b>vol01</b> </font>                   </li>
        <li><font color="teal">OUTPUT: <b>vol01_matched</b> </font>                                   </li>
        <li><font color="teal">Applying the same filter profile to different reconstructions 
            can be used to filter them to the same resolution 
            (provided the filter for the lowest-resolution reconstruction is used).
            </font>                                                                                   </li>
    </ul>
    
    <li><font color="teal">Prepare files for refinement</font>                                        </li>
    <ul>
        <li><font color="teal"><a href="../batch/Reconstruction/consecprepare.spi">consecprepare.spi</a></font></li>
        <li><font color="teal">INPUT: <b>sel_group_cclim</b>, <b>sel_particles_***</b>, 
             <b>data***</b>, <b>dala01_***</b> </font>                                                </li>
        <li><font color="teal">OUTPUT: <b>good-sel_group_cclim</b>, <b>good-sel_particles_***</b>, 
             <b>good-data***</b>, <b>good-dala01_***</b> (optional, see NOTE below) </font>           </li>
        <li><font color="teal">NOTE: In the developmental version of the 
             <a href="../../recon/mr.html">
             main, projection-matching procedure files</a>, the aligned-image stacks 
            (<b>dala01_***</b>) are no longer needed.  
            The default is currently to write the aligned-images stacks, but 
            to save disk space, this output can be skipped by 
            setting the parameter <i>[dala-yn]</i> to 0.
            </font>                                                                                   </li>
        <li><font color="teal">Originally, this procedure file copied the outputs into <b>Refinement/input</b>.
             Now however, the subroutine 
             <a href="../../recon/newprogs/prepare.pam">prepare.pam</a> in 
             <a href="../../recon/refine.html">Refinement</a> does this for you. 
             Left as is, refinement would manipulate the entire stacks, including discarded particles. 
             This could be wasteful, especially if particles sets are further split using classification, for example. 
             So, with this procedure file, only the desired particles will be retained.     <br />
             However, below, you will need to remember to change the input filenames in 
             <a href="../../recon/newprogs/refine_settings.pam">refine_settings.pam</a>
</font></li>
    </ul>

    <li><font color="teal">Skip filt.spi -- The equivalent was performed above by make_matched.spi and matchedfilter.spi</font> </li>

</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p>
<b><font size="4"><a name="refine">Refinement</a></font></b> -- in <b>Refinement/</b>
 directory
</p>

<ul>
    <li><a href="../../recon/refine.html"> Refinement documentation</a>            </li>

    <li><font color="teal">Use the following as inputs in 
         <a href="../../recon/newprogs/refine_settings.pam"> refine_settings.pam</a>,
         as written above by 
         <a href="../batch/Reconstruction/consecprepare.spi">consecprepare.spi</a>   <br />
         <i> (Note the only change from the default is the prefix 
             <b>good-</b> for these files) </i>: </font>                           </li>
         <ul>
              <li><font color="teal"><b> good-sel_group_cclim </b></font>          </li>
              <li><font color="teal"><b> good-sel_particles_*** </b></font>        </li>
              <li><font color="teal"><b> good-data*** </b></font>                  </li>
              <li><font color="teal"><b> good-dala01*** </b> </font>               </li>
              <li><font color="teal"><b> good-align_01_*** </b></font>             </li>
         </ul>
    <li><font color="teal">I recommend using the filtered volume, <b>vol01_matched</b>, 
        instead of <b>vol01</b>, in order to minimize model bias. </font>
    </li>
</ul>

<p><a href="#top">Return to top</a> </p>

<hr />

<p><b><font size="4"><a name="other">Additional procedure files</a></font></b></p>

I have some <a href="misc.htm">miscellaneous procedure files here</a>.

<hr />

<hr />

<p>
<b><font size="4"><a name="mods">Recent modifications:</a></font></b></p>
<ul>

<!--    <li>2012-date -- </li> -->

    <li>2012-07-19 --the following procedure files explicitly create necessary output directories: </li> 
        <ul>
            <li>eman2spider.spi        </li>
            <li>rewindow.spi           </li>
            <li>numberparticles.spi    </li>
        </ul>
    <li>2012-05-23 -- changed <i>X##</i> format registers to named registers for the following procedure files:</li>
        <ul>
            <li>selectbyviewall.spi    </li>
            <li>rewindow.spi           </li>
            <li>recheck.spi            </li>
            <li>goodparticlesbydf.spi  </li>
            <li>eman2spider.spi        </li>
            <li>combinegoodclasses.spi </li>
            <li>classify.spi           </li>
        </ul>
    <li>2012-05-17 -- bps-pubsub.spi and bps-inseries.spi -- replace bps-by-df.spi</li> 
    <li>2012-05-15 -- filtering reconstruction using matched filter</li> 
    <li>2012-05-15 -- apsh-pubsub.spi and apsh-inseries.spi -- replace apshgrp.spi</li> 
    <li>2012-05-01 -- numberparticles.spi -- replaces pnums.spi and listallparticles.spi</li> 
    <li>2012-04-12 -- filterbyview.spi -- added option to not filter </li>
    <li>2012-04-06 -- eman2spider.spi -- added <b>sel_particles***</b> output</li>
    <li>2012-03-15 -- combinegoodclasses.spi -- summary doc file now has the format of old <b>how_many</b> files</li>
    <li>2011-01-14 -- bps-by-df.spi -- computes masked and unmasked FSCs</li>
    <li>2011-01-11 -- regroup.spi -- can quickly test sizes of new defocus groupings</li>
    <li>2011-01-07 -- consecprepare.spi -- new refinement procedure files use different and fewer inputs</li>
    <li>2010-09-02 -- emancoords2spiderdoc.py -- SPIDER and EMAN2 coordinate systems appear to be the same now</li> 
    <li>2009-07-10 -- documented various <a href="docfiles.htm">doc file formats</a></li>
    <li>2009-06-03 -- changed format of <b>Reconstruction/select/sel***</b> files, 
         now same format as <b>Reconstruction/select/prj***/sortsel</b>, for versatility and generality. 
         The following procedure files are affected:</li>
        <ul>
            <li>selectbyviewall.spi                 </li>
            <li>filterbyview.spi                    </li>
            <li>classify.spi                        </li>
            <li>combinedgoodclasses.spi             </li>
            <li>reselect_byview.spi (in <b>VerifyMisc/</b>)</li>
        </ul>
    <li>2009-05-14 -- histgoodccc.spi -- added output histogram of bad particles</li>
    <li>2009-05-14 -- recheck.spi -- added optional step to add or subtract particles after re-screening</li>
    <li>2009-04-14 -- dfgoodapsh.spi -- output now called <b>sel_particles_***</b>, can work without defocus groups</li>
    <li>2009-04-07 -- included backup script <b>backup.sh</b> </li>
    <li>2009-02-26 -- added quick-start guide</li>
    <li>2009-02-26 -- added viewaverage.spi (optional) -- analogous to average.spi</li>
    <li>2008-09-29 -- added <b>mkfilenums.py</b>, <b>shrink.spi</b>, and <b>.montagefromdoc</b> 
                      in <b>Micrographs/</b></li>
    <li>2008-07-02 -- added to <a href="../../../docs/techniques.html">
         SPIDER Techniques</a> page      </li>
    <li>2008-02-01 -- selectbyviewall.spi -- added output <b>stack2particle***</b> 
                      with global particle number,  
        to compensate for a change to <b>sel_particles</b>. The following also 
        changed accordingly:             </li>
        <ul>
            <li>histgoodccc.spi          </li>
            <li>big-goodparticlesbydf.spi</li>
            <li>goodparticlesbydf.spi    </li>
            <li>dfgoodapsh.spi           </li>
        </ul>
    <li>2007-08-22 -- <a href="../tar_archive/archive.htm">archive of tarballs</a> linked to projection-matching tarballs</li>
    <li>2007-08-22 -- changed hard-to-read italic passages to less-hard-to-read <font color="teal">teal</font>.</li>
    <li>2007-01-31 -- significant re-write of procedure files in <a href="#verify">Verification</a> section.<br />
        Changes are <a href="changes20070131.txt">summarized here.</a>                    </li>
    <li>2007-01-23 -- started <a href="../tar_archive/archive.htm">archive</a> of tarballs</li>
    <li>2006-08-29 -- <a href="verifybyview.py">verifybyview.py</a> -- stores prior settings in text file <b>.verifybyview</b></li>
    <li>2006-07-27 -- added <a href="verify.xml">SPIRE configuration file</a> to 
                            <a href="../tar_archive/archive.htm">tarball</a>                                  </li>
    <li>2006-06-27 -- created <a href="../tar_archive/archive.htm">tarball</a> of procedure files</li>
    <li>2006-05-12 -- AP SH version is now the default                                    </li>
    <li>2005-03-03 -- posted documentation on <a href="../VerifyDocs/interface.htm">Python/Tkinter interface</a></li>
    <li>2005-01-21 -- changed extensions from <b>.bat</b> to <b>.spi</b>                  </li>
</ul>

<p><a href="#top">Return to top</a> </p>

</body>
</html>
@


1.5
log
@links are no longer relative to spider doc
@
text
@d16 2
a17 1
<h2 align="center"> <b>Particle verification for single-particle, reference-based reconstruction 
d19 3
a21 2
   As described in <i>J Struct Biol </i> (2008) <b>161   </b>: 41-48. <br />
   <b>Out of date, legacy protocol, with dead links!!    </b> 
d57 8
a64 7
    <li>verifybyview.py <a href="../VerifyDocs/interface.htm">documentation</a>
                    and <a href="verifybyview.py">source code</a>                                               </li>
    <li><a href="docfiles.htm">Doc file formats</a>                                                  </li>
    <li><a href="VerifyMisc/misc.htm">Miscellaneous procedure files</a>                              </li>
    <li><a href="../VerifyDocs/truncate-neg.htm">Editing <b>order_picked.dat</b></a>                 </li>
    <li><a href="../VerifyDocs/classavgs.htm">Picking whole classes using X-Window WEB</a>           </li>
    <li><a href="../VerifyDocs/truncate-class.htm">Using the "first good" method in X-Window WEB</a> </li>
d77 1
a77 1
    <pre>Console commands will be in Courier.</pre>
d92 3
a94 3
    <li>Unpackage <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/spiproject.tar"> \
        projection-matching procedure files</a>                                          </li>
    <li>Unpackage <a href="../ve20140806.tar">          verification procedure files</a> </li>
d100 2
a101 2
    <li>mkfilenums   ../filenums.dat  mic*.dat         </li>
    <li>spider spi/dat   @@shrink                       </li>
a108 2
    <li>spider spi/dat @@defsort                                   </li>
    <li>ctfgroup def_sort.dat                                     </li>
d163 5
a167 4
    <li>Unpackage the "normal" href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/spiproject.tar"> 
         projection-matching procedures tar archive</a> 
         first, and in its top-level directory                                                         <br />
         unpackage the <a href="../ve20140806.tar"> supplemental, verification procedures tar archive. </li>
d169 1
a169 1
    <li>If using SPIRE:</li>
d190 1
a190 1
         <a href="http://www.wadsworth.org/spider_doc/spider/spire/bin/mkfilenums.py">mkfilenums.py</a>
d210 1
a210 1
        <li><font color="teal"><a href="Micrographs/shrink.spi">shrink.spi</a></font></li>
d218 1
a218 2
         <a href="http://www.wadsworth.org/spider_doc/spider/spire/bin/montagefromdoc.py">
                     montagefromdoc.py</a>.</font>                       </li>
d244 1
a244 2
        <a href="http://www.wadsworth.org/spider_doc/spider/spire/bin/montagefromdoc.py">
        montagefromdoc.py</a>..</font>                                          </li>
d256 1
a256 1
    <li>Screen the determined defocus values.</li>
d258 1
a258 2
        <li><a href="http://www.wadsworth.org/spider_doc/spider/spire/tools-docs/ctfmatch/ctfmatch.html"> 
            ctfmatch.py</a> 
d260 2
a261 1
            If removing bad micrographs, name the list of remaining good micrographs <b>sel_micrograph</b>.</li>
d281 1
a281 1
            <li>INPUT: <font color="teal"><b>../Micrographs/mic****</b> 
d289 1
a289 1
            <li>INPUT: <b>../Micrographs/mic****</b> (change from <b>raw****</b>, <b>../reference_volume</b>, <b>noise</b></li>
d295 2
a296 1
            <li>After picking particles with boxer, run <a href="Particles/eman2spider.spi">eman2spider.spi</a>.
d298 1
a298 1
                      <li>INPUT: <b>../Micrographs/mic****.box</b> (<i>e2boxer</i> coordinate file) </li>
d301 3
a303 2
                         <a href="http://www.wadsworth.org/spider_doc/spider/spire/bin/emancoords2spiderdoc.py">
                          emancoords2spiderdoc.py</a>.                                           <br />
d306 1
a306 1
                           <pre>emancoords2spiderdoc input_eman_coords0001.box coords/sndc0001.dat</pre>
d311 1
a311 1
                <a href="Particles/rewindow.spi">rewindow.spi</a></li>
d313 1
a313 1
                      <li>INPUT: <b>../Micrographs/mic****</b>, <b>coords/sndc****</b>     </li>
d321 2
a322 2
    <li><font color="teal">(Optional) Select particles from micrograph stacks.</font>
        <br /><font color="teal">lfc_pick.spi sorts particles by high cross-correlation to 
d327 3
a329 3
        There are two ways to visualize the particles: using WEB or the 
        Python utility  <a href="http://www.wadsworth.org/spider_doc/spider/spire/tools-docs/montagefromdoc.html">
        montagefromdoc.py</a>                                                      </li>
d335 2
a336 1
            <li><font color="teal">Run: <pre>montagefromdoc </pre> 
d339 2
a340 1
                Alternatively, you can enter the doc-file and particle-file names on the command line (in that order), e.g.,
d349 6
a354 4
                <a href="Particles/filtershrink.spi">filtershrink.spi</a> and
                <a href="Particles/negmontagedocs.spi">negmontagedocs.spi</a>  
                to filter and break the stacks into a bite-sized number of images, respectively, but 
                I haven't updated them since lfc_pick started using stacks.  See me if you would like 
d365 1
a365 1
                <li><font color="teal"><a href="Particles/filtershrink.spi">filtershrink.spi</a> 
d373 1
a373 1
                <li><font color="teal"><a href="Particles/negmontagedocs.spi">negmontagedocs.spi</a> </font></li>
d387 1
a387 1
        <li><font color="teal"><a href="Particles/numberparticles.spi">numberparticles.spi</a> </font></li>
d405 1
a405 1
        <li>INPUT: <b>../Particles/good/ngood{****[mic]}</b></li>
d411 1
a411 1
        <li>INPUT: <b>../Particles/win/winser_***@@</b>, <b>../Particles/good/ngood{****[mic]}</b></li>
d443 1
a443 1
    <a href="Alignment/apsh-settings.spi">apsh-settings.spi</a>. </font>
d450 1
a450 1
                        <a href="http://www.wadsworth.org/spider_doc/spider/docs/man/apsh.html">'AP SH'</a>
d454 1
a454 1
                        <a href="http://www.wadsworth.org/spider_doc/spider/docs/man/apsh.html">'AP SH' manual</a>.) 
d471 1
a471 1
      <a href="Alignment/apsh-inseries.spi">apsh-inseries.spi</a>.</font></li>
d480 2
a481 2
<a href="Alignment/apsh-inseries.spi"><b>apsh-inseries</b></a>
    <a href="Alignment/apsh-settings.spi">apsh-settings</a>
d484 1
a484 1
    <a href="Alignment/apsh-main.spi">apsh-main</a>
d504 1
a504 1
        <li><font color="teal"><a href="Reconstruction/selectbyviewall.spi">
d506 1
a506 1
        <li><font color="teal">SUBROUTINE: <a href="Reconstruction/reversedoc_7col.spi">
d508 1
a508 1
        <li><font color="teal">INPUT:  <b>align_01_***</b>, <b>../Alignment/sel_particles_***</b> </font> </li>
d514 1
a514 1
        <li><font color="teal"><a href="Reconstruction/filterbyview.spi">filterbyview.spi</a> </font></li>
d520 1
a520 1
            <a href="Reconstruction/findctfminima.spi">findctfminima.spi</a>  </font>   </li>
d526 2
a527 2
            <a href="Reconstruction/filtershrinksh.spi">filtershrinksh.spi</a>, 
            which instead writes <b>../Particles/flt/flt******</b></font>               </li>
d548 1
a548 1
        <li><font color="teal"><a href="Reconstruction/classify.spi">classify.spi</a> </font>      </li>
d553 3
a555 3
            <a href="Reconstruction/filtershrinksh.spi">filtershrinksh.spi</a>) instead run 
            <a href="Reconstruction/unstacked-classify.spi">unstacked-classify.spi</a>, 
            which uses <b>../Particles/flt/flt******</b> as an input.</font>           </li>
d571 1
d575 3
a577 1
            More information found <a href="../VerifyDocs/interface.htm">here</a>.</font></li>
d591 1
a591 1
                    &quot;<b>../../../Particles/flt******</b>&quot; <br />
d593 1
a593 1
                    See <a href="../VerifyDocs/classavgs.htm">here</a> for an illustrated example.</font>     </li>
d601 1
a601 1
                            See <a href="../VerifyDocs/truncate-class.htm">here</a> for an illustrated example.</font></li>
d638 2
a639 2
        <li><font color="teal"><a href="Reconstruction/combinegoodclasses.spi">combinegoodclasses.spi</a> </font></li>
        <li><font color="teal">SUBROUTINE: <a href="Reconstruction/reversedoc_7col.spi">
d659 1
a659 1
        <li><font color="teal"><a href="Reconstruction/recheck.spi">recheck.spi</a> </font>                     </li>
d661 1
a661 1
                <li><font color="teal">SUBROUTINE: <a href="Reconstruction/reversedoc_7col.spi">
d673 1
a673 1
        <li><font color="teal"><a href="Reconstruction/viewaverage.spi">viewaverage.spi</a> </font>               </li>
d687 1
a687 1
        <li><font color="teal"><a href="Reconstruction/histgoodccc.spi">histgoodccc.spi</a> </font>         </li>
d691 1
a691 1
        <li><font color="teal">Check histogram using <a href="Reconstruction/fit.gnu">fit.gnu</a>, 
d703 1
a703 1
        <li><font color="teal"><a href="Reconstruction/goodparticlesbydf.spi">goodparticlesbydf.spi</a> </font></li>
d708 1
a708 1
            <a href="Reconstruction/big-goodparticlesbydf.spi">big-goodparticlesbydf.spi</a> </font>           </li>
d713 3
a715 3
        <li><font color="teal"><a href="Reconstruction/dfgoodapsh.spi">dfgoodapsh.spi</a> </font></li>
        <li><font color="teal">INPUT: <b>../Alignment/align_01_***</b>, <b>df***/goodparticles</b></font>      </li>
        <li><font color="teal">OUTPUT: <b>../Alignment/good-align_01_***</b>, <b>sel_particles***</b></font>   </li>
d762 1
a762 1
      <a href="Reconstruction/bps-inseries.spi">bps-inseries.spi</a>.</font></li>
d767 1
a767 1
    <a href="Reconstruction/bps-settings.spi">bps-settings.spi</a>. </font>
d777 1
a777 1
    <li><font color="teal">INPUT: <b>dala01_***</b>, <b>../Alignment/align_01_***</b>, 
d788 2
a789 2
<a href="Reconstruction/bps-inseries.spi"><b>bps-inseries</b></a>
    <a href="Reconstruction/bps-settings.spi">bps-settings</a>
d792 1
a792 1
    <a href="Reconstruction/bps-main.spi">bps-main</a>
d794 3
a796 3
        <a href="Reconstruction/bps-calcres.spi">bps-calcres</a>
    <a href="Reconstruction/bps-combine.spi">bps-combine</a>
        <a href="Reconstruction/bps-calcres.spi">bps-calcres</a>
d819 1
a819 1
        <li><font color="teal"><a href="Reconstruction/make_matched.spi">make_matched.spi</a></font></li>
d830 1
a830 1
        <li><font color="teal"><a href="Reconstruction/matchedfilter.spi">matchedfilter.spi</a></font></li>
d841 1
a841 1
        <li><font color="teal"><a href="Reconstruction/consecprepare.spi">consecprepare.spi</a></font></li>
d847 1
a847 1
             <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/mr.html">
d856 2
a857 4
             <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/prepare.pam">
             prepare.pam</a> in 
             <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/refine.html"> 
             Refinement</a> does this for you. 
d862 1
a862 2
             <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/refine_settings.pam">
             refine_settings.pam</a>
d880 2
a881 2
    <li><a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/refine.html">
        Refinement documentation</a>            </li>
d883 5
a887 4
         <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/refine_settings.pam">
         refine_settings.pam</a>,
         as written above by <a href="Reconstruction/consecprepare.spi">consecprepare.spi</a>               <br />
         <i> (Note the only change from the default is the prefix <b>good-</b> for these files) </i>: </font></li>
d906 1
a906 1
I have some <a href="VerifyMisc/misc.htm">miscellaneous procedure files here</a>.
d915 1
d917 1
d962 2
a963 1
    <li>2008-09-29 -- added <b>mkfilenums.py</b>, <b>shrink.spi</b>, and <b>.montagefromdoc</b> in <b>Micrographs/</b></li>
d965 5
a969 3
         SPIDER Techniques</a> page</li>
    <li>2008-02-01 -- selectbyviewall.spi -- added output <b>stack2particle***</b> with global particle number,  
        to compensate for a change to <b>sel_particles</b>. The following also changed accordingly:</li>
d983 1
a983 1
        <a href="../tar_archive/archive.htm">tarball</a>                                  </li>
@


1.4
log
@pubsub removed
@
text
@d19 1
a19 1
   <b>Out of date, legacy protocol, with dead links!!  </b> 
d56 1
a56 1
         and <a href="verifybyview.py">source code</a>                                               </li>
a78 76
<hr />

<p>
<b><font size="4"><a name="mods">Recent modifications:</a></font></b></p>
<ul>
<!--    <li>2012-date -- </li> -->
    <li>2012-07-19 --the following procedure files explicitly create necessary output directories: </li> 
        <ul>
            <li>eman2spider.spi</li>
            <li>rewindow.spi</li>
            <li>numberparticles.spi</li>
        </ul>
    <li>2012-05-23 -- changed <i>X##</i> format registers to named registers for the following procedure files:</li>
        <ul>
            <li>selectbyviewall.spi</li>
            <li>rewindow.spi</li>
            <li>recheck.spi </li>
            <li>goodparticlesbydf.spi </li>
            <li>eman2spider.spi </li>
            <li>combinegoodclasses.spi </li>
            <li>classify.spi </li>
        </ul>
    <li>2012-05-17 -- bps-pubsub.spi and bps-inseries.spi -- replace bps-by-df.spi</li> 
    <li>2012-05-15 -- filtering reconstruction using matched filter</li> 
    <li>2012-05-15 -- apsh-pubsub.spi and apsh-inseries.spi -- replace apshgrp.spi</li> 
    <li>2012-05-01 -- numberparticles.spi -- replaces pnums.spi and listallparticles.spi</li> 
    <li>2012-04-12 -- filterbyview.spi -- added option to not filter </li>
    <li>2012-04-06 -- eman2spider.spi -- added <b>sel_particles***</b> output</li>
    <li>2012-03-15 -- combinegoodclasses.spi -- summary doc file now has the format of old <b>how_many</b> files</li>
    <li>2011-01-14 -- bps-by-df.spi -- computes masked and unmasked FSCs</li>
    <li>2011-01-11 -- regroup.spi -- can quickly test sizes of new defocus groupings</li>
    <li>2011-01-07 -- consecprepare.spi -- new refinement procedure files use different and fewer inputs</li>
    <li>2010-09-02 -- emancoords2spiderdoc.py -- SPIDER and EMAN2 coordinate systems appear to be the same now</li> 
    <li>2009-07-10 -- documented various <a href="docfiles.htm">doc file formats</a></li>
    <li>2009-06-03 -- changed format of <b>Reconstruction/select/sel***</b> files, 
         now same format as <b>Reconstruction/select/prj***/sortsel</b>, for versatility and generality. 
         The following procedure files are affected:</li>
        <ul>
            <li>selectbyviewall.spi</li>
            <li>filterbyview.spi</li>
            <li>classify.spi</li>
            <li>combinedgoodclasses.spi</li>
            <li>reselect_byview.spi (in <b>VerifyMisc/</b>)</li>
        </ul>
    <li>2009-05-14 -- histgoodccc.spi -- added output histogram of bad particles</li>
    <li>2009-05-14 -- recheck.spi -- added optional step to add or subtract particles after re-screening</li>
    <li>2009-04-14 -- dfgoodapsh.spi -- output now called <b>sel_particles_***</b>, can work without defocus groups</li>
    <li>2009-04-07 -- included backup script <b>backup.sh</b> </li>
    <li>2009-02-26 -- added quick-start guide</li>
    <li>2009-02-26 -- added viewaverage.spi (optional) -- analogous to average.spi</li>
    <li>2008-09-29 -- added <b>mkfilenums.py</b>, <b>shrink.spi</b>, and <b>.montagefromdoc</b> in <b>Micrographs/</b></li>
    <li>2008-07-02 -- added to <a href="../../../docs/techniques.html">
         SPIDER Techniques</a> page</li>
    <li>2008-02-01 -- selectbyviewall.spi -- added output <b>stack2particle***</b> with global particle number,  
        to compensate for a change to <b>sel_particles</b>. The following also changed accordingly:</li>
        <ul>
            <li>histgoodccc.spi</li>
            <li>big-goodparticlesbydf.spi</li>
            <li>goodparticlesbydf.spi</li>
            <li>dfgoodapsh.spi</li>
        </ul>
    <li>2007-08-22 -- <a href="../tar_archive/archive.htm">archive of tarballs</a> linked to projection-matching tarballs</li>
    <li>2007-08-22 -- changed hard-to-read italic passages to less-hard-to-read <font color="teal">teal</font>.</li>
    <li>2007-01-31 -- significant re-write of procedure files in <a href="#verify">Verification</a> section.<br />
        Changes are <a href="changes20070131.txt">summarized here.</a></li>
    <li>2007-01-23 -- started <a href="../tar_archive/archive.htm">archive</a> of tarballs</li>
    <li>2006-08-29 -- <a href="verifybyview.py">verifybyview.py</a> -- stores prior settings in text file <b>.verifybyview</b></li>
    <li>2006-07-27 -- added <a href="verify.xml">SPIRE configuration file</a> to 
        <a href="../tar_archive/archive.htm">tarball</a></li>
    <li>2006-06-27 -- created <a href="../tar_archive/archive.htm">tarball</a> of procedure files</li>
    <li>2006-05-12 -- AP SH version is now the default</li>
    <li>2005-03-03 -- posted documentation on <a href="../VerifyDocs/interface.htm">Python/Tkinter interface</a></li>
    <li>2005-01-21 -- changed extensions from <b>.bat</b> to <b>.spi</b></li>
</ul>

<p><a href="#top">Return to top</a> </p>
d89 6
a94 5
    <li>Unpackage <a href="../../recon/spiproject.tar"> projection-matching procedure files</a> </li>
    <li>Unpackage <a href="../ve20140806.tar">          verification procedure files       </a> </li>
    <li>Copy <b>params</b> file or Run: spider spi/dat @@makeparams                             </li>
    <li>Copy reference volume and/or Run: spider spi/dat @@resizevol                            </li>
</OL>
d97 4
a100 4
    <li>mkfilenums ../filenums.dat mic*.dat          </li>
    <li>spider spi/dat @@shrink                       </li>
    <li>montagefromdoc  ../sel_micrograph.dat sm-mic*</li>
</OL>
d103 7
a109 7
    <li>spider spi/dat @@powdefocus                        </li>
    <li>montagefromdoc ../sel_micrograph.dat power/pw_avg*</li>
    <li>ctfmatch power/ctf* &amp;                         </li>
    <li>spider spi/dat @@defsort                           </li>
    <li>ctfgroup def_sort.dat                             </li>
    <li>spider spi/dat @@defavg                            </li>
</OL>
d117 1
a117 1
</OL>
d120 3
a122 3
    <li>spider spi/dat @@sel_by_group             </li>
    <li>spider spi/dat @@win2stk                  </li>
    <li>spider spi/dat @@refproj                  </li>
d124 1
a124 1
</OL>
d127 4
a130 4
    <li>spider spi/dat @@selectbyviewall</li>
    <li>spider spi/dat @@filterbyview</li>
    <li>spider spi/dat @@classify</li>
    <li>verifybyview</li>
d147 1
a147 1
</OL>
d153 1
a153 1
</OL>
d162 3
a164 2
    <li>Unpackage the "normal" <a href="../../recon/spiproject.tar"> projection-matching procedures tar archive </a> 
         first, and in its top-level directory                                                                  <br />
d187 4
a190 2
         The Python script in <b>Micrographs/</b> is more general.</font></li>
    <li>get reference volume </li>
d199 1
a199 2
<b><font size="4"><a name="mics">Micrographs</a></font></b> -- in <b>Micrographs/</b>
 directory</p>
d201 1
a201 1
    <li><font color="teal">Micrographs are assumed to have the file pattern <b>mic****</b></font></li>
d203 1
a203 1
         (substitituing the appropriate data extension):</li>
d206 1
a206 1
    <li><font color="teal">Shrink the micrographs</font></li>
d215 10
a224 8
    <li><font color="teal">(Optional) Screen the micrographs using montagefromdoc.py.</font></li>
    <ul>
            <li><font color="teal">Run: </li>
                <pre>montagefromdoc</pre> 
                The first popup window will contain hopefully reasonable settings, or
                you can enter <b>filenums</b> and the micrograph file-pattern on the command line 
                (in that order).</font>
            <li><font color="teal">Alternatively, to keep all the micrographs, in the 
d234 1
a234 2
<b><font size="4"><a name="ctf">CTF estimation</a></font></b> -- in <b>Power_Spectra/</b>
 directory</p>
d238 2
a239 2
        <li>INPUT:  <b>../Micrographs/mic****</b> </li>
        <li>OUTPUT: <b>power/pw_avg***</b>, <b>power/roo***</b> </li>
d242 3
a244 1
    <li><font color="teal">Screen the power spectra visually using montagefromdoc.py.</font></li>
d246 1
a246 1
            <li><font color="teal">Run: <pre>montagefromdoc</pre> 
d249 1
a249 1
                the image file pattern is <b>power/pw_avg****</b>.</font></li>
d251 1
a251 1
                 montagefromdoc.py, you may need to view a power spectrum in JWEB.</font></li>
d253 1
a253 2
                 will overwrite the original, however a backup copy will be saved.</font></li>

d258 2
a259 1
        <li><a href="../../../../spire/tools-docs/ctfmatch/ctfmatch.html"> ctfmatch.py</a> 
a262 18
    
    <li>defsort.spi </li>
    <ul>
        <li>INPUT:  <b>defocus</b> </li>
        <li>OUTPUT: <b>def_sort</b> </li>
    </ul>
    
    <li>Check the defocus groups</li>
    <ul>
        <li><a href="../../../../spire/tools-docs/ctfgroup.html">
             ctfgroup.py</a> is a nice program to edit the defocus groups.</li>
        <li>To run ctfgroup.py from the command line, type:</li>
             <pre>ctfgroup def_sort.dat</pre>
        <li>If you need to remove odd micrographs, save whatever new groupings in ctfgroup.py, 
             remove the offending micrographs from <b>def_sort</b> in a text editor, 
             and re-open ctfgroup.py. If you've removed many micrographs, to save time, 
             you may want to remove these filenumbers from <b>sel_micrograph</b>  
             in the top-level directory. If you don't, however, it won't cause any errors downstream.</li>
a263 7
    
    <li>defavg.spi </li>
    <ul>
        <li>INPUT: <b>def_sort</b> </li>
        <li>OUTPUT: <b>def_avg</b>, <b>order_defgrps</b> </li>
    </ul>
</ul>
d280 4
a283 3
                Selecting particles from micrographs in WEB is another option.</li>
            <li>INPUT: <font color="teal"><b>../Micrographs/mic****</b> (change from <b>raw****</b>)</font>, <b>../reference_volume</b>, <b>noise</b></li>
            <li>OUTPUT: <b>win/winser_****</b>, <b>coords/sndc****</b> </li>
d298 6
a303 3
                      <li>OUTPUT: <b>coords/sndc****</b></li>
                      <li>This procedure file runs Python script <a href="emancoords2spiderdoc.py">emancoords2spiderdoc.py</a>. <br />
                           To run a single micrograph, use the syntax (substituting the appropriate file names/numbers):</li>
d311 2
a312 2
                      <li>INPUT: <b>../Micrographs/mic****</b>, <b>coords/sndc****</b> </li>
                      <li>OUTPUT: <b>win/winser_****</b></li>
d317 1
a317 1
    </OL>
d326 2
a327 1
        Python utility <a href="../VerifyDocs/montagefromdoc.htm">montagefromdoc.py</a></font></li>
d333 1
a333 1
            <li><font color="teal">Run: <pre>montagefromdoc.py</pre> 
d375 1
a375 1
    </OL>
d377 1
a377 1
    <li><font color="teal">Skip renumber.spi</font> </li>
d383 1
a383 1
            (it is probably safe to err on the side of too many, or 0 will keep all of them) </font></li>
d385 2
a386 2
            (or <b>good/good****</b> if you selected particles from micrograph stacks)</font></li>
        <li><font color="teal">OUTPUT: <b>coords/ngood****</b> <b>coords/mic2global</b> </font></li>
d425 1
a425 1
                  <li><i>1</i> -- is the number of the master results file, and</li>
d428 1
a428 1
                       To monitor this file in real time, type:</li>
d431 1
a431 1
    </ul>-->
d443 2
a444 1
                    <br /> The command <a href="../../man/apsh.html">'AP SH'</a>
d447 2
a448 2
                        (See notein the
                        <a href="../../../man/apsh.html">'AP SH' manual</a>.) 
d480 3
a482 1
</tr></table></font>
d484 1
a484 2

    
d493 1
a493 1
   in <b>Reconstruction/</b> directory</font></p>
d496 1
a496 1
    <li><font color="teal">Make selection doc for each reference view. </font></li>
d498 6
a503 4
        <li><font color="teal"><a href="Reconstruction/selectbyviewall.spi">selectbyviewall.spi</a> </font></li>
        <li><font color="teal">SUBROUTINE: <a href="Reconstruction/reversedoc_7col.spi">reversedoc_7col.spi</a> </font></li>
        <li><font color="teal">INPUT: <b>align_01_***</b>, <b>../Alignment/sel_particles_***</b> </font></li>
        <li><font color="teal">OUTPUT: <b>stack2particle***</b>, <b>select/sel***</b></font></li>
d506 1
a506 1
    <li><font color="teal">Filter and (optionally) shrink particles. </font></li>
d509 2
a510 2
        <li><font color="teal">INPUT: <b>dala01_***</b>, <b>align_01_***</b> </font></li>
        <li><font color="teal">OUTPUT: <b>select/prj***/stkfilt</b> </font></li>
d514 1
a514 1
            <a href="Reconstruction/findctfminima.spi">findctfminima.spi</a>  </font></li>
d517 1
a517 1
            by setting parameter <i>[last-view]</i> to 1. </font></li>
d521 1
a521 1
            which instead writes <b>../Particles/flt/flt******</b></font> </li>
d524 1
a524 1
    <li><font color="teal">(Optional) Screen particles without classification. </font></li>
d529 1
a529 1
             <pre>montagefromdoc.py</pre>
d533 1
a533 1
             and output selection file, respectively. </font> </li>
d537 1
a537 1
             but you'll probably need to resize the window.</font> </li>
d542 2
a543 2
        <li><font color="teal"><a href="Reconstruction/classify.spi">classify.spi</a> </font></li>
        <li><font color="teal">INPUT: <b>select/sel***</b>, <b>select/prj***/stkfilt</b> </font></li>
d549 1
a549 1
            which uses <b>../Particles/flt/flt******</b> as an input.</font> </li>
d553 1
a553 1
            classes faster than SPIDER can calculate them.</font> </li>
d556 1
a556 1
            analysis to iterative PCA) and restart at that reference view. </font></li>
d561 1
a561 1
        in contrast to ~100,000 files in the case of unstacked particles.</font></li>
d564 1
a564 1
           depending on how much control you want/need:</font></li>
d569 1
a569 1
        <li><font color="teal"><a name="web">Options using WEB:</a> </li>
d574 1
a574 1
                    from worst cross-correlation to best. </font></li>
d577 1
a577 1
                    document file for each reference view. </font></li>
d580 1
a580 1
                    the appropriate document file <b>docclass{***class#}</b>. <br />
d583 2
a584 2
                    Particles will be sorted from worst cross-correlation to best. <br />
                    See <a href="../VerifyDocs/classavgs.htm">here</a> for an illustrated example.</font></li>
d587 2
a588 2
                        <li><font color="teal">Simply click on the good classes as described above. <br />
                            This will keep all of the particles in the good classes. </font></li>
d590 2
a591 2
                        <li><font color="teal">Manually click on the first good particle in each class. <br />
                            I recommend doing this until you get a feel for which classes are bad.<br />
d594 1
a594 1
                                <li><font color="teal">Click on the good classes as described above.</font></li>
d596 1
a596 1
                                    from doc file</i>, use <i>Categorize/Doc. file montage</i>. </font></li>
d599 1
a599 1
                                <li><font color="teal">When prompted for the key, enter the class-number. <br />
d608 1
a608 1
                            This is useful if classification didn't do a good job on your particles.</font></li>
d610 1
a610 1
                                <li><font color="teal">Click on the good classes as described above.</font></li>
d612 1
a612 1
                                <li><font color="teal">Name the output file <b>byhand{***class#}</b>. </font></li>
d617 1
a617 1
                            classes.  <br />
d619 1
a619 1
                            reference-view, you must use it for all classes.  <br />
d623 1
a623 1
                    </OL>
d630 2
a631 1
        <li><font color="teal">SUBROUTINE: <a href="Reconstruction/reversedoc_7col.spi">reversedoc_7col.spi</a> </font></li>
d633 1
a633 1
            <b>firstgoodparticle</b> (optional), <b>byhand</b> (optional)}</font></li>
d635 1
a635 1
         <b>select/combinestats</b> </font></li>
d638 1
a638 1
    <li><font color="teal">(Optional) Re-screen the particles by view. </font></li>
d640 1
a640 1
            <li><font color="teal">Screen particles using .montagefromdoc </font></li>
d644 1
a644 1
                For the output filename, use <b>prj001/notgood</b>.</font></li>
d650 1
a650 1
        <li><font color="teal"><a href="Reconstruction/recheck.spi">recheck.spi</a> </font></li>
d652 2
a653 1
                <li><font color="teal">SUBROUTINE: <a href="Reconstruction/reversedoc_7col.spi">reversedoc_7col.spi</a> </font></li>
d658 1
a658 1
                    A number might cause problems for montagefromdoc.py.</font></li>
d660 1
a660 1
        </OL>
d664 1
a664 1
        <li><font color="teal"><a href="Reconstruction/viewaverage.spi">viewaverage.spi</a> </font></li>
d666 1
a666 1
             If you ran recheck.spi, add the tiebreaker (e.g., <i>B</i>) to the filename. </font></li>
d673 1
a673 1
             In principle, you could re-screen your particles if there are still bad ones.</font></li>
d678 4
a681 4
        <li><font color="teal"><a href="Reconstruction/histgoodccc.spi">histgoodccc.spi</a> </font></li>
        <li><font color="teal">INPUT: <b>select/prj***/goodsel</b>, <b>select/prj***/badsel</b> <br />
             If you ran recheck.spi, add the tiebreaker (e.g., <i>B</i>) to the filename. </font></li>
        <li><font color="teal">OUTPUT: <b>combinedgood</b>, <b>histcccgood</b>, <b>histcccbad</b></font></li>
d692 1
a692 1
    <li><font color="teal">Separate total good-particle list by defocus-group. </font></li>
d695 2
a696 2
        <li><font color="teal">PARAMETER: fractional cutoff (optional, use 0.0 to keep all)</font> </li>
        <li><font color="teal">INPUTS: <b>combinedgood</b>, <b>stack2particle***</b></font></li>
d699 1
a699 1
            <a href="Reconstruction/big-goodparticlesbydf.spi">big-goodparticlesbydf.spi</a> </font></li>
d702 1
a702 1
    <li><font color="teal">Generate alignment documents with only good particles</font> </li>
d705 2
a706 2
        <li><font color="teal">INPUT: <b>../Alignment/align_01_***</b>, <b>df***/goodparticles</b></font></li>
        <li><font color="teal">OUTPUT: <b>../Alignment/good-align_01_***</b>, <b>sel_particles***</b></font> </li>
d708 1
a708 1
            <b>df***/goodparticles</b>, lacking only the <i>CCROT</i> column. </font> </li>
d721 1
a721 1
        -- for each defocus-group, separates particles by reference-view</li>
d723 2
a724 2
        <li><font color="teal">INPUT: Use <b>good-align_01_***</b> instead of <b>align_01_***</b></font></li>
        <li>OUTPUT: <b>df***/select/sel###</b>, <b>df***/how_many</b>, <b>how_many</b> </li>
d727 3
a729 3
    <li><font color="teal">Skip average.spi -- The equivalent was performed above by viewaverage.spi</font></li>
    <li><font color="teal">Skip cchistogram.spi -- The equivalent was performed above by histgoodccc.spi</font></li>
    <li><font color="teal">Skip ccthresh.spi  -- The equivalent was performed above by histgoodccc.spi</font></li>
d732 1
a732 1
    <li>plotrefviews.spi, display.spi (optional) -- graphically show distribution of views</li>
d734 2
a735 2
        <li>INPUT: <b>df***/how_many</b> </li>
        <li>OUTPUT: <b>gnuplot_view</b>, <b>display/cndis***</b> </li>
d738 1
a738 1
    <li>bestim.spi (optional) -- truncate <b>seltotal</b> files for overrepresented views </li>
d760 1
a760 1
    <li><font color="teal">PARAMETERS: </font></li>
d764 1
a764 1
                1 to copy into RAM, or 2 to copy temporarily to disk).</font></li>
d766 1
a766 1
               in order to distribute disk I/O.</font></li>
d769 1
a769 1
        <b>sel_particles_***</b> </font> </li>
d775 3
a777 1
<tr><td valign="top">
d782 1
a782 1
    
d788 2
a789 1
   </pre></td>
d791 2
a792 1
</tr></table></font>
d808 1
a808 1
    <li><font color="teal">Generate a matched-filter profile</font></li>
d811 2
a812 2
        <li><font color="teal">INPUT: <b>vol01_odd</b>, <b>vol01_even</b> </font></li>
        <li><font color="teal">OUTPUT: <b>docmatched_vol01</b> </font></li>
d819 1
a819 1
    <li><font color="teal">Apply the filter profile</font></li>
d822 2
a823 2
        <li><font color="teal">INPUT: <b>docmatched_vol01</b>, <b>vol01</b> </font></li>
        <li><font color="teal">OUTPUT: <b>vol01_matched</b> </font></li>
d827 1
a827 1
            </font></li>
d830 1
a830 1
    <li><font color="teal">Prepare files for refinement</font></li>
d834 1
a834 1
             <b>data***</b>, <b>dala01_***</b> </font></li>
d836 1
a836 1
             <b>good-data***</b>, <b>good-dala01_***</b> (optional, see NOTE below) </font></li>
d838 2
a839 2
            <a href="../../recon/mr.html">
            main, projection-matching procedure files</a>, the aligned-image stacks 
d844 1
a844 1
            </font></li>
d847 4
a850 2
             <a href="../../recon/newprogs/prepare.pam">prepare.pam</a> in 
             <a href="../../recon/refine.html"> Refinement</a> does this for you. 
d855 2
a856 1
             <a href="../../recon/newprogs/refine_settings.pam">refine_settings.pam</a>
d874 2
a875 1
    <li><a href="../../recon/refine.html">Refinement documentation</a>            </li>
d877 2
a878 1
         <a href="../../recon/newprogs/refine_settings.pam">refine_settings.pam</a>,
d902 77
@


1.3
log
@out of date, dead links!!
@
text
@d19 1
a19 1
   <b>Out of date, legacy protocol, with dead links!! </b> 
d56 5
a60 5
         and <a href="verifybyview.py">source code</a> </li>
    <li><a href="docfiles.htm">Doc file formats</a> </li>
    <li><a href="VerifyMisc/misc.htm">Miscellaneous procedure files</a> </li>
    <li><a href="../VerifyDocs/truncate-neg.htm">Editing <b>order_picked.dat</b></a> </li>
    <li><a href="../VerifyDocs/classavgs.htm">Picking whole classes using X-Window WEB</a> </li>
d72 2
a73 2
    <li>Data filenames will be in <b>bold</b>, and menu options will be in <i>italic</i>.</li>
    <li>Data extension is assumed to be <b>.dat</b>. Adjust accordingly.</li>
d165 2
a166 2
    <li>Unpackage <a href="../recon1b/spiproject.tar"> projection-matching procedure files</a> </li>
    <li>Unpackage <a href="../ve20140806.tar">         verification procedure files       </a> </li>
d237 2
a238 2
    <li>Unpackage the "normal" <a href="../recon1b/spiproject.tar"> projection-matching procedures tar archive </a> 
         first, and in its top-level directory                                              <br />
d535 3
a537 2
                        performs an orientational alignment, and chooses the best one.  (See note 9 in the
                        <a href="http://www.wadsworth.org/spider_doc/spider/docs/man/apsh.html">'AP SH' documentation</a>.) 
d553 1
a553 1
   <li><font color="teal">If you are not using Publish and Subscribe, run 
a554 12
   <li><font color="teal">If you are using <a href="http://www.wadsworth.org/spider_doc/spider/pubsub/pubsub.html">
      Publish and Subscribe</a>, run 
      <a href="Alignment/apsh-pubsub.spi">apsh-pubsub.spi</a> 
      according to the following steps:</font>
      <ul>
        <li><font color="teal">Copy the SPIDER executable to the local directory and rename it <i>spider</i>, <i><i>e.g.</i></i>:<br />
        <code>cp /spider/bin/spider_linux_mp_opt64.18.16 ./spider</code> <br /></font></li>
        <li><font color="teal">Start alignment with the following command: <br />
        <code>./spider spi/dat @@apsh-pubsub 1 &amp; </code><br />
        where <i>1</i> will be the number of the top-level SPIDER results file.</font></li>
      </ul>
   </li>
d558 1
d560 1
a568 11
   </pre></td>

   <td><pre>
<a href="Alignment/apsh-pubsub.spi"><b>apsh-pubsub</b></a>
    <a href="Alignment/apsh-settings.spi">apsh-settings</a>
    <a href="Alignment/apsh-check.spi">apsh-check</a>
    <a href="Alignment/apsh-distribute.spi">apsh-distribute</a>
        <a href="Alignment/apsh-main.spi">apsh-main</a>
            <a href="Alignment/apsh-wait.spi">apsh-wait</a>

</pre></td>
a833 4

   <font color="teal">The following options will depend on whether using you are using 
      <a href="http://www.wadsworth.org/spider_doc/spider/pubsub/pubsub.html">
      Publish and Subscribe</a> on a cluster:</font>
d836 1
a836 1
   <li><font color="teal">If you are not using Publish and Subscribe, run 
a837 12
   <li><font color="teal">If you are using <a href="http://www.wadsworth.org/spider_doc/spider/pubsub/pubsub.html">
      Publish and Subscribe</a>, run 
      <a href="Reconstruction/bps-pubsub.spi">bps-pubsub.spi</a> 
      according to the following steps:</font>
      <ul>
        <li><font color="teal">Copy the SPIDER executable to the local directory and rename it <i>spider</i>, <i><i>e.g.</i></i>:<br />
        <code>cp /spider/bin/spider_linux_mp_opt64.18.16 ./spider</code> <br /></font></li>
        <li><font color="teal">Start alignment with the following command: <br />
        <code>./spider spi/dat @@bps-pubsub 1 &amp; </code><br />
        where <i>1</i> will be the number of the top-level SPIDER results file.</font></li>
      </ul>
   </li>
a871 12
   <td><pre>
<a href="Reconstruction/bps-pubsub.spi"><b>bps-pubsub</b></a>
    <a href="Reconstruction/bps-settings.spi">bps-settings</a>
    <a href="Reconstruction/bps-check.spi">bps-check</a>
    <a href="Reconstruction/bps-distribute.spi">bps-distribute</a>
        <a href="Reconstruction/bps-main.spi">bps-main</a>
            <a href="Reconstruction/bps-wait.spi">bps-wait</a>
            <a href="Reconstruction/bps-calcres.spi">bps-calcres</a>
    <a href="Reconstruction/bps-combine.spi">bps-combine</a>
        <a href="Reconstruction/bps-calcres.spi">bps-calcres</a>

</pre></td>
d918 1
a918 1
            <a href="../../recon1a/Docs//mr.html">
d927 2
a928 3
             <a href="../../recon1a/Docs/prepare.pam">prepare.spi</a> in 
             <a href="../../recon1a/Docs/refine.html">
             Refinement</a> does this for you. 
d931 1
a931 1
             So, with this procedure file, only the desired particles will be retained. <br />
d933 1
a933 1
             <a href="../../recon1a/Docs/refine_settings.pam">refine_settings.pam</a>
d951 1
a951 2
    <li><a href="../../recon1a/Docs//refine.html">
        Refinement documentation</a> </li>
d953 2
a954 2
         <a href="../../recon1a/Docs//refine_settings.pam">refine_settings.pam</a>,
         as written above by <a href="Reconstruction/consecprepare.spi">consecprepare.spi</a> <br />
d957 5
a961 5
              <li><font color="teal"><b> good-sel_group_cclim </b></font></li>
              <li><font color="teal"><b> good-sel_particles_*** </b></font></li>
              <li><font color="teal"><b> good-data*** </b></font></li>
              <li><font color="teal"><b> good-dala01*** </b> </font></li>
              <li><font color="teal"><b> good-align_01_*** </b></font></li>
@


1.2
log
@*** empty log message ***
@
text
@d15 29
a43 25
<center><p> <font size="5"><b>
Particle verification for single-particle, reference-based reconstruction 
using multivariate data analysis and classification
</b></font>
<br />As described in <i>J Struct Biol</i> (2008) <b>161</b>: 41-48.
</p></center>

<hr \>

<p align="left"><b><font size="4"><a name="top">Outline</a></font></b> </p>

<ul>
    <li><a href="#links">Links</a></li>
    <li><a href="#notes">General notes </a></li>
    <li><a href="#mods">Recent modifications</a></li>
    <li><a href="#quick">Quick-start guide</a></li>
    <li>procedure files</a></li>
    <ul>
        <li><a href="#start">Getting started</a></li>
        <li><a href="#mics">Micrographs</a></li>
        <li><a href="#ctf">CTF estimation</a></li>
        <li><a href="#particles">Particle-picking</a></li>
        <li><a href="#align">Alignment</a></li>
        <li><a href="#verify">Particle-verification</a></li>
        <li><a href="#average">Compute averages</a></li>
d45 1
a45 1
        <li><a href="#refine">Refinement</a></li>
d47 1
a47 1
    <li><a href="#other">Additional procedure files</a></li>
d50 1
a50 1
<hr \>
d66 1
a66 1
<hr \>
d79 1
a79 1
<hr \>
d130 1
a130 1
    <li>2008-07-02 -- added to <a href="http://www.wadsworth.org/spider_doc/spider/docs/techniques.html">
d156 1
a156 1
<hr \>
d232 1
a232 1
<hr \>
d268 1
a268 1
<hr \>
d302 1
a302 1
<hr \>
d310 1
a310 1
        <li>INPUT: <b>../Micrographs/mic****</b> </li>
d329 2
a330 2
        <li><a href="http://www.wadsworth.org/spider_doc/spire/doc/guitools/ctfmatch/ctfmatch.html">
            ctfmatch.py</a> is a nice program to display the fitting. 
d336 1
a336 1
        <li>INPUT: <b>defocus</b> </li>
d342 1
a342 1
        <li><a href="http://www.wadsworth.org/spider_doc/spire/doc/guitools/ctfgroup.html">
d362 1
a362 1
<hr \>
d482 1
a482 1
<hr \>
d533 1
a533 1
                    <br /> The command <a href="http://www.wadsworth.org/spider_doc/spider/docs/man/apsh.html">'AP SH'</a>
d549 1
a549 2
      <a href="http://www.wadsworth.org/spider_doc/spider/pubsub/pubsub.html">
      Publish and Subscribe</a> on a cluster:</font>
d597 1
a597 1
<hr \>
d818 1
a818 1
<hr \>
d847 1
a847 1
<hr \>
d966 1
a966 1
            <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/mr.html">
d974 3
a976 2
             Now however, the subroutine <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/prepare.pam">
             prepare.pam</a> in <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/refine.html">
d982 1
a982 1
             <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/refine_settings.pam">refine_settings.pam</a>
d992 1
a992 1
<hr \>
d1000 1
a1000 1
    <li><a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/refine.html">
d1003 1
a1003 1
         <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/refine_settings.pam">refine_settings.pam</a>,
a1011 1
<!--              <li><font color="teal"><b>  </b></font></li>-->
d1020 1
a1020 1
<hr \>
d1026 1
a1026 1
<hr \>
@


1.1
log
@Initial revision
@
text
@d2 1
a2 9
<HTML>
<HEAD>
    <TITLE>Particle-picking batch files</TITLE>
</HEAD>
<BODY>
<P>
</P>
<P ALIGN="RIGHT">
<I>(Updated 2013 Jan 21)</I> </P>
d4 12
a15 2
<CENTER><P>
<FONT SIZE="5"><B>
d18 3
a20 3
</B></FONT>
<BR>As described in <I>J Struct Biol</I> (2008) <B>161</B>: 41-48.
</P></CENTER>
d22 1
a22 1
<HR>
d24 1
a24 1
<p align="left"><B><font size="4"><a name="top">Outline</a></font></B> </p>
d27 17
a43 17
    <LI><a href="#links">Links</a></LI>
    <LI><a href="#notes">General notes </a></LI>
    <LI><a href="#mods">Recent modifications</a></LI>
    <LI><a href="#quick">Quick-start guide</a></LI>
    <LI>Batch files</a></LI>
    <UL>
        <LI><a href="#start">Getting started</a></LI>
        <LI><a href="#mics">Micrographs</a></LI>
        <LI><a href="#ctf">CTF estimation</a></LI>
        <LI><a href="#particles">Particle-picking</a></LI>
        <LI><a href="#align">Alignment</a></LI>
        <LI><a href="#verify">Particle-verification</a></LI>
        <LI><a href="#average">Compute averages</a></LI>
        <LI><a href="#reconstruct">3D reconstruction</a></LI>
        <LI><a href="#refine">Refinement</a></LI>
    </UL>
    <LI><a href="#other">Additional batch files</a></LI>
d46 1
a46 1
<HR>
d48 82
a129 38
<P>
<B><FONT SIZE="4"><a name="links">Links:</a></FONT></B></P>
<UL>
    <LI><a href="../tar_archive/archive.htm">Tarball archive</a> </LI>
    <LI>montagefromdoc.py <a href="../VerifyDocs/montagefromdoc.htm">documentation</a>
         and <a href="montagefromdoc.py">source code</a> </LI>
    <LI>verifybyview.py <a href="../VerifyDocs/interface.htm">documentation</a>
         and <a href="verifybyview.py">source code</a> </LI>
    <LI><a href="docfiles.htm">Doc file formats</a> </LI>
    <LI><a href="VerifyMisc/misc.htm">Miscellaneous batch files</a> </LI>
    <LI><a href="../VerifyDocs/truncate-neg.htm">Editing <B>order_picked.dat</B></a> </LI>
    <LI><a href="../VerifyDocs/classavgs.htm">Picking whole classes using X-Window WEB</a> </LI>
    <LI><a href="../VerifyDocs/truncate-class.htm">Using the "first good" method in X-Window WEB</a> </LI>
<!--     <LI><a href="link">description</a> </LI> -->
</UL>

<P><A HREF="#top">Return to top</A> </P>

<HR>

<P>
<B><FONT SIZE="4"><a name="notes">General notes:</a></FONT></B></P>
<UL>
    <LI><font color="teal">Changes from the &quot;normal&quot; flow will be shown in teal</font>.</LI>
    <LI>Data filenames will be in <B>bold</B>, and menu options will be in <I>italic</I>.</LI>
    <LI>Data extension is assumed to be <B>.dat</B>. Adjust accordingly.</LI>
    <PRE>Console commands will be in Courier.</PRE>
</UL>

<P><A HREF="#top">Return to top</A> </P>

<hr>

<P>
<B><FONT SIZE="4"><a name="mods">Recent modifications:</a></FONT></B></P>
<UL>
<!--    <LI>2012-date -- </LI> -->
    <LI>2012-07-19 --the following batch files explicitly create necessary output directories: </LI> 
d131 4
a134 3
            <LI>eman2spider.spi</LI>
            <LI>rewindow.spi</LI>
            <LI>numberparticles.spi</LI>
d136 29
a164 80
    <LI>2012-05-23 -- changed <I>X##</I> format registers to named registers for the following batch files:</LI>
        <UL>
            <LI>selectbyviewall.spi</LI>
            <LI>rewindow.spi</LI>
            <LI>recheck.spi </LI>
            <LI>goodparticlesbydf.spi </LI>
            <LI>eman2spider.spi </LI>
            <LI>combinegoodclasses.spi </LI>
            <LI>classify.spi </LI>
        </UL>
    <LI>2012-05-17 -- bps-pubsub.spi and bps-inseries.spi -- replace bps-by-df.spi</LI> 
    <LI>2012-05-15 -- filtering reconstruction using matched filter</LI> 
    <LI>2012-05-15 -- apsh-pubsub.spi and apsh-inseries.spi -- replace apshgrp.spi</LI> 
    <LI>2012-05-01 -- numberparticles.spi -- replaces pnums.spi and listallparticles.spi</LI> 
    <LI>2012-04-12 -- filterbyview.spi -- added option to not filter </LI>
    <LI>2012-04-06 -- eman2spider.spi -- added <B>sel_particles***</B> output</LI>
    <LI>2012-03-15 -- combinegoodclasses.spi -- summary doc file now has the format of old <B>how_many</B> files</LI>
    <LI>2011-01-14 -- bps-by-df.spi -- computes masked and unmasked FSCs</LI>
    <LI>2011-01-11 -- regroup.spi -- can quickly test sizes of new defocus groupings</LI>
    <LI>2011-01-07 -- consecprepare.spi -- new refinement batch files use different and fewer inputs</LI>
    <LI>2010-09-02 -- emancoords2spiderdoc.py -- SPIDER and EMAN2 coordinate systems appear to be the same now</LI> 
    <LI>2009-07-10 -- documented various <a href="docfiles.htm">doc file formats</a></LI>
    <LI>2009-06-03 -- changed format of <B>Reconstruction/select/sel***</B> files, 
         now same format as <B>Reconstruction/select/prj***/sortsel</B>, for versatility and generality. 
         The following batch files are affected:</LI>
        <UL>
            <LI>selectbyviewall.spi</LI>
            <LI>filterbyview.spi</LI>
            <LI>classify.spi</LI>
            <LI>combinedgoodclasses.spi</LI>
            <LI>reselect_byview.spi (in <B>VerifyMisc/</B>)</LI>
        </UL>
    <LI>2009-05-14 -- histgoodccc.spi -- added output histogram of bad particles</LI>
    <LI>2009-05-14 -- recheck.spi -- added optional step to add or subtract particles after re-screening</LI>
    <LI>2009-04-14 -- dfgoodapsh.spi -- output now called <B>sel_particles_***</B>, can work without defocus groups</LI>
    <LI>2009-04-07 -- included backup script <B>backup.sh</B> </LI>
    <LI>2009-02-26 -- added quick-start guide</LI>
    <LI>2009-02-26 -- added viewaverage.spi (optional) -- analogous to average.spi</LI>
    <LI>2008-09-29 -- added <B>mkfilenums.py</B>, <B>shrink.spi</B>, and <B>.montagefromdoc</B> in <B>Micrographs/</B></LI>
    <LI>2008-07-02 -- added to <a href="http://www.wadsworth.org/spider_doc/spider/docs/techniques.html">
         SPIDER Techniques</a> page</LI>
    <LI>2008-02-01 -- selectbyviewall.spi -- added output <B>stack2particle***</B> with global particle number,  
        to compensate for a change to <B>sel_particles</B>. The following also changed accordingly:</LI>
        <UL>
            <LI>histgoodccc.spi</LI>
            <LI>big-goodparticlesbydf.spi</LI>
            <LI>goodparticlesbydf.spi</LI>
            <LI>dfgoodapsh.spi</LI>
        </UL>
    <LI>2007-08-22 -- <a href="../tar_archive/archive.htm">archive of tarballs</a> linked to projection-matching tarballs</LI>
    <LI>2007-08-22 -- changed hard-to-read italic passages to less-hard-to-read <font color="teal">teal</font>.</LI>
    <LI>2007-01-31 -- significant re-write of batch files in <a href="#verify">Verification</a> section.<BR>
        Changes are <A HREF="changes20070131.txt">summarized here.</A></LI>
    <LI>2007-01-23 -- started <a href="../tar_archive/archive.htm">archive</a> of tarballs</LI>
    <LI>2006-08-29 -- <A HREF="verifybyview.py">verifybyview.py</A> -- stores prior settings in text file <B>.verifybyview</B></LI>
    <LI>2006-07-27 -- added <a href="verify.xml">SPIRE configuration file</a> to 
        <a href="../tar_archive/archive.htm">tarball</a></LI>
    <LI>2006-06-27 -- created <a href="../tar_archive/archive.htm">tarball</a> of batch files</LI>
    <LI>2006-05-12 -- AP SH version is now the default</LI>
    <LI>2005-03-03 -- posted documentation on <A HREF="../VerifyDocs/interface.htm">Python/Tkinter interface</a></LI>
    <LI>2005-01-21 -- changed extensions from <B>.bat</B> to <B>.spi</B></LI>
</UL>

<P><A HREF="#top">Return to top</A> </P>

<HR>

<P>
<B><FONT SIZE="4"><a name="quick">Quick-start guide</a></FONT></B></P>

<P>Options limited for the sake of simplicity. For more details, see below.</P>

<P><a href="#start">In toplevel directory (<I>e.g.</I>, <B>myproject/</B>):</a></P>
<OL>
    <LI>Unpackage <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/batcharch/">
        projection-matching batch files</a> </LI>
    <LI>Unpackage <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/verify/tar_archive/archive.htm">
        verification batch files</a> </LI>
    <LI>Copy <B>params</B> file or spider spi/dat @@makeparams</LI>
    <LI>Copy reference volume and/or spider spi/dat @@resizevol</LI>
d166 5
a170 5
<P><a href="#mics">In <B>Micrographs/</B></a>: </P>
<OL start=5>
    <LI>mkfilenums.py ../filenums.dat mic*.dat</LI>
    <LI>spider spi/dat @@shrink</LI>
    <LI>montagefromdoc.py ../sel_micrograph.dat sm-mic*</LI>
d172 8
a179 8
<P><a href="#ctf">In <B>Power_Spectra/</B></a>: </P>
<OL start=8>
    <LI>spider spi/dat @@powdefocus</LI>
    <LI>montagefromdoc.py ../sel_micrograph.dat power/pw_avg*</LI>
    <LI>ctfmatch.py power/ctf* &amp;</LI>
    <LI>spider spi/dat @@defsort</LI>
    <LI>ctfgroup.py def_sort.dat</LI>
    <LI>spider spi/dat @@defavg</LI>
d181 7
a187 7
<P><a href="#particles">In <B>Particles/</B></a>: </P>
<OL start=14>
    <LI>Copy noise file, or spider spi/dat @@noise</LI>
    <LI>e2boxer.py </LI>
    <LI>spider spi/dat @@eman2spider</LI>
    <LI>spider spi/dat @@rewindow</LI>
    <LI>spider spi/dat @@numberparticles</LI>
d189 6
a194 6
<P><a href="#align">In <B>Alignment/</B></a>: </P>
<OL start=20>
    <LI>spider spi/dat @@sel_by_group</LI>
    <LI>spider spi/dat @@win2stk</LI>
    <LI>spider spi/dat @@refproj</LI>
    <LI>./spider spi/dat @@apsh-pubsub &amp;</LI>
d196 22
a217 22
<P><a href="#verify">In <B>Reconstruction/</B></a>: </P>
<OL start=24>
    <LI>spider spi/dat @@selectbyviewall</LI>
    <LI>spider spi/dat @@filterbyview</LI>
    <LI>spider spi/dat @@classify</LI>
    <LI>verifybyview.py</LI>
    <LI>spider spi/dat @@combinegoodclasses</LI>
    <LI>(optional) spider spi/dat @@recheck</LI>
    <LI>(optional) spider spi/dat @@viewaverage</LI>
    <LI>spider spi/dat @@histgoodccc</LI>
    <LI>spider spi/dat @@goodparticlesbydf</LI>
    <LI>spider spi/dat @@dfgoodapsh</LI>
    <LI>(optional) spider spi/dat @@select</LI>
    <LI>(optional) spider spi/dat @@plotrefviews</LI>
    <LI>(optional) spider spi/dat @@display</LI>
    <LI>(optional) spider spi/dat @@bestim</LI>
    <LI>./spider spi/dat bps-pubsub &amp;</LI>
    <LI>(optional) spider spi/dat @@slices</LI>
    <LI>spider spi/dat @@plotres</LI>
    <LI>spider spi/dat @@make_matched</LI>
    <LI>spider spi/dat @@matchedfilter</LI>
    <LI>spider spi/dat @@consecprepare</LI>
d219 5
a223 5
<P><a href="#refine">In <B>Refinement/</B></a>: </P>
<OL start=44>
    <LI>Edit <B>refine_settings</B> </LI>
    <LI>./spider pam/dat @@pub_refine &amp; </LI>
    <LI>spider spi/dat @@plotrefres</LI>
d226 1
a226 1
<P><A HREF="#top">Return to top</A> </P>
d228 1
a228 1
<HR>
d230 15
a244 16
<P>
<B><FONT SIZE="4"><a name="start">Getting started</a></FONT></B></P>
<UL>
    <LI>Download "normal" projection-matching tarball and supplemental, verification tarball 
        <a href="../tar_archive/archive.htm">both archived here</a>. 
        Unpackage <B>spiproject.tar.gz</B> first, and in the top-level directory 
        (e.g., <b>myproject/</b>), unpackage the verification tarball. </LI>
    
    <LI>If using SPIRE:</LI>
    <UL>
        <LI>Type: </LI>
            <PRE>spire &amp; </PRE>
        <LI>Type something, anything, under <I>Project title</I>.</LI>
        <LI>Enter data extension under <I>data extension</I>. 
             Here, I will assume <B>.dat</B>, so adjust accordingly.</LI>
        <LI>Under <I>Directory for this project</I>, 
d246 42
a287 42
             Sometimes the data extension is appended, thus defining a new directory.</LI>
        <LI>Under <I>Configuration file</I>, select <B>verify.xml</B>, 
             using the <I>Browse</I> button if necessary.</LI>
        <LI>Uncheck the button <I>Create directories and load batch files</I>.</LI>
    </UL>
    
    <LI>makeparams.spi </LI>
    <UL>
        <LI>OUTPUT: <B>params</B></LI>
    </UL>
    <LI><font color="teal">Skip makefilelist.spi -- 
         The Python script in <B>Micrographs/</B> is more general.</font></LI>
    <LI>get reference volume </LI>
    <LI>(optional) resizevol.spi -- interpolates reference-volume</LI>
</UL>

<P><A HREF="#top">Return to top</A> </P>

<HR>

<P>
<B><FONT SIZE="4"><a name="mics">Micrographs</a></FONT></B> -- in <b>Micrographs/</b>
 directory</P>
<UL>
    <LI><font color="teal">Micrographs are assumed to have the file pattern <B>mic****</B></font></LI>
    <LI><font color="teal">To generate a SPIDER doc file containing a list of micrographs, type
         (substitituing the appropriate data extension):</LI>
         <PRE>mkfilenums.py ../filenums.dat mic*.dat</PRE></font>
    
    <LI><font color="teal">Shrink the micrographs</font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Micrographs/shrink.spi">shrink.spi</A></font></LI>
        <LI><font color="teal">PARAMETER: decimation factor (so that 
             the micrograph fits on the screen at 1X)</font></LI>
        <LI><font color="teal">INPUT: <B>mic****</B> </font></LI>
        <LI><font color="teal">OUTPUT: <B>sm-mic****</B> </font></LI>
    </UL>
    
    <LI><font color="teal">(Optional) Screen the micrographs using montagefromdoc.py.</font></LI>
    <UL>
            <LI><font color="teal">Run: </LI>
                <PRE>montagefromdoc.py</PRE> 
d289 1
a289 1
                you can enter <B>filenums</B> and the micrograph file-pattern on the command line 
d291 22
a312 22
            <LI><font color="teal">Alternatively, to keep all the micrographs, in the 
                 top-level directory, copy <B>filenums</B> to <B>sel_micrograph</B>.</font></LI>
    </UL>
</UL>

<P><A HREF="#top">Return to top</A> </P>

<HR>

<P>
<B><FONT SIZE="4"><a name="ctf">CTF estimation</a></FONT></B> -- in <b>Power_Spectra/</b>
 directory</P>
<UL>
    <LI>powdefocus.spi (slow)</LI>
    <UL>
        <LI>INPUT: <B>../Micrographs/mic****</B> </LI>
        <LI>OUTPUT: <B>power/pw_avg***</B>, <B>power/roo***</B> </LI>
    </UL>
    
    <LI><font color="teal">Screen the power spectra visually using montagefromdoc.py.</font></LI>
    <UL>
            <LI><font color="teal">Run: <PRE>montagefromdoc.py</PRE> 
d314 30
a343 30
                If not, the input doc file is <B>sel_micrograph</B> and 
                the image file pattern is <B>power/pw_avg****</B>.</font></LI>
            <LI><font color="teal">To enhance the contrast more than is possible in 
                 montagefromdoc.py, you may need to view a power spectrum in JWEB.</font></LI>
            <LI><font color="teal">The output selection doc file, <B>sel_micrograph</B>, 
                 will overwrite the original, however a backup copy will be saved.</font></LI>

    </UL>
    
    <LI>Screen the determined defocus values.</LI>
    <UL>
        <LI><A HREF="http://www.wadsworth.org/spider_doc/spire/doc/guitools/ctfmatch/ctfmatch.html">
            ctfmatch.py</A> is a nice program to display the fitting. 
            If removing bad micrographs, name the list of remaining good micrographs <B>sel_micrograph</B>.</LI>
    </UL>
    
    <LI>defsort.spi </LI>
    <UL>
        <LI>INPUT: <B>defocus</B> </LI>
        <LI>OUTPUT: <B>def_sort</B> </LI>
    </UL>
    
    <LI>Check the defocus groups</LI>
    <UL>
        <LI><A HREF="http://www.wadsworth.org/spider_doc/spire/doc/guitools/ctfgroup.html">
             ctfgroup.py</A> is a nice program to edit the defocus groups.</LI>
        <LI>To run ctfgroup.py from the command line, type:</LI>
             <PRE>ctfgroup.py def_sort.dat</PRE>
        <LI>If you need to remove odd micrographs, save whatever new groupings in ctfgroup.py, 
             remove the offending micrographs from <B>def_sort</B> in a text editor, 
d345 47
a391 47
             you may want to remove these filenumbers from <B>sel_micrograph</B>  
             in the top-level directory. If you don't, however, it won't cause any errors downstream.</LI>
    </UL>
    
    <LI>defavg.spi </LI>
    <UL>
        <LI>INPUT: <B>def_sort</B> </LI>
        <LI>OUTPUT: <B>def_avg</B>, <B>order_defgrps</B> </LI>
    </UL>
</UL>

<P><A HREF="#top">Return to top</A> </P>

<HR>

<P>
<B><FONT SIZE="4"><a name="particles">Particle-picking</a></FONT></B> -- in <b>Particles/</b>
 directory</P>
<UL>
    <LI>Get noise file, either from previous project or from noise.spi </LI>

    <LI>Window particles from micrographs (slow).</LI>
    <OL>
    <LI>pick.spi</LI>
        <UL>
            <LI>pick.spi calls pick_p.spi. <BR>
                Selecting particles from micrographs in WEB is another option.</LI>
            <LI>INPUT: <font color="teal"><B>../Micrographs/mic****</B> (change from <B>raw****</B>)</font>, <B>../reference_volume</B>, <B>noise</B></LI>
            <LI>OUTPUT: <B>win/winser_****</B>, <B>coords/sndc****</B> </LI>
        </UL>
    
    <LI>lfc_pick.spi</LI>
        <UL>
            <LI>lfc_pick.spi calls pickparticle.spi.</LI>
            <LI>INPUT: <B>../Micrographs/mic****</B> (change from <B>raw****</B>, <B>../reference_volume</B>, <B>noise</B></LI>
            <LI>OUTPUT: <B>win/winser_****</B>, <B>coords/sndc****</B> </LI>
        </UL>
    
    <LI>boxer/e2boxer.py in EMAN/EMAN2</LI>
        <UL>
            <LI>After picking particles with boxer, run <A HREF="Particles/eman2spider.spi">eman2spider.spi</A>.
                 <UL>
                      <LI>INPUT: <B>../Micrographs/mic****.box</B> (<I>e2boxer</I> coordinate file) </LI>
                      <LI>OUTPUT: <B>coords/sndc****</B></LI>
                      <LI>This batch file runs Python script <A HREF="emancoords2spiderdoc.py">emancoords2spiderdoc.py</A>. <BR>
                           To run a single micrograph, use the syntax (substituting the appropriate file names/numbers):</LI>
                           <PRE>emancoords2spiderdoc.py input_eman_coords0001.box coords/sndc0001.dat</PRE>
d394 10
a403 10
                </UL>
            <LI>Then, window out the images using 
                <A HREF="Particles/rewindow.spi">rewindow.spi</A></LI>
                 <UL>
                      <LI>INPUT: <B>../Micrographs/mic****</B>, <B>coords/sndc****</B> </LI>
                      <LI>OUTPUT: <B>win/winser_****</B></LI>
                      <LI>This is also a useful batch file if I want to use a different window size, 
                          or if I've deleted the <B>winser</B> files to free up disk space.</LI>
                 </UL>
        </UL>
d406 2
a407 2
    <LI><font color="teal">(Optional) Select particles from micrograph stacks.</font>
        <BR><font color="teal">lfc_pick.spi sorts particles by high cross-correlation to 
d411 1
a411 1
        This step will save time and disk space and will help the classification.  <BR>
d413 3
a415 3
        Python utility <a href="../VerifyDocs/montagefromdoc.htm">montagefromdoc.py</a></font></LI>
    <OL>
        <LI><font color="teal">Using montagefromdoc.py -- 
d417 3
a419 3
            (e.g., filtershrink.spi) but Python display is slower than WEB. </font></LI>
        <UL>
            <LI><font color="teal">Run: <PRE>montagefromdoc.py</PRE> 
d421 1
a421 1
                such as input <B>coords/sndc****</B> and output <B>good/good****</B>.
d423 5
a427 5
                <PRE>montagefromdoc.py coords/sndc1234 win/winser_1234</PRE></font></LI>
        </UL>
        <LI><font color="teal">Using WEB</font></LI>
        <UL>
            <LI><font color="teal">Under <i>Options/Image</i> turn on filenames, and 
d429 4
a432 4
                Open the stacks <B>win/winser_****</B>.</font> </LI>
            <LI>There used to be batch files 
                <A HREF="Particles/filtershrink.spi">filtershrink.spi</A> and
                <A HREF="Particles/negmontagedocs.spi">negmontagedocs.spi</A>  
d435 1
a435 1
                to have these batch files updated.  </LI>
d437 4
a440 4
            <LI>In WEB, using <i>Montage from doc file</i>, display montages. <BR>
                For example, assuming the montages are in the <B>coords/</B>
                directory, under <I>Image file template</I>; type &quot;<B>../win/ser******</B>&quot;
                (or &quot;<B>../flt/flt******</B>&quot; if you've filtered the particles already). <BR>
d442 17
a458 17
                (under <i>Options/Font</i>).</font></LI>
            <LI><font color="teal">Filter particles and optionally shrink them.</font></LI>
            <UL>
                <LI><font color="teal"><A HREF="Particles/filtershrink.spi">filtershrink.spi</A> 
                    </font> </LI>
                <LI><font color="teal">INPUT: <B>win/ser******</B> (default will be <B>ali/sar******</B>)</font> </LI>
                <LI><font color="teal">OUTPUT: <B>flt/flt******</B> </font></LI>
            </UL>

            <LI><font color="teal">Separate particles into montages that will fit on the screen.</font></LI>
            <UL>
                <LI><font color="teal"><A HREF="Particles/negmontagedocs.spi">negmontagedocs.spi</A> </font></LI>
                <LI><font color="teal">INPUT: <B>order_picked</B> </font></LI>
                <LI><font color="teal">OUTPUT: <B>coords/docmontage****_##</B> </font></LI>
                <LI><font color="teal">The default number of particles per montage is 150.<BR>
                    At 65x65 pixels, ten rows of 15 particles fit nicely on a screen.</font> </LI>
            </UL>
d460 1
a460 1
        </UL>
d463 1
a463 1
    <LI><font color="teal">Skip renumber.spi</font> </LI>
d465 44
a508 44
    <LI><font color="teal">Assign global particle number for each particle. </font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Particles/numberparticles.spi">numberparticles.spi</A> </font></LI>
        <LI><font color="teal">PARAMETER: maximum particles per micrograph 
            (it is probably safe to err on the side of too many, or 0 will keep all of them) </font></LI>
        <LI><font color="teal">INPUT: <B>win/sel_particle_****</B> 
            (or <B>good/good****</B> if you selected particles from micrograph stacks)</font></LI>
        <LI><font color="teal">OUTPUT: <B>coords/ngood****</B> <B>coords/mic2global</B> </font></LI>
    </UL>
</UL>

<P><A HREF="#top">Return to top</A> </P>

<HR>

<P>
<B><FONT SIZE="4"><a name="align">Alignment</a></FONT></B> -- in <b>Alignment/</b> directory</P>
<UL>
    <LI>sel_by_group.spi</LI>
    <UL>
        <LI>INPUT: <B>../Particles/good/ngood{****[mic]}</B></LI>
        <LI>OUTPUT: <B>sel_particles_***</B>, <B>sel_group</B></LI>
    </UL>

    <LI>win2stk.spi</LI>
    <UL>
        <LI>INPUT: <B>../Particles/win/winser_***@@</B>, <B>../Particles/good/ngood{****[mic]}</B></LI>
        <LI>OUTPUT: <B>data***</B></LI>
    </UL>

    <LI>refproj.spi </LI>
    <UL>
        <LI>INPUT: <B>reference</B>, <B>../Power_Spectra/order_defgrps</B> </LI>
        <LI>OUTPUT: <B>refangles</B>, <B>prj_####@@****</B> </LI>
    </UL>
    
<!--    <LI>apshgrp.spi </LI>
    <UL>
        <LI>INPUT: <B>prj_####@@****</B>, <B>data***</B>, <B>sel_particles_***</B></LI>
        <LI>OUTPUT: <B>align_01_***</B>, <B>dala01_***</B></LI>
        <LI>To run it using PubSub, change the <I>[pubsub]</I> flag in the batch file, and 
             copy the SPIDER executable to the local directory, i.e., <B>./spider</B> <BR> 
             The syntax will be:</LI>
             <PRE>./spider spi/dat @@apshgrp 1 > log1.txt &amp; </PRE>
d510 3
a512 3
             <UL>
                  <LI><I>1</I> -- is the number of the master results file, and</LI>
                  <LI><B>log1.txt</B> -- is a file that contains the screen output, 
d514 4
a517 4
                       To monitor this file in real time, type:</LI>
                       <PRE>tail -f log1.txt</PRE>
             </UL>
    </UL>-->
d521 1
a521 1
    <br><br><font color="teal">Alignment is CPU-intensive and benefits by parallelization. 
d524 7
a530 7
    <UL>
        <LI><font color="teal">PARAMETERS: </font></LI>
            <UL>
                <LI><font color="teal"><I>[shrange]</I> -- translation search range </font></li>
                <li><font color="teal"><I>[step]</I> -- translation step size 
                    <BR> The command <a href="http://www.wadsworth.org/spider_doc/spider/docs/man/apsh.html">'AP SH'</a>
                        tries different combinations of shifts in increments of <I>[step]</I> up to <I>[shrange]</I>, 
d533 5
a537 5
                    <BR> For example, with a <I>[step]</I> and <I>[shrange]</I> both of 2, 
                        'AP SH' will try shifts of (-2,2),(0,2),(2,2),(-2,0),(0,0),(2,0),(-2,-2),(0,-2), and (2,-2).</font> </LI>
                <li><font color="teal"><I>[r2]</I> -- outer alignment radius (pixels) 
                    <BR> The sum of <I>[shrange]</I> and <I>[r2]</I> must be less than half the image dimension</font></li>
               <li><font color="teal"><I>[max-wait]</I> -- Will wait up to 10 minutes by default before reading a new group's stack, 
d539 4
a542 4
            </UL>
        <LI><font color="teal">INPUT: <B>projs/prj_***</B>, <B>data***</B> </font> </LI>
        <LI><font color="teal">OUTPUT: <B>align_01_***, dala01_***</B></font> </LI>
    </UL>
d544 1
a544 1
   <br><font color="teal">The following options will depend on whether using you are using 
d555 7
a561 7
      <UL>
        <LI><font color="teal">Copy the SPIDER executable to the local directory and rename it <I>spider</I>, <i><i>e.g.</i></i>:<BR>
        <code>cp /spider/bin/spider_linux_mp_opt64.18.16 ./spider</code> <br /></font></LI>
        <LI><font color="teal">Start alignment with the following command: <BR>
        <code>./spider spi/dat @@apsh-pubsub 1 &amp; </code><BR>
        where <I>1</I> will be the number of the top-level SPIDER results file.</font></LI>
      </UL>
d565 1
a565 1
<P><font color="teal">The following is a brief tree of procedure calls:</font>
d569 1
a569 1
<a href="Alignment/apsh-inseries.spi"><B>apsh-inseries</B></a>
d578 1
a578 1
<a href="Alignment/apsh-pubsub.spi"><B>apsh-pubsub</B></a>
d587 1
a587 1
</P>
d590 1
a590 1
</UL>
d592 1
a592 1
<P><A HREF="#top">Return to top</A> </P>
d594 1
a594 1
<HR>
d596 19
a614 19
<P>
<font color="teal"><B><FONT SIZE="4"><a name="verify">Verify Particles</a></FONT></B> -- 
   in <b>Reconstruction/</b> directory</font></P>

<UL>
    <LI><font color="teal">Make selection doc for each reference view. </font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/selectbyviewall.spi">selectbyviewall.spi</A> </font></LI>
        <LI><font color="teal">SUBROUTINE: <A HREF="Reconstruction/reversedoc_7col.spi">reversedoc_7col.spi</A> </font></LI>
        <LI><font color="teal">INPUT: <B>align_01_***</B>, <B>../Alignment/sel_particles_***</B> </font></LI>
        <LI><font color="teal">OUTPUT: <B>stack2particle***</B>, <B>select/sel***</B></font></LI>
    </UL>

    <LI><font color="teal">Filter and (optionally) shrink particles. </font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/filterbyview.spi">filterbyview.spi</A> </font></LI>
        <LI><font color="teal">INPUT: <B>dala01_***</B>, <B>align_01_***</B> </font></LI>
        <LI><font color="teal">OUTPUT: <B>select/prj***/stkfilt</B> </font></LI>
        <LI><font color="teal">The goal with the filter parameters was to be able to ignore CTF effects. 
d617 5
a621 5
            <A HREF="Reconstruction/findctfminima.spi">findctfminima.spi</a>  </font></LI>
        <LI><font color="teal">To test the filter parameters, 
            try running this batch file on just the particles in one reference view, 
            by setting parameter <i>[last-view]</i> to 1. </font></LI>
        <LI><font color="teal">If you're using old, X-Window WEB, which
d623 7
a629 7
            <A HREF="Reconstruction/filtershrinksh.spi">filtershrinksh.spi</A>, 
            which instead writes <B>../Particles/flt/flt******</B></font> </LI>
    </UL>

    <LI><font color="teal">(Optional) Screen particles without classification. </font></LI>
    <UL>
        <LI><font color="teal">You can optionally screen the particles without classification.
d632 1
a632 1
             <PRE>montagefromdoc.py</PRE>
d634 21
a654 21
             If not, enter <B>select/sortsel001.dat</B>, <B>select/prj001/stkfilt.dat</B>, and 
             <B>select/prj001/goodsel.dat</B> for the input selection filename, particle filename, 
             and output selection file, respectively. </font> </LI>
        <LI><font color="teal">If you perform this step, skip ahead past combinegoodclasses.spi</font> </LI>
        <LI><font color="teal">The particles are sorted by correlation coefficient, from highest to lowest. 
             You can display the CCROT values by clicking the checkbutton under <I>Display/Labels</I>,
             but you'll probably need to resize the window.</font> </LI>
    </UL>

    <LI><font color="teal">Run correspondence analysis and separate particles into classes. </font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/classify.spi">classify.spi</A> </font></LI>
        <LI><font color="teal">INPUT: <B>select/sel***</B>, <B>select/prj***/stkfilt</B> </font></LI>
        <LI><font color="teal">OUTPUT: <B>select/prj***/{docclass###</B>, <B>classavg###</B>, 
            <B>listclasses</B>} </font></LI>
        <LI><font color="teal">If you're running X-Windows WEB (or for some other reason ran 
            <A HREF="Reconstruction/filtershrinksh.spi">filtershrinksh.spi</A>) instead run 
            <A HREF="Reconstruction/unstacked-classify.spi">unstacked-classify.spi</A>, 
            which uses <B>../Particles/flt/flt******</B> as an input.</font> </LI>
        <LI><font color="teal">You can select good class-averages for a reference-view as 
            soon as the batch file starts on a subsequent reference-view (as 
d656 6
a661 6
            classes faster than SPIDER can calculate them.</font> </LI>
        <LI><font color="teal">During MSA, SPIDER may hang at a particular reference view.
            If this happens, switch to a different MSA method (<I>e.g.,</I> from correspondence 
            analysis to iterative PCA) and restart at that reference view. </font></LI>
    </UL>
    <LI><font color="teal">If you would like to verify particles on a different computer, 
d664 1
a664 1
        in contrast to ~100,000 files in the case of unstacked particles.</font></LI>
d666 4
a669 4
    <LI><font color="teal">There are four options for keeping particles, 
           depending on how much control you want/need:</font></LI>
        <UL>
        <LI><font color="teal">Option using Python/Tkinter:<BR>
d671 4
a674 4
            More information found <A HREF="../VerifyDocs/interface.htm">here</A>.</font></LI>
        <LI><font color="teal"><a name="web">Options using WEB:</a> </LI>
            <UL>
                <LI>First, select good class-averages in WEB using <i>Categorize/Sequential 
d676 3
a678 3
                    file montage </i>(using <B>listclasses</B>) to show them 
                    from worst cross-correlation to best. </font></LI>
                <LI><font color="teal">Name the resulting list of good classes <B>goodclasses</B> and 
d680 2
a681 2
                    document file for each reference view. </font></LI>
                <LI><font color="teal">Check member particles -- in 
d683 26
a708 26
                    the appropriate document file <B>docclass{***class#}</B>. <BR>
                    The <I>Image file template</I> in WEB should be 
                    &quot;<B>../../../Particles/flt******</B>&quot; <BR>
                    Particles will be sorted from worst cross-correlation to best. <BR>
                    See <A HREF="../VerifyDocs/classavgs.htm">here</A> for an illustrated example.</font></LI>
                <LI><font color="teal">There are three levels of control in verifying particles using WEB:</font></LI>
                    <OL>
                        <LI><font color="teal">Simply click on the good classes as described above. <BR>
                            This will keep all of the particles in the good classes. </font></LI>

                        <LI><font color="teal">Manually click on the first good particle in each class. <BR>
                            I recommend doing this until you get a feel for which classes are bad.<BR>
                            See <A HREF="../VerifyDocs/truncate-class.htm">here</A> for an illustrated example.</font></LI>
                            <UL>
                                <LI><font color="teal">Click on the good classes as described above.</font></LI>
                                <LI><font color="teal">Instead of displaying class-montages with <i>Montage 
                                    from doc file</i>, use <i>Categorize/Doc. file montage</i>. </font></LI>
                                <LI><font color="teal">Name the output file <B>firstgoodparticle</B>. There 
                                    should be one file for each reference-view. </font></LI>
                                <LI><font color="teal">When prompted for the key, enter the class-number. <BR>
                                    If there isn't a key for each good class, the next batch 
                                    file (combinegoodclasses.spi) will crash. </font></LI>
                                <LI><font color="teal">Click on the first good particle for each class that has 
                                    particles you want to keep, e.g., the first one to keep all of them.</font></LI>
                            </UL>
                        <LI><font color="teal">Manually click on the good particles in each class. <BR>
d711 7
a717 7
                            This is useful if classification didn't do a good job on your particles.</font></LI>
                            <UL>
                                <LI><font color="teal">Click on the good classes as described above.</font></LI>
                                <LI><font color="teal">Display the class-montages using <i>Categorize/Doc. file montage</i>. </font></LI>
                                <LI><font color="teal">Name the output file <B>byhand{***class#}</B>. </font></LI>
                                <LI><font color="teal">Click on each particle that you would like to keep.</font></LI>
                            </UL>
d720 1
a720 1
                            classes.  <BR>
d722 1
a722 1
                            reference-view, you must use it for all classes.  <BR>
d724 2
a725 2
                            However, you can mix-and-match methods within different reference-views.  <BR>
                            The next batch file will write to the screen which method was used for each view.</font></LI>
d727 2
a728 2
            </UL>
        </UL>
d730 31
a760 31
    <LI><font color="teal">Combine particles from good classes. </font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/combinegoodclasses.spi">combinegoodclasses.spi</A> </font></LI>
        <LI><font color="teal">SUBROUTINE: <A HREF="Reconstruction/reversedoc_7col.spi">reversedoc_7col.spi</A> </font></LI>
        <LI><font color="teal">INPUT: <B>select/prj***/{docclass###</B>, <B>goodclasses</B>,<B>select/sel***</B>, 
            <B>firstgoodparticle</B> (optional), <B>byhand</B> (optional)}</font></LI>
        <LI><font color="teal">OUTPUT: <B>select/prj***/goodsel</B> (one for each reference-view),
         <B>select/combinestats</B> </font></LI>
    </UL>

    <LI><font color="teal">(Optional) Re-screen the particles by view. </font></LI>
        <OL>
            <LI><font color="teal">Screen particles using .montagefromdoc </font></LI>
            <UL>
                <LI><font color="teal">In <B>select/</B>, I included a <B>.montagefromdoc</B> file with hopefully reasonable settings.
                If not, type: <PRE>montagefromdoc.py prj001/goodsel.dat prj001/stkfilt.dat</PRE>
                For the output filename, use <B>prj001/notgood</B>.</font></LI>
                <LI><font color="teal">To salvage bad particles, do the converse, i.e., 
                    use <B>prj001/badsel.dat</B> and <B>prj001/notbad.dat</B> as the input and output.</font></LI>
                <!-- <LI><font color="teal"> </font></LI> -->
            </UL>

        <LI><font color="teal"><A HREF="Reconstruction/recheck.spi">recheck.spi</A> </font></LI>
            <UL>
                <LI><font color="teal">SUBROUTINE: <A HREF="Reconstruction/reversedoc_7col.spi">reversedoc_7col.spi</A> </font></LI>
                <LI><font color="teal">INPUT: <B>select/prj***/sortsel</B>, <B>select/prj***/goodsel</B>,
                     <B>select/prj***/badsel</B> <B>select/prj***/notbad</B>, <B>select/prj***/notgood</B></font></LI>
                <LI><font color="teal">OUTPUT: <B>select/prj***/goodselB</B>, <B>select/prj***/badselB</B> </font></LI>
                <LI><font color="teal">For the output doc files, I used a letter to distinguish from prior output. 
                    A number might cause problems for montagefromdoc.py.</font></LI>
            </UL>
d763 21
a783 21
    <LI><font color="teal">(Optional) Average images by view</font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/viewaverage.spi">viewaverage.spi</A> </font></LI>
        <LI><font color="teal">INPUT: <B>select/prj***/goodsel</B> <BR>
             If you ran recheck.spi, add the tiebreaker (e.g., <I>B</I>) to the filename. </font></LI>
        <LI><font color="teal">OUTPUT: <B>select/prj***/goodavg</B>,<B>select/prj***/goodvar</B> (optional)</font></LI>
        <LI><font color="teal">One advantage of this batch file over average.spi is that it combines all defocus groups.</font></LI>
        <LI><font color="teal">You can use verifybyview.py to link the averages to the retained particles.  
             To do so, run verifybyview.py from <B>Reconstruction/select/</B> 
             (so as to not overwrite the settings in <B>Reconstruction/</B>). 
             The default settings in <B>.verifybyview</B> will hopefully be reasonable.  
             In principle, you could re-screen your particles if there are still bad ones.</font></LI>
    </UL>

    <LI><font color="teal">Compute CCC histogram of particles</font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/histgoodccc.spi">histgoodccc.spi</A> </font></LI>
        <LI><font color="teal">INPUT: <B>select/prj***/goodsel</B>, <B>select/prj***/badsel</B> <BR>
             If you ran recheck.spi, add the tiebreaker (e.g., <I>B</I>) to the filename. </font></LI>
        <LI><font color="teal">OUTPUT: <B>combinedgood</B>, <B>histcccgood</B>, <B>histcccbad</B></font></LI>
        <LI><font color="teal">Check histogram using <A HREF="Reconstruction/fit.gnu">fit.gnu</A>, 
d785 2
a786 2
            <PRE>gnuplot </PRE> and then at the prompt, type (including the single quotes):
            <PRE>load 'fit.gnu'</PRE>
d790 48
a837 2
            go through the particles.</font></LI>
    </UL>
d839 2
a840 48
    <LI><font color="teal">Separate total good-particle list by defocus-group. </font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/goodparticlesbydf.spi">goodparticlesbydf.spi</A> </font></LI>
        <LI><font color="teal">PARAMETER: fractional cutoff (optional, use 0.0 to keep all)</font> </LI>
        <LI><font color="teal">INPUTS: <B>combinedgood</B>, <B>stack2particle***</B></font></LI>
        <LI><font color="teal">OUTPUT: <B>df***/goodparticles</B>, <B>sel_group_cclim</B>, <B>sel_group_cclim_sorted</B> </font> </LI>
        <LI><font color="teal">For large particle sets, this batch file may crash, in which case try 
            <A HREF="Reconstruction/big-goodparticlesbydf.spi">big-goodparticlesbydf.spi</A> </font></LI>
    </UL>
    
    <LI><font color="teal">Generate alignment documents with only good particles</font> </LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/dfgoodapsh.spi">dfgoodapsh.spi</A> </font></LI>
        <LI><font color="teal">INPUT: <B>../Alignment/align_01_***</B>, <B>df***/goodparticles</B></font></LI>
        <LI><font color="teal">OUTPUT: <B>../Alignment/good-align_01_***</B>, <B>sel_particles***</B></font> </LI>
        <LI><font color="teal">The <B>sel_particles***</B> files are essentially equivalent to 
            <B>df***/goodparticles</B>, lacking only the <I>CCROT</I> column. </font> </LI>
    </UL>
</UL>

<P><A HREF="#top">Return to top</A> </P>

<HR>

<P><B><FONT SIZE="4"><a name="average">Compute averages</a></FONT></B> -- 
   also in <b>Reconstruction/</b> directory</P>

<UL>
    <LI>select.spi (optional, necessary for display.spi or plotrefviews.spi)
        -- for each defocus-group, separates particles by reference-view</LI>
    <UL>
        <LI><font color="teal">INPUT: Use <B>good-align_01_***</B> instead of <B>align_01_***</B></font></LI>
        <LI>OUTPUT: <B>df***/select/sel###</B>, <B>df***/how_many</B>, <B>how_many</B> </LI>
    </UL>

    <LI><font color="teal">Skip average.spi -- The equivalent was performed above by viewaverage.spi</font></LI>
    <LI><font color="teal">Skip cchistogram.spi -- The equivalent was performed above by histgoodccc.spi</font></LI>
    <LI><font color="teal">Skip ccthresh.spi  -- The equivalent was performed above by histgoodccc.spi</font></LI>
    <LI><font color="teal">Skip dftotals.spi -- The equivalent was performed above by goodparticlesbydf.spi</font></LI>

    <LI>plotrefviews.spi, display.spi (optional) -- graphically show distribution of views</LI>
    <UL>
        <LI>INPUT: <B>df***/how_many</B> </LI>
        <LI>OUTPUT: <B>gnuplot_view</B>, <B>display/cndis***</B> </LI>
    </UL>

    <LI>bestim.spi (optional) -- truncate <B>seltotal</B> files for overrepresented views </LI>
</UL>
d842 1
a842 1
<P><A HREF="#top">Return to top</A> </P>
d844 1
a844 1
<HR>
d846 2
a847 2
<P><B><FONT SIZE="4"><a name="reconstruct">3D reconstruction</a></FONT></B> -- 
   still in <b>Reconstruction/</b> directory</P>
d849 1
a849 1
<UL>
d863 7
a869 7
      <UL>
        <LI><font color="teal">Copy the SPIDER executable to the local directory and rename it <I>spider</I>, <i><i>e.g.</i></i>:<BR>
        <code>cp /spider/bin/spider_linux_mp_opt64.18.16 ./spider</code> <br /></font></LI>
        <LI><font color="teal">Start alignment with the following command: <BR>
        <code>./spider spi/dat @@bps-pubsub 1 &amp; </code><BR>
        where <I>1</I> will be the number of the top-level SPIDER results file.</font></LI>
      </UL>
d873 1
a873 1
    <P><font color="teal">Like alignment, 3D reconstruction is CPU-intensive and benefits by parallelization. 
d877 4
a880 4
    <LI><font color="teal">PARAMETERS: </font></LI>
        <UL>
            <LI><font color="teal"><I>[bp-method]</I> -- backprojection method: BP CG, BP 32F, or BP RP</font> </LI>
            <li><font color="teal"><I>[stk-opt]</I> -- Stack options (<i>e.g.</i>, 0 to read from original location, 
d882 1
a882 1
            <li><font color="teal"><I>[max-wait]</I> -- Will wait up to 10 minutes by default before reading a new group's stack, 
d884 4
a887 4
        </UL>
    <LI><font color="teal">INPUT: <B>dala01_***</B>, <B>../Alignment/align_01_***</B>, 
        <B>sel_particles_***</B> </font> </LI>
    <LI><font color="teal">OUTPUT: <B>df***/{vol01_odd, vol01_even}, df***/docfscmasked, summary-bps</B></font> </LI>
d890 1
a890 1
<P><font color="teal">The following is a brief tree of procedure calls:</font>
d894 1
a894 1
<a href="Reconstruction/bps-inseries.spi"><B>bps-inseries</B></a>
d906 1
a906 1
<a href="Reconstruction/bps-pubsub.spi"><B>bps-pubsub</B></a>
d918 1
a918 1
</P>
d920 19
a938 19
    <LI>slices.spi (optional)</LI>
    <UL>
        <LI>INPUT: <B>df***/vol01_odd</B></LI>
        <LI>OUTPUT: <B>slices/slice***</B></LI>
    </UL>

    <LI>plotres.spi </LI>
    <UL>
        <LI>INPUT: <font color="teal"><B>df***/docfscmasked</B> (change from <B>df***/fscdoc</B>)</font>, 
            <font color="teal"><B>docfscmasked</B> (change from <B>combires</B>)</font>, <B>resolution</B></LI>
        <LI>OUTPUT: <B>gnuplot_res</B></LI>
    </UL>

    <LI><font color="teal">Generate a matched-filter profile</font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/make_matched.spi">make_matched.spi</A></font></LI>
        <LI><font color="teal">INPUT: <B>vol01_odd</B>, <B>vol01_even</B> </font></LI>
        <LI><font color="teal">OUTPUT: <B>docmatched_vol01</B> </font></LI>
        <LI><font color="teal">Information at spatial frequencies above the cutoff value is 
d941 2
a942 2
            This concept is described in Huang and Penczek (2004) <I>JSB</I> <B>145</B>: 29-40.</font></LI>
    </UL>
d944 6
a949 6
    <LI><font color="teal">Apply the filter profile</font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/matchedfilter.spi">matchedfilter.spi</A></font></LI>
        <LI><font color="teal">INPUT: <B>docmatched_vol01</B>, <B>vol01</B> </font></LI>
        <LI><font color="teal">OUTPUT: <B>vol01_matched</B> </font></LI>
        <LI><font color="teal">Applying the same filter profile to different reconstructions 
d952 2
a953 2
            </font></LI>
    </UL>
d955 8
a962 8
    <LI><font color="teal">Prepare files for refinement</font></LI>
    <UL>
        <LI><font color="teal"><A HREF="Reconstruction/consecprepare.spi">consecprepare.spi</A></font></LI>
        <LI><font color="teal">INPUT: <B>sel_group_cclim</B>, <B>sel_particles_***</B>, 
             <B>data***</B>, <B>dala01_***</B> </font></LI>
        <LI><font color="teal">OUTPUT: <B>good-sel_group_cclim</B>, <B>good-sel_particles_***</B>, 
             <B>good-data***</B>, <B>good-dala01_***</B> (optional, see NOTE below) </font></LI>
        <LI><font color="teal">NOTE: In the developmental version of the 
d964 2
a965 2
            main, projection-matching batch files</a>, the aligned-image stacks 
            (<B>dala01_***</B>) are no longer needed.  
d968 6
a973 6
            setting the parameter <I>[dala-yn]</I> to 0.
            </font></LI>
        <LI><font color="teal">Originally, this batch file copied the outputs into <B>Refinement/input</B>.
             Now however, the subroutine <A href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/prepare.pam">
             prepare.pam</A> in <A href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/refine.html">
             Refinement</A> does this for you. 
d976 1
a976 1
             So, with this batch file, only the desired particles will be retained. <BR>
d978 3
a980 3
             <A href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/refine_settings.pam">refine_settings.pam</A>
</font></LI>
    </UL>
d982 1
a982 1
    <LI><font color="teal">Skip filt.spi -- The equivalent was performed above by make_matched.spi and matchedfilter.spi</font> </LI>
d984 1
a984 1
</UL>
d986 1
a986 1
<P><A HREF="#top">Return to top</A> </P>
d988 1
a988 1
<HR>
d990 2
a991 2
<P>
<B><FONT SIZE="4"><a name="refine">Refinement</a></FONT></B> -- in <b>Refinement/</b>
d993 23
a1015 1
</P>
d1017 1
a1017 23
<UL>
    <LI><A HREF="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/refine.html">
        Refinement documentation</A> </LI>
    <LI><font color="teal">Use the following as inputs in 
         <A href="http://www.wadsworth.org/spider_doc/spider/docs/techs/recon/newprogs/refine_settings.pam">refine_settings.pam</A>,
         as written above by <A HREF="Reconstruction/consecprepare.spi">consecprepare.spi</A> <BR>
         <I> (Note the only change from the default is the prefix <B>good-</B> for these files) </I>: </font></LI>
         <UL>
              <LI><font color="teal"><B> good-sel_group_cclim </B></font></LI>
              <LI><font color="teal"><B> good-sel_particles_*** </B></font></LI>
              <LI><font color="teal"><B> good-data*** </B></font></LI>
              <LI><font color="teal"><B> good-dala01*** </B> </font></LI>
              <LI><font color="teal"><B> good-align_01_*** </B></font></LI>
<!--              <LI><font color="teal"><B>  </B></font></LI>-->
         </UL>
    <LI><font color="teal">I recommend using the filtered volume, <B>vol01_matched</B>, 
        instead of <B>vol01</B>, in order to minimize model bias. </font>
    </LI>
</UL>

<P><A HREF="#top">Return to top</A> </P>

<HR>
d1019 1
a1019 1
<P><B><FONT SIZE="4"><a name="other">Additional batch files</a></FONT></B></P>
d1021 1
a1021 1
I have some <a href="VerifyMisc/misc.htm">miscellaneous batch files here</a>.
d1023 1
a1023 1
<HR>
d1025 2
a1026 2
</BODY>
</HTML>
@
