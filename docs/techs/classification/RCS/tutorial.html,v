head	1.10;
access;
symbols;
locks; strict;
comment	@# @;


1.10
date	2019.01.31.16.31.03;	author leith;	state Exp;
branches;
next	1.9;

1.9
date	2013.03.26.17.53.22;	author leith;	state Exp;
branches;
next	1.8;

1.8
date	2013.02.07.13.23.51;	author leith;	state Exp;
branches;
next	1.7;

1.7
date	2013.02.04.14.19.03;	author leith;	state Exp;
branches;
next	1.6;

1.6
date	2012.02.02.20.21.12;	author tapu;	state Exp;
branches;
next	1.5;

1.5
date	2012.02.01.18.28.15;	author tapu;	state Exp;
branches;
next	1.4;

1.4
date	2012.02.01.12.42.25;	author leith;	state Exp;
branches;
next	1.3;

1.3
date	2009.06.19.18.25.18;	author leith;	state Exp;
branches;
next	1.2;

1.2
date	2008.12.15.19.23.55;	author leith;	state Exp;
branches;
next	1.1;

1.1
date	2008.12.15.19.21.00;	author leith;	state Exp;
branches;
next	;


desc
@old
@


1.10
log
@*** empty log message ***
@
text
@<html>
<head>
  <title> Clustering and Classification Tutorial</title>
  <link rel='stylesheet' href='tutstyle.css' type='text/css' />
</head>


<body>
<br />
<p> <h1 align="center">Clustering and Classification Tutorial</h1> </p>

<hr />
 
<p>  <h3 align="center">Contents </h3> </p>

<p>
<ol>
   <li><a href="#source"> Source Data Set                                       </a>.</li>
   <li><a href="#CAPCA">  Correspondence or Principal Component Analysis        </a>.</li>
   <li><a href="#histo">  Determine what Factors are Attribute or Noise based   </a>.</li>
   <li><a href="#fm">     Create Factor Maps                                    </a>.</li>
   <li><a href="#clhc">   Controlled Clustering and Hierarchical Classification </a>.</li>
   <li><a href="#other">  Other Classification Methods                          </a>.</li>
   <li><a href="#analyze">View and Analyse Dendrograms                          </a>.</li>
   <li><a href="#recon">  Re-create certain images from eigenvectors            </a>.</li>
   <li><a href="#virtual">Create "virtual" images from eigenvectors             </a>.</li>
   <li><a href="#web">    View factor map and create class averages using Web   </a>.</li>
   <li><a href="#ref">    References                                            </a>.</li>
</ol>
</p>

<!-  xxxxxxxxxxxxxxx Clustering/Classification - Summary of Steps  xxxxxxxxxxxx  ->
<hr />

<p> <h4> Clustering/Classification - Summary of Steps </h4> </p>

<p> A note about "cluster" vs "class" terminology.  It seems natural to call the group of 
    points seen on a factor map a "cluster".  Likewise, it seems natural to call the group of
    images denoted by those points a "class".  However the boundary between "cluster" and
    "class" is fuzzy so both terms have been, and continue to be, used almost interchangably 
    in the field. </p>
 
<ol>
<li>Carry out CORAN or PCA 
   <ul><li>
      Create Orthogonal Vectors
      <dl>
        <dt>Run: <a href="../../man/cas.html">'CA S' </a> </dt>
        <dd>Reads images.                                 </dd>
        <dd>Carries out either PCA or CORAN analysis.     </dd>
        <dd>Creates data files that are input for following steps.</dd>
      </dl>
   </li></ul>
</li>	
<p />

<li>Determine Which Factors Are Important
   <ul>
       <li>Map Factors  

       <dl>
         <dt>Run: <a href="../../man/casm.html">'CA SM' </a>             </dt>
         <dd>Uses output from: <a href="../../man/cas.html">'CA S'</a>   </dd>
         <dd>Creates factor (vector) map of data: images, pixels, or eigenvectors </dd>
       </dl>
       </li>
       <p />

       <li>Clustering/Classification  <br />
           Uses output from: <a href="../../man/cas.html">'CA S' </a>. 

         <dl>
           <dt>Run: <a href="../../man/clhc.html">'CL HC' </a>  
           <dd>Finds clusters/classifies data using  single linkage, complete linkage,
               average linkage, the centroid method, or Ward's method and HAC. </dd>
           <dd>Creates dendrogram doc file, and dendrogram plot.               </dd>

           <dt>Run an <a href="./ca-otherops.html">alternative classification method</a>: 
                   <a href="../../man/clcla.html">'CL CLA'</a> &nbsp; or &nbsp;
                   <a href="../../man/clkm.html"> 'CL KM' </a>     </dt>
           <dd>Find clusters/classes.                              </dd> 
           <dd>Creates a dendrogram or class membership doc. file. </dd>
         </dl>
       </li>

       <p />

       <li>View and Analyse Dendrograms.                         <br />
         Uses dendrogram doc files from 
              <a href="../../man/clhc.html"> 'CL HC' </a> or 
              <a href="../../man/clcla.html">'CL CLA' </a>. 

         <dl>
           <dt>Run: <a href="../../man/clhd.html">'CL HD' </a>  </dt>   
           <dd>Counts number of classes and images 
               in each class, for a given threshold.            </dd>

           <dt>Run: <a href="../../man/clhe.html">'CL HE' </a>  </dt>   
           <dd>Creates doc files describing which images are 
               in each class for a given threshold.             </dd>

           <dt>Use: <a href="../../../../web/docs/web.html">Web </a> to 
              View dendrogram and average images.               </dt>
           <dd>Creates view containing average images for 
               each class at a specifed threshold.              </dd>
         </dl>
       </li>

       <p />
       <p />
    </ul>

   </li>

   <li>Analyse Eigenimages <br />
    Uses output from: <a href="../../man/cas.html">'CA S'</a>   

    <ul>
    <li>
      <dl>
        <dt>Run: <a href="../../man/casr.html">'CA SR' </a>  </dt>   
        <dd>Reconstitute images from eigenvalues & create "virtual" 
            image from arbitrary eigenvector values           </dd>
      </dl>
    </li>
    <p />

    <li>
      <dl>
        <dt>Run: <a href="../../man/casd.html">'CA SD' </a>  </dt>   
        <dd>Create difference eigenimages.                   </dd>
      </dl>
    </li>
    <p />

    <li>
      <dl>
        <dt>Run: <a href="../../man/casri.html">'CA SRI' </a> </dt>   
        <dd>Reconstitute importance images.                   </dd>
      </dl>
    </ul>
    <p />

   </li>
   </li>

   <li><a href="../../../../web/docs/web.html">View Factor maps</a> 
   <ul>
     <li>View the factor map and create arbitrary average images </li>
     <p />
   </ul>
</ol>   


<hr />

<!-  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Source Data Set xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx ->

<a name="source"></a> 
 
<h4 align="left">Source Data Set</h4>

<p />
   SPIDER procedures: <a href="makefaces.spi">makefaces.spi</a> (and the
                      <a href="face.spi">face.spi</a> 
   procedure which it calls) were used to create the eight
   original faces below. These faces differ in three ways: oval vs. round
   head, left vs. right eyes, and big vs. small mouth. Ten copies of each
   face with random noise form the sample data set. 
   These procedure files create four SPIDER image stack files. 

   <table class="outs" cellpadding="4">
      <tr><th> </th> <th>Name</th>  <th>Contents</th> <th></th> <tr>

      <tr valign="top"><td>&curren;</td>
          <td><i>face_tmpl_stk</i></a> </td>
          <td>&nbsp;  Face templates</td> 

     <tr valign="top"><td>&curren;</td>
          <td><i>face_nois_stk</i></a> </td>
          <td>&nbsp;  Noisy faces </td> 
 
     <tr valign="top"><td>&curren;</td>
          <td><i>face_aver_stk</i></a> </td>
          <td>&nbsp;  Average of the ten noisy face images for each template </td> 

     <tr valign="top"><td>&curren;</td>
          <td><i>face_varn_stk</i></a> </td>
          <td>&nbsp; Variance of the ten noisy face images for each template </td> </tr>
   </table>
<p />
<p />

   <table align="center" cellpadding="4">
     <tr> <td><img width="557" height="143" src="save/16faces.gif"><td><tr>
     <tr> <th>Face Templates    </th>   <tr>
     <tr> <th>Sample Noisy faces</th>   <tr>
   </table>
<p />

<!-  xxxxxxxxxxxxxxxxxxxxxxxxxxxx  Correspondence Analysis...  xxxxxxxxxxxxxxxxxxxxxx - ->
<hr />

<p />
<a name="CAPCA"></a>

<h4> </a>Correspondence Analysis (<i>CA</i>) or 
         Principal Component Analysis (<i>PCA</i>)</h4>
<p />

<i>CA</i> is the preferred method of finding inter-image variations and we will
   principally be discussing inter-image variance. <i>PCA</i> computes the
   distance between data vectors with Euclidean distances, while <i>CA</i> uses
   Chi-squared distance. <i>CA</i> is superior here because it ignores differences
   in exposure between images, eliminating the need to rescale between
   images.                                                            <br />
<p />
   The procedure: <a href="cas.spi">cas.spi</a> creates a 
   mask and invokes 
   <a href="../../man/cas.html">'CA S'</a> assuming you want to run <i>CA</i>. 
<p />

<p>
Hints for: <a href="../../man/cas.html">'CA S'</a> <br/>

<ul>
   <li>The "Number of factors" requested should be larger than the 
       expected number of variations. This is to see the characteristic slope 
       of noise after the "useful" eigenvalues. Typically 10 should be 
       more than enough for our example, but see 
       <a href="../../man/cas.html">'CA S'</a> for more detail. </li>

    <li>"Output file prefix" names all output files. A "cas_ca" entry will 
       result in "cas_ca_IMC", "cas_ca_PIX", etc. </li>
</ul>


<p>  Output files from <a href="../../man/cas.html">'CA S'</a> and <a href="cas.spi">cas.spi</a>:

   <table class="outs" cellpadding="4">
      <tr><th> </th> <th>Name</th> <th>Contents</th> <th>File type</th><tr>

      <tr valign="top"><td>&curren;</td>

          <td><a href="save/cas_ca_IMC.dat"><i>cas_ca_IMC</i></a> </td>
          <td> Coordinates of each IMAGE in the new vector space. </td> 
          <td> <a href="cas_format.html">Text</a>                 </td> </tr>

      <tr valign="top"><td>&curren;</td>
          <td><a href="save/cas_ca_PIX.dat"><i>cas_ca_PIX</i></a> </td>
          <td>Coordinates of each PIXEL in the new vector space.  </td> 
          <td> <a href="cas_format.html">Text</a>                 </td> </tr>

      <tr valign="top"><td>&curren;</td>
          <td><a href="save/cas_ca_EIG.dat">cas_ca_EIG</a> </td>
          <td>Eigenvector values.                          </td> 
          <td> <a href="cas_format.html">Text</a>          </td> </tr>

      <tr valign="top"><td>&curren;</td>
          <td>cas_ca_SEQ </td>
          <td>Image pixel values within the mask from all the images.     <br />
          Only useful internally within other 'CA' &amp; 'CL' operations. </td> 
          <td> <a href="cas_format.html">Binary</a>                       </td> </tr>

      <tr valign="top"><td>&curren;</td>
          <td>cas_ca_SET </td>
          <td>Transposed data.                                               <br />        
              Only useful internally within other 'CA' &amp; 'CL' operations.</td>  
          <td> <a href="cas_format.html">Binary</a>                          </td> </tr>

  
      <tr valign="top"> <td></td>  <td></td> 
          <td> In addition to the  
          <a href="../../man/cas.html">'CA S' </a>output files, 
          <a href="cas.spi">           cas.spi</a> creates:                  </td> </tr> 

 
      <tr valign="top"><td>&curren;</td>
          <td><div class="output">face_mask.spi</div>   </td>
          <td>User-defined circular mask.               </td> 
          <td>SPIDER <br />image</td>                   </tr>

      <tr valign="top"><td>&curren;</td>
          <td><div class="output"> <a href="save/cas_ca_cor_doc.dat">cas_ca_cor_doc.dat</a></div></td>
          <td>List of eigenvectors for each 
              image for factors 1 and 2.  </td>
          <td>SPIDER <br />document</td>   </tr>
</table>
 
<!-  xxxxxxxxxxxxxxxxxxxxx   Which Eigenvalues Are Useful   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  ->
<hr />

<a name="histo"></a>  

<img src="save/cas_ca_eigpct.jpg" align="right">

<p>

<h4> Determining Which Eigenvalues Are Useful, And Which Are From Noise</h4>

</p>The best method to determine what eigenvalues are useful, 
   and which are from noise is 
   to view a histogram showing the percentage of eigenvalue variance accounted for by 
   each factor.  As the histogram to the right shows, the last 
   five eigenvalues are small compared to the first three. Also their height is level, 
   typical of noise.  This is interpreted as the first three eigenvectors 
   control more inter-image variance than the last five.</p>

<p />
   The procedure: <a href="caeigpct.spi">caeigpct.spi</a> invokes 
   <a href="../../man/canoise.html">'CA NOISE'</a> 
   to create and plot an eigenvalue histogram.  Output files:

   <table class="outs" cellpadding="4">

      <tr valign="top"><td>&curren;</td>
          <td><div class="output"> <a href="save/cas_ca_eigpct_doc.dat">cas_ca_eigpct_doc</a></div>:</td>
          <td>A SPIDER document file listing eigenvalues and  
          the percentage of variance accounted for by each factor.</td> </tr>

      <tr valign="top"><td>&curren;</td>
          <td><div class="output"> <a href="save/cas_ca_eigpct.gnu">cas_ca_eigpct.gnu</a></div>:</td>
          <td>A Gnuplot file to plot the histogram.</td> </tr>

      <tr valign="top"><td>&curren;</td>
          <td><div class="output"> <a href="save/cas_ca_eigpct.ps">cas_ca_eigpct.ps</a></div>:</td>
          <td>A Postscript file containing the histogram.</td> </tr>
   </table>
<p />

   The <a href="save/cas_ca_eigpct.gnu">Gnuplot Histogram</a> can be visualized using:
            <b>gnuplot -persist save/cas_ca_eigpct.gnu </b> 
<p />
   The <a href="save/cas_ca_eigpct.gnu">Postscript Histogram</a> can be visualized using:
            <b>evince save/cas_ca_eigpct.ps             </b> 
       
 <p />

<!-  xxxxxxxxxxxxxxxxxxxx Creating Factor Maps to View Clusters xxxxxxxxxxxxxxxxxxxxxxxxxxx  ->
<hr />

<a name="fm"></a>

<h4><p>Creating Factor Maps to View Clusters</h4></p>

<p>Once we know which eigenvectors have some meaning 
   and which are from noise, we can use the output from <a href="#CAPCA">CA S</a>
   for clustering.
   The <a href="../../man/casm.html">'CA SM'</a> operation creates 
   2D factor maps (graphs) of selected pairs of factors  
   to visualize clustering (if any).</p> 


<p>The procedure: <a href="factor.spi">casm.spi</a> invokes 
   the SPIDER procedure: <a href="factor_casm.spi">factor_casm.spi</a> 
   three times, creating three
   different factor maps using <a href="../../man/casm.html">'CA SM'</a>
   for different pairs of factors. 'CA SM' is  run under 
   the assumptions that you want image space with "ID's" to create 
   PostScript plots.</p>

</p>

Hints for: <a href="../../man/casm.html">'CA SM'</a>

<ul>
  <li>Input for: "IMAGE OR PIXEL COORDINATES" should almost always be "I", 
      unless you are interested in "the images changing around the 
      pixels". This determines if 'CA SM' will read the 
      <i>*_PIX or *_IMC file</i>. </li>

  <li>"File prefix" is the name entered for the "Output file prefix" 
      in 'CA S'. </li>

  <li>"NUMBER OF HORIZONTAL PATCHES"  Usually zero, UNLESS 
      this particular CORAN analysis was done on a set of correlation 
      patch averages. </li>

  <li>"(S)YMBOL, (A)SSIGN SYMBOL, (C)LASS, (D)OC, (I)D", 
      "ID" is typically the best choice. </li>

  <li>"PREPARE POSTCRIPT FILE FOR MAP" should usually be yes, unless you 
      prefer an ASCII map like 
      <a href="save/ascii12.dat">ascii12.dat</a>. </li>

  <li>"FLIP #1" exchanges the map left-right. 
      "FLIP #2" exchanges the map up-down." </li>

  <li>Everything after "Postscript output file" can generally 
       be left as default values.  </li>

  <li>If you get an: "ERROR: *** MAP ABORTED, MORE THAN 264 POINTS ON FRAME" 
       message, this is due to a large number of points. 
       Overcome this by increasing the scale of the factor map by
       increasing the value given for ".NUMBER OF SD (OR &le;CR&gt;= 2.3)". </li> 

  <li> The SPIDER <a href="save/clcla_results.dat">results</a> file  
        holds a large amount of other useful information after a 
        <a href="../../man/casm.html">'CA SM'</a> run.</li>
</ul>


<p>The three factor maps below were created from image (<i>IMC</i>) factor
   maps  using GNUplot. Postscript files are similar.</p>

   <table cellpadding="4">

      <tr>
      <td> <a href="save/plot12.gif"> <img src="save/plot12.jpg" </a></td>
      <td> <a href="save/plot13.gif"> <img src="save/plot13.jpg" </a></td>
      <td> <a href="save/plot23.gif"> <img src="save/plot23.jpg" </a></td>
      </tr>

      <tr>
      <th> <a href="save/plot12.gif">Factor 1 vs. Factor 2</a></th>
      <td> <a href="save/plot13.gif">Factor 1 vs. Factor 3 </a></th>
      <td> <a href="save/plot23.gif">Factor 2 vs. Factor 3 </a></th>
      </tr>
    </table>

<p>'CA SM' also works for pixel factor maps (<i>_PIX</i>)as well. 
    The pixel factor maps below were created from a screen  
   snapshot. The large number of pixels located in the 
   center show that most pixels vary little if at all between 
   eigenvectors. </p>

   <table cellpadding="4">
      <tr>
      <td> <a href="save/1vs2pix.gif"> <img src="save/1vs2pix.jpg" </a></td>
      <td> <a href="save/1vs3pix.gif"> <img src="save/1vs3pix.jpg" </a></td>
      <td> <a href="save/2vs3pix.gif"> <img src="save/2vs3pix.jpg" </a></td>
      </tr>

      <tr>
      <th align="center"> <a href="save/plot12.gif">Factor 1 vs. Factor 2 </a></th>
      <th align="center"> <a href="save/plot13.gif">Factor 1 vs. Factor 3 </a></th>
      <th align="center"> <a href="save/plot23.gif">Factor 2 vs. Factor 3 </a></th>
      </tr>
    </table>

</p>

<!-  xxxxxxxxxx Controlled Clustering and Hierarchical Classification - Using 'CL HC' xxxxxxxxxxxx ->
<hr />

<a name="clhc">

<h4>Controlled Clustering and Hierarchical Classification - Using 
    <a href="../../man/clhc.html">'CL HC'</a></h4>

<p>With the "useful" eigenvectors known, we can more efficiently 
   determine the representative clusters. 
   Classification also allows compression of information with minimal loss.  
   The <a href="../../man/clhc.html">'CL HC'</a> operation usually gives 
   robust clustering because the user can control the clustering criterion 
   and can alter the "weights" for each factor.</p>

<p>The procedure: <a href="clhc.spi">clhc.spi</a> invokes  
   <a href="../../man/clhc.html">'CL HC'</a>
   which reads the <i>CA/PCA</i> files from 
   <a href="../../man/cas.html">'CA S'</a> and creates
   a dendrogram document file and dendrogram plot file.
</p>

Hints for: <a href="../../man/clhc.html">'CL HC'</a> 
<ul>
   <li>"CORAN/PCA FILE" is the name of the file from 
       <a href="../../man/cas.html">'CA S'</a>. 
       The 'CL HC' operation can accept <i>_IMC, _SEQ, or _PIX</i>  files. 
       So this entry must include one of these endings to distinguish the kind of file.</li> 

   <li>"FACTOR WEIGHTS" influence the clustering and the dendrograms. 
       The larger the weight, the more importance a factor has as compared 
       to the other factors. 
       To best represent the "truth" set all factor weights equal to each other.
       to the other factors. Zero sets all the remaining factors to 1.0.</li>

   <li>"CLUSTERING CRITERION".  Option 5 is the same method 'CL CLA' uses.</li>

   <li>A The output "DENDROGRAM DOC FILE" can be used with 
         <a href="../../../../web/docs/web.html">Web</a> 
         to produce dendrograms with cluster averages. It is also used with the
         <a href="../../man/clhd.html">'CL HD'</a> and 
         <a href="../../man/clhe.html">'CL HE'</a> 
         operations to create document files listing
         the images assigned to each cluster.</li>
</ul>

<p>Screen snaphots of the dendrograms from 
     <a href="../../man/clhc.html">'CL HC'</a>
    for our face data set using clustering option 2 (complete linkage) 
    and option 5 (Ward's method) &nbsp; (Click to see full-size):</p>

<p><table align="center"cellpadding="4">
      <tr>
      <td> <a href="save/clhc_den_2.jpg"> <img src="save/clhc_den_2_sm.jpg" </a></td>
      <td> <a href="save/clhc_den_5.jpg"> <img src="save/clhc_den_5_sm.jpg" </a></td>
      </tr>

      <tr>
      <th> <a href="save/clhc_den_2.jpg">Complete linkage</a></th>
      <th> <a href="save/clhc_den_5.jpg">Ward's method   </a></th>
      </tr>
    </table>
</p>


<p>Dendrogram <i>doc</i> files affiliated with the above dendrograms: 

   <table align= "center" cellpadding="4">
      <tr>
      <td> <a href="save/clhc_den_2_doc.jpg"> <img src="save/clhc_den_2_doc.jpg" </a></td>
      <td> <a href="save/clhc_den_5_doc.jpg"> <img src="save/clhc_den_5_doc.jpg" </a></td>
      </tr>

      <tr>
      <th> Complete linkage doc</th>
      <th> Ward's method doc   </th>
      </tr>
    </table>

<p />



<!-  xxxxxxxxxxxxxx Other Classification Alternatives xxxxxxxxxxxxxxx - ->

<hr />

<a name="other">

<h4>Other Classification Alternatives -  Using 
    <a href="../../man/clcla.html">'CL CLA'</a> or
    <a href="../../man/clkm.html"> 'CL KM' </a> </h4>

<p>Alternative automatic classification methods using 
    <a href="../../man/clcla.html">'CL CLA'</a>, 
    which is less controllable, and  
    <a href="../../man/clkm.html"> 'CL KM' </a>, 
    which may give spurious classes, are discussed in detail 
   <a href="./ca-otherops.html">elsewere</a>. These operations may be 
   usefull for  other classification applications, including classification
   using the <i>_PIX</i> files.



<!-  xxxxxxxxxxxxxx View and Analyse Classification Maps and Dendrograms  xxxxxxxxxxxxxxxx ->

<hr />

<a name="analyze">

<h4>View and Analyse Dendrograms </h4>

<p>In a dendrogram a the junction of a vertical and horizontal line 
   the joining of two classes below it. A representative  
   reconstruction can be formed for each class with the  
   <a href="../../man/casr.html">'CA SR'</a> operation. 
   The larger vertical bars signify a greater difference between 
   classes. The many small differences at the bottom can be eliminated 
   with an increase of the "% cutoff" setting. 
   (<small>The <i>jpg</i> file was obtained using screen snapshot.</small>) 
</p>


<p>The operation <a href="../../man/clhd.html">'CL HD'</a> 
   uses the dendrogram document file from 
   <a href="../../man/clhc.html"> 'CL HC'</a> or
   <a href="../../man/clcla.html">'CL CLA'</a> to create 
   a <a href="save/clhc_den_clas.dat">
   document file</a> listing how many classes there 
   for a given threshold and how many images there are in each class. 
   This operation is similar 
   to viewing the dendrogram in 
   <a href="../../../../web/docs/web.html">Web</a>, 
   setting a threshold, and recording 
   the number of images and the number above each image.</p>


<p>The operation <a href="../../man/clhe.html">'CL HE'</a> 
   uses the dendrogram doc file from 
   <a href="../../man/clhc.html">'CL HC'</a> or
   <a href="../../man/clcla.html">'CL CLA'</a> to create 
   a series of class selection doc. files 
  (e.g. <a href="save/clhc_den_clas_001.dat">clhc_den_clas_001</a>) ,
  which lists the images which are assigned to each ot the classes.</p>

<p>The procedure: <a href="clhe.spi">clhe.spi</a> invokes  
   <a href="../../man/clhd.html">'CL HD'</a>,
   <a href="../../man/clhe.html">'CL HE'</a>, and then  
   <a href="../../man/asr.html">'AS R'</a> to threshold the dendrogram 
   produced by  'CL HC' at a theshold of 66%, then average together the
   20 images in each of the resulting classes.
   The class averages are then placed in a SPIDER image montage:
   <a class="output">clhc_clas_montage.spi</a>

   <table align= "center"  cellpadding="4">
      <tr>  <td> <img src="save/clhc_clas_montage.jpg" </a>  </td> </tr>

      <tr>  <th> Class Montage (Threshold=60%)</th> </tr>
    </table>

 The face images are classified  perfectly according to head shape and eye direction.</p>



<p><a href="../../../../web/docs/web.html">Web</a>
   can be used to view a dendrogram from  
   <a href="../../man/clhc.html">'CL HC'</a> or 
   <a href="../../man/clcla.html">'CL CLA'</a>.

   <a href="../../../../web/docs/web.html">Web</a> will display 
   not only a usual dendrogram, but it also can annotate the dendrogram
   with the average images of all the images below a given threshold, 
   and note the number of images in each average.                 <br />

   The document file: <a href="save/den_doc.dat">den_doc.dat</a> 
   is an example of a dendrogram document file. 
</p>

How To Use The <a href="../../../../web/docs/web.html">Web</a> Dendrogram 
<ol>
   <li>Run <a href="../../man/clhc.html">'CL HC'</a> or 
           <a href="../../man/clcla.html">'CL CLA'</a> and create a 
   <a href="save/web_den_doc.dat">dendrogram doc file</a> .</li>

   <li>it's easier if  your image files and <i>dendrogram doc file</i> have 
       the same extension and are in the same directory. </li>

   <li>Start <a href="../../../../web/docs/web.html">Web</a> with your extension 
       (i.e."<a href="../../../../web/docs/web.html">Web</a> dat &") and select 
       Command -> image from the menus to navigate to where the images and 
       cluster files are. Press "OK". </li>

   <li> Select Commands -> Dendrogram and then select the cluster file.</li>

   <li>When the Dendrogram window pops up, to see all of what 
       you selected, choose lowest threshold option. All the 
       variation that was carried over from the 'CL HC' or 'CL CLA' operation is 
       scaled from what the lowest level selected  to +1 above.</li> 

   <li>If the "Show average images" option is selected, Web will 
       show the average of the lowest level shown. This is the 
       reason for having the images in the same folder as the dendrogram doc file.</li>
</ol>

</p>

<p>Screen snapshot of <a href="../../../../web/docs/web.html">Web</a>
  display of the complete linkage dendrogram truncated at 20% level. 
  Note that all of the images are properly separated by head shape and eye 
  direction. Mouth size is not so clear because it's eigenvalue is 
  close to the eigenvalue for noise (Click to see full-size):

   <table align= "center"  cellpadding="4">
      <tr>
      <td> <a href="save/web_clhc_den_2.jpg"> <img src="save/web_clhc_den_2_sm.jpg" </a></td>
      </tr>

      <tr>
      <th> <a href="save/web_clhc_den_2.jpg">Dendrogram snapshot</a></th>
      </tr>
    </table>
<p />




<!-  xxxxxxxxxxxxxx Re-Create Images From Eigenvectors xxxxxxxxxxxxxxxxxxxx - ->

<hr />
<a name="recon">

<h4>Re-Create Images From Eigenvectors - Using <a href="../../man/casr.html">'CA SR'</a> </h4>

<p>Re-creation of sample images from eigenvectors can eliminate 
   the noise in the reconstituted image, this also results in large data 
   compression. </p>

<p>The procedure: <a href="casr.spi">casr.spi</a> 
   invokes <a href="../../man/casr.html">'CA SR'</a>
   to re-constitute any image, or images, from the eigenvectors. </p>

Hints for: <a href="../../man/casr.html">'CA SR'</a> 

<ul>
   <li>"FILE PREFIX" is the response given for the "output file prefix" 
       question from 'CA S'.                                  </li> 

   <li>"FILE #'S TO BE USED" = file numbers of images.        </li>

   <li>"FACTORS TO BE USED" stands for which factors to be 
       utilized in the reconstitution.                        </li>

   <li>"OUTPUT FILE TEMPLATE" needs at least one <i>*</i> at the end 
       or it aborts program.                                  </li>
</ul>


<p>Below, is an single image from our sample data set and four 
   separate reconstructions using the first four eigenvectors. 
   (<small>The "halo" of noise and dark corners is a result of the masking 
   function in the procedures: 
   <a href="face.spi">face.spi</a> and 
   <a href="makefaces.spi">makefaces.spi</a>) 
   which were used to create the noisy face sample data. </small>)
   It is difficult to see what traits the original image has because of noise. 
   With the first three single eigenvalue reconstructions we can see that 
   it has an oval head, with eyes looking left, and a small mouth. The 
   fourth eigenvector does not "add" anything to our knowledge of the 
   image because there are only three attributes that carry information. 
   Therefore the fourth carries only noise. </p>

<p align=center><img src="save/casr_69.jpg"> </p>

<p>Below is the sample image again, and a reconstruction from the 
   first three eigenvectors combined. The image is from the 69'th  
   prototype image shown in the source data area.</p>

<p align =center> <img src="save/casr_69_1-3.jpg"> </p>


<p>Below we have the same "protoimage" images used to create the 
   source data, a sample image from each protoimage,and we also have 
   re-created the noisy samples using each eigenvector. The first row 
   is the protoimages used to create the 80 sample images, and the 
   second row consists of a sample image created from the protoimage 
   above it. The third row is each sample image re-created with only 
   the first eigenvector used. The next row includes the second 
   eigenvector, and the last includes all relevant eigenvectors.

<p align=center><img width="557" height="350" src="save/40faces.jpg"> </p>

<!-  xxxxxxxxxxxxxx Create Arbitrary "Virtual" Images.. xxxxxxxxxxxxxxxxxxxx - ->

<hr />
<a name="virtual">
<h4>Create Arbitrary "Virtual" Images From Eigenvectors</h4>

<p>The operation: <a href="../../man/casra.html">'CA SRA'</a>
   can create images or pixels that were not actually 
   captured, using eigenimages. To do this, the eigenvalues must 
   be given. This can be useful to interpolate images 
   in between classes.
</p>

<p>To choose what values to use for eigenvalues, use the 
   <a href="#fm">factor maps</a>.  If you try to use a value 
   outside the range of values for an eigenvalue, the results 
   will be difficult to predict and interpret.
</p>

<p>The procedure: <a href="casra.spi">casra.spi</a> 
   invokes 'CA SR'.</p>


Hints for: <a href="../../man/casra.html">'CA SRA'</a> 
<ul>
   <li>To determine coordinate values, consult a factor map.</li>
   <li>Do not assume that a zero will fill the rest of the 
       factor values to zero.                               </li>
   <li>"FILE PREFIX" is the response given for the "output file prefix" 
       question from 'CA S'.                                  </li> 

   <li>"FILE #'S TO BE USED" = file numbers of images.        </li>

   <li>"FACTORS TO BE USED" stands for which factors to be 
       utilized in the reconstitution.                        </li>

   <li>"OUTPUT FILE TEMPLATE" needs at least one <i>*</i> at the end 
       or it aborts program.                                  </li>
</ul>


<p>The images for eigenvector 1 equal to -0.1 and 0.1 are 
   shown in the first two images. They "make sense" in that this 
   vector controls headshape only. These values were chosen because 
   they are the most extreme values shown on the factor maps.
   But the images for eigenvector 1 equal to -1 and 1,the last 
   two images, do not represent "extreme" roundness like one 
   might think. This is because these values are outside the range 
   that they actually exist, i.e. the factor maps.
</p>

<p align=center>
   <img width="64" height="64" src="save/casra_0-6.jpg">
   <img width="64" height="64" src="save/casra_0-7.jpg">
   <img width="64" height="64" src="save/casra_0-2.jpg">
   <img width="64" height="64" src="save/casra_0-3.jpg">
</p>

<p>The following virtual images were created by changing only one 
   eigenvalue at a time from -0.2 to 0.2 at regular intervals. 
   The top row is eigenvalue one, and the bottom row 
   eigenvalue three. Along each row all other eigenvalues 
   were held to zero. The center column is identical 
   because it is at this point that the varrying 
   eigenvalues are equal to zero. Reconstitution with all 
   eigenvalues set to zero is equivalent to reconstiting 
   the average of the series. If reconstitution of each 
   indiviual eigenvalue had progressed to one, the result 
   would be the first three images directly above. 
   Reconstitution of the three eigenvalues together will result 
   in the fourth image above.
</p>

<p>The procedure: 
   <a href="casramontage.spi">casramontage.spi</a> 
   was used to assemble the montage: <br/>

<p align=center><img src="save/casra_18fade.jpg"></p>

<p />

<!-  xxxxxxxxxxxxxxxxxxxxxxxxxxx Viewing Eigenimages xxxxxxxxxxxxxxxxxxxxxxxx  ->
<hr />

<h4>Viewing Eigenimages</h4>

<p>The operation:  <a href="../../man/casre.html">'CA SRE'</a>
   creates eigenimages from 'CA S' outputs. With eigenimages, the user can easily 
   see what the computer has determined as the factors to 
   classify images by.
</p>

<p>The procedure:<a href="casre.spi">casre.spi</a> 
   invokes 'CA SRE'. It assumes that if you want more 
   than one factor, they are continuous. Also assumes that you 
   are using CORAN output. Both of these assumptions are in 
   the procedure file, not the operation. Edit the procedure 
   file to change them.
</p>

Hints for: <a href="../../man/casre.html">'CA SRE'</a> 
<ul>
  <li>None, see the manual page.</li>
</ul>

<p>Sample results:</p>

<p align=center><img width="64" height="64" src="save/casre_01.jpg">
                <img width="64" height="64" src="save/casre_02.jpg">
                <img width="64" height="64" src="save/casre_03.jpg">
                <img                        src="save/casre_01to03.jpg"></p>
<p />

<!-  xxxxxxxxxxxxxx Show Differences Between Images (Eigenimages) xxxxxxxxxxxxxxxxxxxx  ->

<hr />
<a name="diff">

<h4>Show Differences Between Images (Eigenimages)</h4>

<p> Use the <a href="../../man/casrd.html">'CA SRD'</a> operation  
   to see the different eigenimages that are used to recreate images.</p>

<p>The procedure: <a href="casrd.spi">casrd.spi</a> invokes
   'CA SRD'.  Note that it is similar to 
   <a href="casr.spi">casr.spi</a> except for minor changes. 
</p>


<p>Hints for: <a href="../../man/casrd.html">'CA SRD'</a></p> 

<ul>
   <li>"PREFIX" is the base name before <i>_SEQ, _IMC, _PIX,</i> etc.</li>
   <li>An entry out of bounds has no useful purpose.                 </li>
   <li>See hints for 'CA SR' above.                                  </li>
</ul>



<p>The first image below is the average of all 80 noisy sample face images. 
   The next three are the difference image for each useful 
   eigenvector for one image. The dark slivers in the first 
   eigenvector image show that in order to obtain the correct head 
   shape for this image, we must add black to either side of 
   the face. Similarily, for the eyes we would make the left side 
   of each eye socket brighter, and the right side darker. From 
   the fourth image this image has a wide mouth . <br/>
<p align=center><img width="64" height="64" src="save/face_avg_all.jpg">
                <img width="64" height="64" src="save/casrd_1_69.jpg">
                <img width="64" height="64" src="save/casrd_2_69.jpg">
                <img width="64" height="64" src="save/casrd_3_69.jpg">
</p>


<br/>Below are the separate difference eigenimages for another 
   image, as well as the combination of all three. This image has 
   the opposite of every trait of the image represented above. 
   We can tell because of white slivers on a dark background, 
   right-hand side of the eyes light, etc. The last image below 
   is the composite of the first three eigenimages.</p>
<p align=center><img width="64" height="64" src="save/casrd_4_19.jpg">
                <img width="64" height="64" src="save/casrd_5_19.jpg">
                <img width="64" height="64" src="save/casrd_6_19.jpg">
                <img width="64" height="64" src="save/casrd_8_19.jpg">
</p>

<p>Below is the average of all the images as well as the composite 
   difference eigenimage from above. When we add (superimpose) 
   these together we get the third image, a re-creation of the 
   original sample image. However, the re-creation has no noise. 
    This is because we only used the first three eigenimages. If we 
   included the other five, then we would have re-created the sample 
   image, with noise.</p>

<p align=center><img width="64" height="64" src="save/face_avg_all.jpg">
                <img width="64" height="64" src="save/casrd_8_19.jpg">
                <img width="64" height="64" src="save/casrd_1_2_3.jpg">
</p>


<!-  xxxxxxxxxxxxxx Subgrouping images xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx - ->

<hr />

<h4>Subgrouping Images Using <a href="../../man/casmi.html">'CA SMI'</a></h4>

<p> The operation <a href="../../man/casmi.html">'CA SMI'</a> 
   can be used to separate a series of images into active/inactive clusters. 
   It appears that this can actually perform operations on a series of images 
   using the 'CA S' files from another series. This has not 
   been tested. If the images used in 'CA SMI' will be used 
   with their 'CA S' run, it is a good idea to create a Postscript 
   map before running 'CA SMI' for comparison later. 
</p>

<p>The procedure: <a href="casmi.spi">casmi.spi</a> invokes 'CA SMI'. </p>

<p>Hints for: <a href="../../man/casmi.html">'CA SMI'</a></p> 

<ul>
   <li>Only supports image input and <i>_IMC</i> output?         </li>

   <li>If using images with their "native" 'CA S run', be sure to compare
      the Postcript maps of before and after 'CA SMI'. If they are not 
      very similar, you must re-run 'CA S' with "CN" instead of "C" as
      the fifth input.                                           </li>

   <li>After 'CA SMI', if an odd factor is chosen in 'CA SM', it's axis 
       may be flipped.                                           </li>
 
   <li>If using this to force certain images, from the same series, 
      to standout on a factor map (one class inactive, all others active), 
      use <a href="../../man/casm.html">'CA SM'</a> with <i>(S)</i>ymbol option
      (it's quicker).                                           </li>
</ul>

<p>Below are the 'CA SM' maps with no 'CA SMI' input, and below that are
   'CA SM' maps with 'CA SMI' input. Note the labeled images are 
   the same in all three, but the axis switch with an odd 
   numbered factor. This axis switch is caused by using non-transposed 
   data set. In order to have 'CA SMI' run on this data, forced 'CA S'
    to not transpose the data, with the "CN entry". Because of this, 
   'CA SM' reads in the 
   images differently from the transposed data. Be sure to take note of axes 
   if using 'CA SMI' -> 'CA SM'
</p>


   <table align="center" cellpadding="4">
      <tr>
      <td> <a href="save/casmi_reg1.gif"> <img src="save/casmi_reg1.jpg" </a></td>
      <td> <a href="save/casmi_reg2.gif"> <img src="save/casmi_reg2.jpg" </a></td>
      <td> <a href="save/casmi_reg3.gif"> <img src="save/casmi_reg3.jpg" </a></td>
      </tr>

      <tr>
      <th align= "center"> <a href="save/casmi_reg1.gif">Factor 1 vs. Factor 2</a></th>
      <th align= "center"> <a href="save/casmi_reg2.gif">Factor 1 vs. Factor 3 </a></th>
      <th align= "center"> <a href="save/casmi_reg3.gif">Factor 2 vs. Factor 3 </a></th>
      </tr>
   </table>
   <p align="center"><b> 'CA SM' maps with no 'CA SMI' input </b></p>


   <table align="center" cellpadding="4">
      <tr>
      <td> <a href="save/casmi_od1.gif"> <img src="save/casmi_od1.jpg" </a></td>
      <td> <a href="save/casmi_od2.gif"> <img src="save/casmi_od2.jpg" </a></td>
      <td> <a href="save/casmi_od3.gif"> <img src="save/casmi_od3.jpg" </a></td>
      </tr>

      <tr>
      <th align= "center"> <a href="save/casmi_od1.gif">Factor 1 vs. Factor 2</a></th>
      <th align= "center"> <a href="save/casmi_od2.gif">Factor 1 vs. Factor 3 </a></th>
      <th align= "center"> <a href="save/casmi_od3.gif">Factor 2 vs. Factor 3 </a></th>
      </tr>
    </table>
    <p align="center"><b> 'CA SM' maps with 'CA SMI' input </b></p>

<p />


<!-  xxxxxxxxxxxxxx View Factor (Correspondence) Map In.... xxxxxxxxxxxxxxxxxxxx - ->

<hr />

<h4>View Factor Map In 
    <a href="../../../web/docs/web.html">Web</a> and Compute Average Images</h4>

<p>Using <a href="../../../../web/docs/web.html">Web</a>
   you can view a factor (correspondence) map and select 
   images which are similar 
   using a "lasso" interface. Then the average of that lassoed "class" 
   is computed and can be viewed or stored as a new image. Also, 
   a document file can created listing what class each image 
   was placed in. I believe that only images can be used, not pixels. 
</p>


How To Use The <a href="../../../../web/docs/web.html">Web</a> Factor Map
   <ol>
   <li>Run the <a href="../../man/sdc.html">'SD C'</a> operation in SPIDER. </li>

   <li>Start <a href="../../../../web/docs/web.html">Web</a>
       with your data file extension 
       (i.e. "<a href="../../../../web/docs/web.html">Web</a> dat &") 
       and use the command -> image and "accept" to 
       navigate to where the cluster file is. </li>

   <li>If you are going to make image averages, the data 
       files and the <a href="../../man/sdc.html">'SD C'</a>
       doc. file should be in the same 
       folder and have the same extension. It is easier. </li>

   <li>In <a href="../../../../web/docs/web.html">Web</a>, 
       Commands -> Corr-map. 
       <a href="../../../../web/docs/corrmap.html">Explanation of window options</a>. </li>

   <li>When you "accept", a <a href="../../../../web/docs/web.html">Web</a> 
       window will appear, with 
       either numbers or circles representing the images, 
        depending on the "show image numbers" toggle.
 
   <li>"Lasso" a group of images with the left mouse button, 
       and after completely enclosing the intended images, 
        press the center button. A new window will appear. </li>

      <ul>
      <li>"Save images in Doc file" will open another 
          window. From this new window you can name the file, and 
          specify which registers carries the X co-ordinate, Y co-ordinate, 
          and the order of that particular group created during the run 
          of Corr-map. The first register always is the image number. 
          Please remember that the X and Y co-ordinates are actually 
          the values of the eigenvectors that was specified during the 
          begining of corr-map. </li> 

      <li>"Display avg. image" will show an average of all 
          included images on the screen. It will not save that 
          image. The "overlap" toggle cas_cas where the average is displayed. </li>


      <li>"Store avg. image" will save the average of the 
       selected images, but it will not be displayed on the screen. </li>

      <li>"New masking" will return you to the image factor map. </li>

      <li>"Continue masking" will do the same as new masking, 
          except all the selected image markers will be shadowed 
          in green. Useful to see what image markers have already 
          been catagorized. </li>
      <li>"stop mapping" ends the corr-map function
      </ul>

   <li>Continue selecting image markers with new/continue 
       masking until satisfied. Note that one image can be in many
       different groups. </li>
   </ol>
</p>

<p>The doc. file: <a href="save/sdc_doc.dat">sdc_doc.dat</a> is the result of running 
   <a href="../../man/sdc.html">'SD C'</a>
   on a <i>_IMC file</i>. It lists the image number and factor co-ordinates 
   of each image.
</p>

<p>The following is a is a screen-shot of Web Corr-map run: </p>
 
<p align="center" <a href="save/web_corrmap.gif"> <img src="save/web_corrmap.jpg" </a></p>

<p>  Note the placement of the average 
   images. The upper-right image is overlapped with it's 
   respective mask. We can also see what two traits were 
   being compared in this factor map, head shape and eye direction.
</p>

<p> The file: <a href="save/web_docimg001.dat">web_docimg001.dat</a> contains  
   the data created with the "Save images in Doc. file" option. 
   It lists the image number, X and Y co-ordinates and the 
   order of class it was formed from. This particular class 
   was the third formed, but the first image document list.
</p>

<!-  xxxxxxxxxxxxxx OTHER xxxxxxxxxxxxxxxxxxxx - ->

<hr />

<a name="extrastuff"><h4>Other stuff</h4>


<p>The procedure: <a href="webdendro.spi">webdendro.spi</a>  
   invokes <a href="../../man/clcla.html">'CL CLA'</a>' so that a new dendrogram 
   document file is created, with a different  lower threshold.<br/>
</p>

<p>The procedure: <a href="rename.spi">rename.spi</a> 
   can be used to change the extensions of a whole series of images. Is not a
   problem if follow hint number three above.
</p>


<!-  xxxxxxxxxxxxxx References xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx - ->
<hr />

<a name="ref"><h4>References</h4>

 <ul>
 <li> <a href="http://www.nature.com/nprot/journal/v3/n12/full/nprot.2008.156.html">
      SPIDER image processing for single-particle reconstruction of 
      biological macromolecules from electron micrographs</a>.  <br />
      Nature Protocols 3, 1941-1974 (2008) 
 </li>
 <p />

 <li> <a href="http://www.amazon.com/gp/product/0195182189/">
      Three-Dimensional Electron Microscopy of Macromolecular Assemblies</a>  <br />
      Oxford University Press, (February 2006)
 </li>
</ul>

<p />

<hr /> 
<p>

<small>
  Source:      docs/techs/classif/tutorial.html  &nbsp;&nbsp;&nbsp;  
  Last update: 10 Sep 2013    &nbsp;&nbsp;&nbsp;
</small></p>

<hr /> 

</body>
</html>


@


1.9
log
@*** empty log message ***
@
text
@d332 1
a332 1
            <b>gnuplot -persist data/cas_ca_eigpct.gnu </b> 
d335 1
a335 1
            <b>evince data/cas_ca_eigpct.ps             </b> 
d1141 1
a1141 1
  Last update: 06 Feb 2013    &nbsp;&nbsp;&nbsp;
@


1.8
log
@updated
@
text
@d311 1
a311 1
   <a href="../../man/caeigpct.html">'CA EIGPCT'</a> 
d540 1
a540 2
    which may give spurious classes,  
   <a href="../../man/clkm.html"> 'CL KM' </a> are discussed in detail 
d542 1
a542 1
   usefull for  other classification applications including classification
d586 1
a586 1
  which listing which images are assigned to each ot the classes.</p>
d712 1
a712 1
   Threfore the fourth carries only noise. </p>
@


1.7
log
@*** empty log message ***
@
text
@d3 1
a3 1
  <title> Classification and Clustering Tutorial</title>
d9 2
a10 4

<p>
<h1 align="center">Classification and Clustering Tutorial</h1>
</p>
d13 2
a14 4
cp 
<p>
<h3 align="center">Contents</h4>
</p>
d18 11
a28 9
   <li><a href="#CAPCA">  Correspondence or Principal Component Analysis</a>.</li>
   <li><a href="#histo">  Determine what variations are attribute or noise based</a>.</li>
   <li><a href="#fm">     Create Factor Maps </a>.</li>
   <li><a href="#clhc">   Control Clustering and Hierarchical Classification</a>.</li>
   <li><a href="#recon">  Re-create certain images from eigenvectors</a>.</li>
   <li><a href="#virtual">Create "virtual" images from eigenvectors</a></a>.</li>
   <li><a href="#web">    View dendrogram averages & factor (correspondence)
                              map averages</a>.</li>
   <li><a href="#ref">    References</a>.</li>
d32 1
a33 1
<!-- xxxxxxxxxxxxxxx  Automatic Classification/Clustering -- General Steps  xxxxxxxxxxxx -->
d35 1
a35 3
<p>
<h4 align="center">Automatic Classification/Clustering -- General Steps</h4>
</p>
d37 6
d49 2
a50 2
        <dd>Reads images.</dd>
        <dd>Carries out either PCA or CORAN analysis.</dd>
d57 1
a57 2

<li>Determine What Factors Are Important
d59 1
a59 1
       <li>Map Factors -- &nbsp; Utilizing output from: <a href="../../man/cas.html">'CA S' </a>
d62 3
a64 2
         <dt>Run: <a href="../../man/casm.html">'CA SM' </a>  </dt>
         <dd>Shows vector map of data: images, pixels, or eigenvectors </dd>
d69 2
a70 1
       <li>Clustering & Classification  -- &nbsp; Utilizing output from <a href="../../man/cas.html">'CA S' </a>. 
d73 10
a82 18
           <dt>Run: <a href="../../man/clcla.html">'CL CLA'</a>  </dt>   
           <dd>Finds clusters of data using Diday's method, then applys
               hierarchical ascendant classification (HAC), 
               creates cluster membership file, and dendrogram plot. </dd>
 
           <dt>Run: <a href="../../man/clhc.html">'CL HC' </a>  -- 
               Alternative to <a href="../../man/clcla.html">'CL CLA' </a></dt>   
           <dd>Finds clusters of data using  either single linkage, complete linkage,
               average linkage, the centroid method, or Ward's method to make a 
               dendrogram plot.</dd>

           <dt>Run: <a href="../../man/clkm.html">'CL KM' </a> --  
               Another alternative to <a href="../../man/clcla.html">'CL CLA' </a></dt>   
           <dd>Finds clusters of data using  K-means method, then applys
               hierarchical ascendant classification (HAC), 
               creates cluster membership doc. file. </dd>
           <dd>Uses the K-means method of clustering, no classification' to make a 
               dendrogram plot for clusters. </dd>
d88 4
a91 1
       <li>Study clustering. -- &nbsp;  Utilizing output from 'CL HC' or 'CL KM'. 
d96 1
a96 1
               in each class, for a given threshold. </dd>
d99 7
a105 2
           <dd>Creates doc files describing which images 
               in each class,  for a given threshold.</dd>
a106 2
       <p />

d110 1
d115 2
a116 1
   <li>View Images
d123 1
a123 1
            image from arbitrary eigenvector values  </dd>
d131 1
a131 1
        <dd>Create difference eigenimages. </dd>
d138 2
a139 2
        <dt>Run: <a href="../../man/casri.html">'CA SRI' </a>  </dt>   
        <dd>Reconstitute importance images. </dd>
d147 1
a147 1
   <li><a href="../../../../web/docs/web.html">View Dendrogram and Factor maps Using Web</a> 
d149 1
a149 1
     <li>View Dendrogram and average images, for a given threshold</li>
a150 1
     <li>View the factor map/create average images regardless of class</li>
a153 1
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Source Data  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
d157 5
a161 1
<h4 align="left">Source Data</h4>
d163 2
a164 1
<p>SPIDER procedures: <a href="makefaces.spi">makefaces.spi</a> (and the
d170 23
a192 6
   These procedure files create four kinds of stack files. 
   The <i>face_tmpl_stk</i> file contains the face templates, seen here. 
   The <i>face_nois_stk</i> file contains the noise-filled data set, seen here.  
   The <i>face_aver_stk </i> file contains the average of the ten noise images for each template,
   and <i>face_varn_stk </i> file contains the variance for each template.
</p>
d194 6
a199 2
<p align=center><img width="557" height="143" src="save/16faces.gif">
</p>
d201 1
a201 1
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxx  Correspondence Analysis...  xxxxxxxxxxxxxxxxxxxxxx -->
d218 1
a218 1
   The procedure file: <a href="cas.spi">cas.spi</a> creates a 
d234 1
a234 1
       result in "cas_ca_SEQ", "cas_ca_IMC, etc. </li>
d238 1
a238 2
<p> Description of <a href="../../man/cas.html">'CA S'</a> Output Files 
    (links lead to output from faces example) </p>
d240 2
a241 2
<ul>
   <p> 
d243 1
a243 47
   <li><a href="save/cas_ca_IMC.dat"><i>*_IMC</i></a> is a text file 
      that stores the coordinates of each IMAGE in the new vector space. The 
      contents on the first line are:
        <table class="small" border=1 padding-left="10" >
	<tr><td>&nbsp; NUMIM</td>     <td>&nbsp; # of images included in analysis </td>
	<tr><td>&nbsp; NFAC</td>      <td>&nbsp;  # of factors requested, entry to "number of factors" question </td>
	<tr><td>&nbsp; NX, NY</td>    <td>&nbsp;  X and Y values of images, respectively </td>
	<tr><td>&nbsp; NUMIM</td>     <td>&nbsp;  # of images included in analysis </td>
	<tr><td>&nbsp; PCA</td>       <td>&nbsp;  1 if PCA analysis was used, 0 if CA used </td>
	</table>
    <p> There is a line for each image included. The contents of this line are:
        <table  class="small" border=1>
	<tr><td>&nbsp; IMAGE(#)...NFAC)</td><td>&nbsp;  Coordinates for each image, in the vector space. 
                                          The number of entries depend on how many factors were 
                                          requested. </td>
	<tr><td>&nbsp; WEIGHTP</td>         <td>&nbsp;  Relative weight of each image, = # of pixels in 
                                          this image/# of pixels in all images </td>
	<tr><td>&nbsp; DOR</td>             <td>&nbsp;  Distance from the image to the origin of the 
                                          new vector space</td>
	<tr><td>&nbsp; FIM</td>             <td>&nbsp;  # of the image. The first, 32nd, etc. </td>
	<tr><td>&nbsp; ACT</td>             <td>&nbsp;  Active image flag. </td>
	</table>
   </li> 

   <li><a href="save/cas_ca_PIX.dat"><i>*_PIX</i></a> is a text file that stores 
        the coordinates of each PIXEL. Very similar to <i>*_IMC</i>. The contents on 
        the first line are:
        <table  class="small" border=1>
	<tr><td>&nbsp; NPIX</td>      <td>&nbsp;  # of pixels included in each image, determined by the mask</td>
	<tr><td>&nbsp; NFAC</td>      <td>&nbsp;  # of factors requested </td>
	<tr><td>&nbsp; NX,NY</td>     <td>&nbsp;  X and Y values of images, respectively </td>
	<tr><td>&nbsp; NUMIM</td>     <td>&nbsp;  # of images included in analysis </td>
	<tr><td>&nbsp; PCA</td>       <td>&nbsp;  1 if PCA analysis was used, 0 if CA used </td>
	</table>

    <p>There is a line for each pixel included. The outputs for this are:
        <table  class="small" border=1>
	<tr><td>&nbsp; PIXEL(#)...NFAC)</td>  <td>&nbsp;  Coordinates for each pixel, in the vector 
                                            space. The number of entries depend on how many 
                                            factors were requested. </td>
	<tr><td>&nbsp; WEIGHTP</td>           <td>&nbsp;  Relative weight of each pixel </td>
	<tr><td>&nbsp; CO</td>                <td>&nbsp;  Distance from the pixel to the origin of the 
                                            new vector space </td>
	<tr><td>&nbsp; FPIX</td>              <td&nbsp; > # of the pixel. The first, 32nd, etc. </td>
	<tr><td>&nbsp; DUMMY</td>             <td>&nbsp;  Unused </td>
	</table>
   </li>
d245 3
a247 26
   <li><a href="save/cas_ca_EIG.dat">*_EIG</a> is a text file that stores 
        the eigenvector values. The contents on the first line are:
        <table class="small" border=1>
	<tr><td>&nbsp; NFAC</td>             <td>&nbsp;  # of factors requested </td>
	<tr><td>&nbsp; TOTAL WEIGHT</td>     <td>&nbsp;  Sum of all the pixels used. Not the # of them.</td> 
	<tr><td>&nbsp; TRACE</td>            <td>&nbsp;  Sum of the diagonal of the eigenvector array</td>
	<tr><td>&nbsp; PCA</td>              <td>&nbsp;  1 if PCA analysis was used, 0 if CA used </td>
	<tr><td>&nbsp; N</td>                <td>&nbsp;  Number </td>
	</table>

    <p>There is a line for each factor requested. The outputs for this are: 
        <table class="small" border=1>
	<tr><td>&nbsp; EIGENVALUE</td>     <td>&nbsp;  Eigenvalue, listed largest first.</td> 
	<tr><td>&nbsp; %</td>              <td>&nbsp;  % of the total inter-image variance this 
                                         eigenvalue is responsible for.</td>
	<tr><td>CUMULATIVE %</td>   <td>&nbsp;  Running tally of how much interimage </td>
                                         variance is accounted for by eigenvalues</td>
	</table>

    <p>If PCA was used there are additional lines. 
        The outputs for these are: 
        <table class="small" border=1>
	<tr><td>&nbsp; AVERAGE(#)...N )<td>&nbsp; %</td>&nbsp;  Average for this image or pixel</td> 
	</table>
    </p>
    </li>
d249 4
a252 14
    <p>
    <li>*_SEQ is a binary file that stores all image pixel values 
        within the mask from all the images. 
        <b>NOT</b> a SPIDER image. Only useful internally within other 
        'CA' &amp; 'CL' operations. 
    </li> 
    </p>

    <p>
    <li>*_SET is a binary file with transposed data. 
        <b>NOT</b> a SPIDER image. Only useful internally within other 
        'CA' &amp; 'CL' operations. 
    </li> 
    </p>
d254 4
a257 1
</ul>
d259 5
a263 3
   In addition to the above 
   <code class="op">  <a href="../../man/cas.html">'CA S' </a></code> output files, 
   <code class="proc"><a href="cas.spi">           cas.spi</a></code> creates: 
d265 11
a275 1
   <table class="outs" cellpadding="4">
d277 1
d279 3
a281 2
          <td><div class="output">face_mask.spi</div> </td>
          <td>A SPIDER image containing user-defined circular mask. </td> </tr>
d284 5
a288 4
          <td><div class="output"> <a href="save/cas_ca_cor_doc.dat">cas_ca_cor_doc.dat</a></div>:</td>
          <td>A SPIDER document file containing list of eigenvectors for each 
              image for factors 1 and 2.</td> </tr>
   </table>
d290 1
a290 1
<!-- xxxxxxxxxxxxxxxxxxxxx   Which Eigenvalues Are Useful   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
d299 1
a299 1
<h4> Determining Which Eigenvalues Are Useful, And Which are from Noise</h4>
d301 6
a306 5
</p>The best method to determine what eigenvalues are useful to use is 
   to view a histogram showing the percentage of variance accounted for by 
   each factor. As the histogram to the right shows, the last 
   five eigenvalues are small compared to the first three. Also they are level, 
   typical of noise. This is interpreted as the first three eigenvectors 
a308 2
How To Create and View Eigenvalue Histogram: 

d310 3
a312 3
   The procedure file: <a href="caeigpct.spi">caeigpct.spi</a>  invokes 
   <a href="../../man/caeigpct.html">'CA EIGPCT'</a> to create and plot 
   following higtogram files: 
d329 1
a329 1
 </p>
d331 5
a335 4
   The <a href="save/cas_ca_eigpct.gnu">Gnuplot file</a> can be visualized using:
            <b>gnuplot -persist cas_ca_eigpct.gnu </b> <br />
   The <a href="save/cas_ca_eigpct.gnu">Postscript file</a> can be visualized using:
            <b>evince cas_ca_eigpct.ps             </b> <br />
a336 1
   
d339 1
a339 1
<!-- xxxxxxxxxxxxxxxxxxxxxx Creating Factor Maps xxxxxxxxxxxxxxxxxxxxxxxxxxx -->
d344 1
a344 1
<h4><p>Creating Factor Maps to View Groupings, If Any</h4></p>
d347 5
a351 1
   and which are noise, we can see if there is any obvious clustering. 
a352 2
   <a href="../../man/casm.html">'CA SM'</a> is an operation used to view 
   2D factor maps (graphs) of selected eigenvalues. 
d354 8
a361 1
   Note that to view these maps you must have  run: <a href="#CAPCA">CA S</a> first.
d369 2
a370 2
      pixels". This also determines if 'CA SM' will read 
      <i>*_PIX or *_IMC </i>. </li>
d380 1
a380 1
      "I" is typically the best choice. </li>
d387 1
a387 1
      "FLIP #2" exchanges up-down." </li>
d392 2
a393 3
   <li>A common problem when creating a pixel factor map is an  
       "ERROR: *** MAP ABORTED, MORE THAN 264 POINTS ON FRAME" 
       error message. This is because of the large number of points. 
d397 3
a401 7
<p>The procedure file: <a href="factor.spi">factor.spi</a> invokes 
   the SPIDER procedure: <a href="factor_casm.spi">factor_casm.spi</a> 
   three times, creating three
   different factor maps using <a href="../../man/casm.html">'CA SM'</a>
   and selecting different pairs of factors. 'CA SM' is  run under 
   the assumptions that you want image space with "id's" to create 
   PostScript plots.</p>
d422 1
a422 1
he pixel factor maps below were created from a screen  
d443 1
a443 1
<!-- xxxxxxxxxxxxxx Control Hierarchical Clustering xxxxxxxxxxxxxxxxxxxx -->
d448 2
a449 1
<h4>Controlled Hierarchical Clustering</h4>
d451 13
a463 6
<p>The operation <a href="../../man/clcla.html">'CL CLA'</a>
   is limited in that it only uses Diday's and Ward's methods. 
   <a href="../../man/clhc.html">'CL HC'</a> is more robust because 
   the user controls the clustering criterion 
   and can alter the "weights" for each factor. To best represent 
   the "truth" set all factor weights equal to each other. </p>
d467 4
a470 3
   <li>"CORAN/PCA FILE" is the name of the file from 'CA S'. 
       'CL HC' can accept <i>_IMC, _SEQ, or _PIX</i>  files. So this entry 
       must include one of these endings to distinguish the kind of file.</li> 
d474 3
a476 1
       to the other factors. Zero sets all the rest of the factors to 1.0</li>
d478 1
a478 1
   <li>"CLUSTERING CRITERION".  Option 5 is the method 'CL CLA' uses.</li>
d480 1
a480 1
   <li>A The output "DENDROGRAM DOC FILE" is used with 
d483 4
a486 2
         'CL HD' and 'CL HE' operations to create document files listing
          the images assigned to each cluster.</li>
d489 1
a489 7
<p>The procedure: <a href="clhc.spi">clhc.spi</a> 
    invokes <a href="../../man/clhc.html">'CL HC'</a>
    which reads the <i>CA/PCA</i> files from 'CA S' and creates
    dendrogram plot files and document files.
</p>

<p>Screen snaphots of the PostScript dendrograms from 
d491 2
a492 2
    for our "faces" data using clustering option 2 (complete linkage) 
    and option 5 (Ward's method) (Click to see full-size):
d494 1
a494 1
   <table align="center"cellpadding="4">
a523 5
<p>Screen snapshot of <a href="../../../../web/docs/web.html">Web</a>
  display of the complete linkage dendrogram truncated at 20% level. 
  Note that all of the images are properly seperated by head shape and eye 
  direction. Mouth size is not so clear because it's eigenvalue is 
  close to the eigenvalue for noise (Click to see full-size):
a524 4
   <table align= "center"  cellpadding="4">
      <tr>
      <td> <a href="save/web_clhc_den_2.jpg"> <img src="save/web_clhc_den_2_sm.jpg" </a></td>
      </tr>
d526 29
a554 5
      <tr>
      <th> <a href="save/web_clhc_den_2.jpg">Dendrogram snapshot</a></th>
      </tr>
    </table>
<p />
d556 9
d568 1
a568 1
   uses the dendrogram doc. file from 
d580 1
d582 1
a582 1
   uses the dendrogram doc. file from 
d585 3
a587 3
   a series of class doc. files 
  (e.g. <a href="save/clhc_den_clas_001.dat">class : 1</a>) ,
  listing which images are assigned to each class.</p>
d595 2
a596 1
   The class averages are then placed in a montage:
d599 1
a599 3
      <tr>
      <td> <img src="save/clhc_clas_montage.jpg" </a></td>
      </tr>
d601 1
a601 3
      <tr>
      <th> Montage</th>
      </tr>
d604 1
a604 1
   The images are classified  perfectly according to head shape and eye direction.</p>
a605 1
<!-- xxxxxxxxxxxxxx Automatic Clustering and Hierarchical Ascendant.. xxxxxxxxxxxxxxx -->
a606 2
<hr />
<a name="hac">
d608 13
a620 1
<h4>Automatic Clustering and Hierarchical Ascendant Classifications (HAC)</h4>
d622 5
a626 20
<p>With the "useful" eigenvectors known, we can much more efficiently 
   determine the representative clusters. This also allows compression 
   of information with minimal loss. Some output of 
   <a href="../../man/clcla.html">'CL CLA'</a> can also be used with 
   <a href="../../man/cas,.html"> 'CA SM'</a>  to produce more meaningful maps.
</p>

<p><a href="../../man/clcla.html">'CL CLA'</a> differs from the 
   other clustering operations in that for 
   clustering it uses Diday's method, and for HAC it uses only 
   Ward's criterion. A disadvantage of the K-means method is that 
   the final clustering is very dependent of what seeds are initially 
   chosen. Diday surpassed this by appplying the K-means technique 
   multiple times with different seeds. Then, cross-tabuluating the 
   results, and using only the clusters that were repeatedly formed. 
   Ward's criterion states that merging HAC clusters should be focused 
   on minimizing the added interclass variance. The two clusters that
   differ the least between each other will be merged and create a new 
   cluster, one "level" higher. 
</p> 
d628 2
a629 1
Hints for using: <a href="../../man/clcla.html">'CL CLA'</a> 
d631 11
a641 3
<ul>
   <li>"CORAN/PCA FILE PREFIX" is the response previously given for the 
       "Output file prefix" question in 'CA S'. </li>
d643 4
a646 26
   <li>"CLUSTER OUTPUT FILE FOR CA SM USE" is the file to use with 'CA SM' to name 
       image points by cluster. Not otherwise used in  
       <a href="../../../../web/docs/web.html">Web</a> or SPIDER.</li>

   <li>'CL CLA' uses the "moving center" method. Iterations are how 
       many times the center is moved, and the centers per partition
       is how many  points are initially used, per partition. </li>

   <li>"NUMBER OF INITIAL CLUSTERS" signifies the number of clusters 
        'CL CLA' will initally expect.</li>

   <li>"OCCUPANCY LEVEL FOR CLASS CUTTOFF" is the level or elements/images 
        at which a class is not included in dendogram. </li>

   <li>The "DENDROGRAM POSTSCRIPT OUTPUT FILE" plot is useful to show the 
       relationship between clusters/classes.  </li>

   <li>The "PLOT CUTTOFF" can be used to truncate the lower edge of the
       dendrogram to remove excess branches. </li>

   <li>The "DENDROGRAM DOC. FILE" is used by the 
       <a href="../../../../web/docs/web.html">Web</a> 
       dendrogram operation and by: 
       <a href="../../man/clhe.html">'CL HE'</a> and
       <a href="../../man/clhd.html">'CL HD'</a>.</li>
</ul>
a647 11
<p>The procedure: <a href="clcla.spi">clcla.spi</a> invokes  
   <a href="../../man/clcla.html">'CL CLA'</a> to create a 
   <a href="save/clcla_dend.jpg">dendrogram plot</a>. 
    A vertical and horizontal line 
    meeting signify the joining of two classes below it. A representitive  
    reconstruction can be formed for each class with the  
    <a href="../../man/casr.html">'CA SR'</a> operation. 
   The larger vertical bars signify a greater difference between 
   classes. The many small differences at the bottom can be eliminated 
   with an increase of the "% cutoff" setting. 
   (<small>The <i>jpg</i> file was obtained using screen snapshot.</small>) 
d650 5
a654 3
<p>The <a href="save/clcla_results.dat">results</a> file that is 
  formed after every SPIDER run also holds a large amount of information 
  after a 'CA CLA' run.</p>
d656 4
a659 2
<!-- xxxxxxxxxxxxxx Examination Of K-Means Clustering xxxxxxxxxxxxxxxxxxxx -->
<hr />
d661 5
a665 1
<h4>Examination Of K-Means Clustering</h4>
a666 60
<p>K-Means is a method of clustering that divides the data into a 
   user defined number of clusters. Two random images "seeds" are chosen, 
   and their centers of gravity are computed. A partition is drawn down 
   the middle between the centers, the new centers of gravity are computed, 
   and the process is repeated for a given number of times. The final result 
   is VERY dependent on which image seeds are the first chosen.
</p>

<p>Because our faces data set is manufactured. We know exactly which 
   images are identical, except for the random noise, and the exact 
   number of clusters. The output discussed here was obtained with 8 classes, 
   using factors 1-3, and an even factor weight of 1.0 between those 
   three factors. (NOTE: The results were from a data set with somewhat
   different noise from other runs discussed in this tutorial.)
</p>

<p>The doc file: <a href="save/clkm_453_doc.dat">clkm_453_doc</a> 
   was produced by a run of 
   <a href="../../man/clkm.html">'CL KM'</a> 
   with the above input values with a random seed 
   number of 453. The third column describes the image number and the 
   fourth column is the class that 'CL KM' placed the image in. Images 1-10 
   were all placed in cluster 6, which is what we expect because they are 
   all noisy images of the same protoimage. 'CL KM' kept the images from 
   the same protoimage clustered together somewhat, except for the last 
   ten images. However, it prefered to place images 11-20 and 31-40 
   in the same cluster, instead of each giving them each their own cluster. 
   The average image for images 11-20 and 31-40 are shown below. They 
   differ by their mouth size. </p>

<p align="center"><img width="64" height="64" src="save/sca020.jpg">
                  <img width="64" height="64" src="save/sca040.jpg">
</p>

<p>The       file:       <a href="save/clkm_789_doc.dat">clkm_789_doc</a> 
   is a doc. file from a <a href="../../man/clkm.html">'CL KM'</a>
   run exactly same as the previous, except with 
   a random number of 789. Once again, most images were placed into 
   the correct protoimage cluster correctly, except for the last few images. 
   But in addition to images 11-20 and 31-40 being clustered together, 
   images 1-10 and 21-30 were placed in the same cluster as well. This 
   clearly demonstrates that K-means is highly dependent on the first 
   image chosen, and should be used with extreme caution. Below are 
   the average images for 1-10 and 21-30. 
</p>

<p align="center"><img width="64" height="64" src="save/sca010.jpg">
                  <img width="64" height="64" src="save/sca030.jpg">
</p>

<p>The doc files: <a href="save/clkm_SEQ_453_doc.dat">clkm_SEQ_453_doc</a> and 
                  <a href="save/clkm_PIX_453_doc.dat">clkm_PIX_453_doc</a> 
   are outputs from 'CL KM' being run on the same data as above, but using 
   the <i>SEQ </i> and  <i>PIX</i> files, respectively. 
   The clkm_PIX_453_doc.dat file is 95Kb in size. 
   The results for the  <i>SEQ</i> run should be the same result as the 
   previous runs, because it is still comparing images. However, the <i>PIX</i> 
   results are expected to be different because it is trying to place 
   the PIXELS in eight different classes. 
</p>
a667 13
Hints for: <a href="../../man/clkm.html">'CL KM'</a> 
<ul>
   <li>"CORAN/PCA FILE" must be the FULL name of the file you want 
        to use (without the data extension), this is because it can input 
        <i>SEQ, PIX, or IMC files</i>.</li>
   <li>"NUMBER OF CLASSES" = different clusters.</li>
   <li>"RANDOM SEED STARTING NUMBER", this should be made a note of, you should be  
        able to re-create runs with the same data and random number.</li>
   <li>"TEMPLATE FILENAME", for each class/cluster requested, 'CL KM' outputs a file 
       with this prefix.</li>
   <li>DOCUMENT FILE,'CL KM' returns one large file that tells the cluster 
       assigned for each image/pixel used.</li>
</ul>
a668 3
<p>The procedure file: <a href="clkm.spi">clkm.spi</a>  
   invokes 'CL KM' and creates class averages for the specified number of classes.
</p>
d670 1
a670 1
<!-- xxxxxxxxxxxxxx Re-Create Images From Eigenvectors xxxxxxxxxxxxxxxxxxxx -->
d675 1
a675 1
<h4>Re-Create Images From Eigenvectors</h4>
d679 23
a701 1
   compression. Below, is an from our sample data set and four 
d704 1
a704 1
   function in the procedure files 
d707 2
a708 6
   which were used to create this data. </small>)
</p>

<p align=center><img src="save/casr_69.jpg"> </p>

<p>It is difficult to see what traits the original image has because of noise. 
d715 2
a722 20
Hints for: <a href="../../man/casr.html">'CA SR'</a> 

<ul>
   <li>"FILE PREFIX" is the response given for the "output file prefix" 
       question from 'CA S'.</li> 

   <li>"FILE #'S TO BE USED" = file numbers of images.</li>

   <li>"FACTORS TO BE USED" stands for which factors to be 
       utilized in the reconstitution.</li>

   <li>"OUTPUT FILE TEMPLATE" needs at least one <i>*</i> at the end 
       or it aborts program.</li>
</ul>

<p>
The procedure: <a href="casr.spi">casr.spi</a> 
invokes <a href="../../man/casr.html">'CA SR'</a>
 to re-constitute any image, or images, from the eigenvectors.
</p>
d735 1
a735 1
<!-- xxxxxxxxxxxxxx Create Arbitrary "Virtual" Images.. xxxxxxxxxxxxxxxxxxxx -->
d754 22
d793 1
a793 14
Hints for: <a href="../../man/casra.html">'CA SRA'</a> 
<ul>
   <li>To determine coordinate values, consult a factor map.</li>
   <li>Do not assume that a zero will fill the rest of the 
       factor values to zero.</li>
   <li>See hints for 'CA SR' above.</li>
</ul>

<p>The procedure file: <a href="casra.spi">casra.spi</a> 
   invokes 'CA SR'.  The procedure file: 
   <a href="casramontage.spi">casramontage.spi</a> 
   was used to create the image below. <br/>

   The virtual images are created by changing only one 
d808 4
d814 3
a816 1
<!-- xxxxxxxxxxxxxx Viewing Eigenimages xxxxxxxxxxxxxxxxxxxx -->
d827 8
d837 1
a837 1
<li>None, see the manual page.</li>
d840 1
a840 7
<p>The procedure file:<a href="casre.spi">casre.spi</a> 
invokes 'CA SRE'. It assumes that if you want more 
than one factor, they are continuous. Also assumes that you 
are using CORAN output. Both of these assumptions are in 
the procedure file, not the operation. Edit the procedure 
file to change them. Sample results.
</p>
d846 1
d848 1
a848 1
<!-- xxxxxxxxxxxxxx Show Differences Between Images (Eigenimages) xxxxxxxxxxxxxxxxxxxx -->
d855 1
a855 1
<p> Use <a href="../../man/casrd.html">'CA SRD'</a> 
d858 3
a860 4
<p align=center><img width="64" height="64" src="save/face_avg_all.jpg">
                <img width="64" height="64" src="save/casrd_1_69.jpg">
                <img width="64" height="64" src="save/casrd_2_69.jpg">
                <img width="64" height="64" src="save/casrd_3_69.jpg">
d863 12
a874 1
<p>The first image is the average among all 80 sample images. 
d882 6
d889 1
a889 1
<br/>Below are the seperate difference eigenimages for another 
a913 12
<p>Hints for: <a href="../../man/casrd.html">'CA SRD'</a></p> 

<ul>
   <li>"PREFIX" is the base name before <i>_SEQ, _IMC, _PIX,</i> etc.</li>
   <li>An entry out of bounds has no useful purpose.</li>
   <li>See hints for 'CA SR' above.</li>
</ul>

<p>The procedure file: <a href="casrd.spi">casrd.spi</a> invokes
   'CA SRD'.  Note that it is similar to 
   <a href="casr.spi">casr.spi</a> except for minor changes. 
</p>
d915 1
a915 1
<!-- xxxxxxxxxxxxxx Subgrouping images xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
d919 1
a919 1
<h4>Subgrouping images</h4>
d921 3
a923 4
<p> Use <a href="../../man/casmi.html">'CA SMI'</a> 
   to separate a series of 
   images into active/inactive clusters. It appears that this 
   can actually perform operations on a series of images 
d930 2
d935 1
a935 1
   <li>Only supports image input and <i>_IMC</i> output?</li>
d940 1
a940 1
      the fifth input.</li>
d943 1
a943 1
       may be flipped.</li>
d948 1
a948 1
      (it's quicker).</li>
d951 2
a952 3
<p>The procedure file: <a href="casmi.spi">casmi.spi</a> invokes 'CA SMI'. <br/>
   Below are the 'CA SM' maps with no 'CA SMI' input, and below 
   those maps with 'CA SMI' input. Note the labeled images are 
d958 1
a958 1
   images different from the transposed data. Be sure to take note of axes 
d962 1
d975 3
a977 1
    </table>
d992 2
a995 6
<!-- xxxxxxxxxxxxxx View Dendrogram In Web xxxxxxxxxxxxxxxxxxxx -->

<hr />
<a name="web">

<h4>View Dendrogram In <a href="../../../../web/docs/web.html">Web</a></h4>
d997 1
a997 48
<p><a href="../../../../web/docs/web.html">Web</a>
   can be used to view a dendrogram of the data instead of 
   using <a href="../../man/clcla.html">'CL CLA'</a>. Also works with the output 
   of <a href="#clhc">CL HC</a>. 
   <a href="../../../../web/docs/web.html">Web</a> will display 
   not only a usual dendrogram, but also the average of all the images 
   below a threshold, and the number of images in each average.
</p>

How To Use The <a href="../../../../web/docs/web.html">Web</a> Dendrogram 
<ol>
   <li>Run 'CL CLA' (or 'CL HC'), and request a dendrogram doc file.</li>

   <li>Make sure that your image files and <i>dendrogram doc file</i> have 
       the same extension and are in the same folder, it's easier. </li>

   <li>Start <a href="../../../../web/docs/web.html">Web</a> with your extension 
       (i.e."<a href="../../../../web/docs/web.html">Web</a> dat &") and select 
       Command -> image from the menus to navigate to where the images and 
       cluster files are. Press "OK". </li>

   <li>Commands -> Dendrogram and select the cluster file.</li>

   <li>When the Dendrogram window pops up, to see all of what 
       you selected, choose lowest threshold option. All the 
       variation that was carried over from the 'CL CLA' or 'CL HC' operation is 
       scaled from what the lowest level selected  to +1 above.</li> 

   <li>If the "Show average images" option is selected, Web will 
       show the average of the lowest level shown. This is why 
       having the images in the same folder as the dendrogram doc 
       file is easier. </li>
</ol>

<p>The procedure file: <a href="webdendro.spi">webdendro.spi</a>  
   invokes <a href="../../man/clcla.html">'CL CLA'</a>' so that a new dendrogram 
   document file is created, with a different  lower threshold.<br/>

   The document file: <a href="save/web_den_doc.dat">web_den_doc.dat</a> 
   is an example of a dendrogram document file. 
</p>

<p>The procedure file: <a href="rename.spi">rename.spi</a> 
   can be used to change the extensions of a whole series of images. Is not a
   problem if follow hint number three above.
</p>

<!-- xxxxxxxxxxxxxx View Factor (Correspondence) Map In.... xxxxxxxxxxxxxxxxxxxx -->
d1001 2
a1002 2
<h4>View Factor (Correspondence) Map In 
    <a href="../../../web/docs/web.html">Web</a> and Compute Averages</h4>
d1005 3
a1007 2
   you can view a factor map and select select images which are similar 
   using a "lasso" interface. Then the average of that class 
d1009 1
a1009 1
   a SPIDER document file can created listing what class each image 
d1020 1
a1020 1
       (i.e."<a href="../../../../web/docs/web.html">Web</a> dat &") 
d1098 17
d1116 1
a1116 1
<!-- xxxxxxxxxxxxxx References xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
d1141 2
a1142 2
Source:      docs/techs/classif/tutorial.html  &nbsp;&nbsp;&nbsp;  
Last update: 04 Feb 2013    &nbsp;&nbsp;&nbsp;
@


1.6
log
@Unitalicized Gnuplot script
@
text
@d3 2
a4 1
<title> Classification and Clustering Tutorial</title>
a6 7
<style type="text/css" xml:space="preserve">
<!--
b_command{
   font-weight:bold;
   }
-->
</style>
d15 1
a15 1

d25 1
a25 1
   <li><a href="#clhc">   Controlled Clustering and Hierarchical Classification</a>.</li>
d29 1
a29 1
                             map averages</a>.</li>
d35 1
d42 1
a42 1
<li>Execute CORAN or PCA 
d46 4
a49 4
      <dt>Run: <a href="../../man/cas.html">'CA S' </a> </dt>
      <dd>Reads images.</dd>
      <dd>Carries out either PCA or CORAN analysis.</dd>
      <dd>Creates data files that are input for following steps.</dd>
d53 1
a53 1
<p></p>
d58 1
a58 1
       <li>Map
d61 2
a62 3
       <dt>Run: <a href="../../man/casm.html">'CA SM' </a>  </dt>
       <dd>Reads output files from: 'CA S'.</dd>
       <dd>Shows vector map of data: images, pixels, or eigenvectors </dd>
d65 1
a65 1
       <p></p>
d67 1
a67 1
       <li>Clustering & Classification
d69 20
a88 33
       <dl>
       <dt>Run: <a href="../../man/clcla.html">'CL CLA' </a>  </dt>   
       <dd>Reads output files from 'CA S'. </dd>
       <dd>Finds clusters of data using Diday's method, then applys
           hierarchical ascendant classification (HAC), 
           creates cluster membership file, and dendrogram plot. </dd>
       </dl>
       <p></p>

       <dl>
       <dt>
           Run: <a href="../../man/clhc.html">'CL HC' </a>  -- 
           Alternative to <a href="../../man/clcla.html">'CL CLA' </a></dt>   
       <dd>Reads output files from: 'CA S'.</dd>
        <dd>Finds clusters of data using  either single linkage, complete linkage,
            average linkage, the centroid method, or Ward's method to make a 
            dendrogram plot.</dd>
       </dl>
       <p></p>

       <dl>
       <dt> 
           Run: <a href="../../man/clkm.html">'CL KM' </a> --  
           Alternative to <a href="../../man/clcla.html">'CL CLA' </a></dt>   
       <dd>Reads output files from: 'CA S'.</dd>
       <dd>Finds clusters of data using  K-means method, then applys
            hierarchical ascendant classification (HAC), 
            creates cluster membership doc. file. </dd>
       </dl>

       <dd>Uses the K-means method of clustering, no classification' to make a 
          dendrogram plot for clusters. </dd>
       </dl>
d91 1
a91 1
       <p></p>
d93 1
a93 8
       <li>Study clustering.
       <dl>
       <dt>Run: <a href="../../man/clhd.html">'CL HD' </a>  </dt>   
       <dd>Reads output files from 'CL HC' or 'CL KM'. </dd>
       <dd>Counts number of classes and images 
         in each class, for a given threshold. </dd>
       </dl>
       <p></p>
d95 10
a104 7
       <dl>
       <dt>Run: <a href="../../man/clhe.html">'CL HE' </a>  </dt>   
       <dd>Reads output files from 'CL HC' or 'CL KM'. </dd>
       <dd>Creates doc files describing which images 
              in each class,  for a given threshold.</dd>
       </dl>
       <p></p>
d108 1
a108 1
       <p></p>
d117 5
a121 6
    <dl>
    <dt>Run: <a href="../../man/casr.html">'CA SR' </a>  </dt>   
    <dd>Reconstitute images from eigenvalues & create "virtual" 
        image from arbitrary eigenvector values  </dd>
    </dl>
    <p></p>
d123 1
d126 4
a129 5
    <dl>
    <dt>Run: <a href="../../man/casd.html">'CA SD' </a>  </dt>   
    <dd>Create difference eigenimages. </dd>
    </dl>
    <p></p>
d131 1
d134 4
a137 5
    <dl>
    <dt>Run: <a href="../../man/casri.html">'CA SRI' </a>  </dt>   
    <dd>Reconstitute importance images. </dd>
    </dl>
    <p></p>
d139 1
d144 1
a144 1
   <li><a href="../../../../web/docs/web.html">Web</a> Use
d146 3
a148 2
   <li>View Dendrogram and average images, for a given threshold</li>
   <li>View the factor map/create average images regardless of class</li>
d152 2
a153 1
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
d158 4
a161 4
<p>SPIDER procedures: <a href="makefaces.spi">makefaces.spi</a> (and 
   the <a href="face.spi">face.spi</a> procedure which it calls) 
   were used to create the eight
   original faces below. The faces differ in three ways: oval vs. round
d163 6
a168 5
   face with random noise created the sample data set. These procedure
   files create four kinds of files. The <i>scr*</i> files are the face templates,
   seen here. The  <i>sma*</i> files are the noise-filled data set, example below.
   The  <i>sca*</i> files carry the average of the ten noise images for each template,
   and  <i>scv*</i> hold the variance for each template.
d174 1
a174 1
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
d177 2
a178 4
<p>
<a name="CAPCA"></a><h4><p>Correspondence Analysis (CA) or 
   Principal Component Analysis (PCA)</h4>
</p>
d180 8
a187 4
<p>CA is the preferred method of finding variations and we will
   principally be discussing inter-image variance. PCA computes the
   distance between data vectors with Euclidean distances, while CA uses
   Chi-squared distance. This is superior because it ignores differences
d189 6
a194 7
   images.<br />
   The procedure file: <a href="cas.spi">cas.spi</a> invokes the
   'CA S' operation.  The procedure file assumes you prefer CA and creates a
   user-defined circular mask. The procedure <i>cas.spi</i> also produces  
   <a href="data/eigendoc.dat">eigendoc.dat</a> document file which 
   contains listing of eigenvectors for each image for factors 1 and 2.
</p>
d204 1
a204 1
      <a href="../../man/cas.html">'CA S'</a> for more detail. </li>
d206 2
a207 2
    <li>"Output file prefix" names all output files. A "Control" entry will 
       result in "Control_SEQ", "Control_IMC, etc. </li>
d211 2
a212 1
<p> Description of Output Files (links lead to output from faces example) </p>
d216 2
a217 1
   <li><a href="data/control_IMC.dat"><i>*_IMC</i></a> is a text file 
d220 6
a225 7
	
        <table border=1>
	<tr><td>NUMIM</td>     <td> # of images included in analysis </td>
	<tr><td>NFAC</td>      <td> # of factors requested, entry to "number of factors" question </td>
	<tr><td>NSAM, NROW</td><td> X and Y values of images, respectively </td>
	<tr><td>NUMIM</td>     <td> # of images included in analysis </td>
	<tr><td>PCA</td>       <td> 1 if PCA analysis was used, 0 if CA used </td>
d228 2
a229 2
        <table border=1>
	<tr><td>IMAGE(#)...NFAC)</td><td> Coordinates for each image, in the vector space. 
d232 1
a232 1
	<tr><td>WEIGHTP</td>         <td> Relative weight of each image, = # of pixels in 
d234 1
a234 1
	<tr><td>DOR</td>             <td> Distance from the image to the origin of the 
d236 2
a237 2
	<tr><td>FIM</td>             <td> # of the image. The first, 32nd, etc. </td>
	<tr><td>ACT</td>             <td> Active image flag. </td>
d241 1
a241 1
   <li><a href="data/control_PIX.dat"><i>*_PIX</i></a> is a text file that stores 
d244 6
a249 6
        <table border=1>
	<tr><td>NPIX</td>      <td> # of pixels included in each image, determined by the mask</td>
	<tr><td>NFAC</td>      <td> # of factors requested </td>
	<tr><td>NSAM,NROW</td> <td> X and Y values of images, respectively </td>
	<tr><td>NUMIM</td>     <td> # of images included in analysis </td>
	<tr><td>PCA</td>       <td> 1 if PCA analysis was used, 0 if CA used </td>
d253 2
a254 2
        <table border=1>
	<tr><td>PIXEL(#)...NFAC)</td>  <td> Coordinates for each pixel, in the vector 
d257 2
a258 2
	<tr><td>WEIGHTP</td>           <td> Relative weight of each pixel </td>
	<tr><td>CO</td>                <td> Distance from the pixel to the origin of the 
d260 2
a261 2
	<tr><td>FPIX</td>              <td> # of the pixel. The first, 32nd, etc. </td>
	<tr><td>DUMMY</td>             <td> Unused </td>
d265 1
a265 1
   <li><a href="data/control_EIG.dat">*_EIG</a> is a text file that stores 
d267 6
a272 6
        <table border=1>
	<tr><td>NFAC</td>             <td> # of factors requested </td>
	<tr><td>TOTAL WEIGHT</td>     <td> Sum of all the pixels used. Not the # of them.</td> 
	<tr><td>TRACE</td>            <td> Sum of the diagonal of the eigenvector array</td>
	<tr><td>PCA</td>              <td> 1 if PCA analysis was used, 0 if CA used </td>
	<tr><td>N</td>                <td> Number </td>
d276 3
a278 3
        <table border=1>
	<tr><td>EIGENVALUE</td>     <td> Eigenvalue, listed largest first.</td> 
	<tr><td>%</td>              <td> % of the total inter-image variance this 
d280 1
a280 1
	<tr><td>CUMULATIVE %</td>   <td> Running tally of how much interimage </td>
d286 2
a287 2
        <table border=1>
	<tr><td>AVERAGE(#)...N )<td>%</td> Average for this image or pixel</td> 
a292 5
    <li>*_MAS is a SPIDER image file.
    </li>
    </p>

    <p>
d294 3
a296 3
       within the mask from all the images. This file is NOT viewable in 
      <a href="../../../../web/web.html">Web</a> 
       and is only useful internally to other 'CA' operations. 
d301 3
a303 2
    <li>*_SET is a binary file with transposed data. This file is  
    only useful internally to 'CA' operations. 
d309 17
a325 1
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
d328 3
a330 1
<a name="histo"></a>  <img src="save/ploteigen.gif" align="right">
d337 2
a338 1
   to view a histogram of them. As the histogram to the right shows, the last 
d343 1
a343 1
How To View Eigenvalue Histogram 
d345 29
a373 20
<ol>
   <li>Run:  
      <b_command>python <a href="eigendoc.py">eigendoc.py</a> 
           <i>name_EIG.*</i> > <i>eigenvalues.dat</i> </b_command> <br />
      where 
      <ul>
      <li><i>name_EIG.*</i> is the eigenvector output from  
          <a href="#CAPCA">CA S</a>, </li>
      <li><i>eigenvalues.dat</i> is a SPIDER document file showing 
          the percentage of variance accounted for by each factor</li>
      </ul>
   </li>
   <p>
   <li>Generate PostScript file of eigenvalue histogram using gnuplot:
            <b_command>gnuplot <a href="ploteigen.gnu"><i>ploteigen.gnu</i></a></b_command> <br />
       Note: Substitute the number of factors and output PostScript filename at 
           the top of <b><a href="ploteigen.gnu">ploteigen.gnu</b></a>
   </li>
   </p>
</ol>
d378 3
a380 1
<a name="fm"></a><h4><p>Creating Factor Maps to View Groupings, If Any</h4></p>
d383 1
a383 1
   and which are noise, we can see if there are any clear clustering. 
d388 1
a388 2
   Note that to view these maps you must have already run:
   <a href="#CAPCA">CA S</a> first.
d399 1
a399 1
  <li>"File prefix" is the name entered for the "Outputfile prefix" 
d418 7
d438 14
a451 5
<p align=center>
   <a href="save/plot12.gif">Factor 1 vs. Factor 2</a> ---
   <a href="save/plot13.gif">Factor 1 vs. Factor 3</a> ---      
   <a href="save/plot23.gif">Factor 2 vs. Factor 3</a>
</p>
d453 2
a454 7
<p>'CA SM' also works for pixel factor maps (<i>PIX</i>)as well. 
   A common problem when creating a pixel factor map is the 
   "ERROR: *** MAP ABORTED, MORE THAN 264 POINTS ON FRAME" 
   error message. This is because of the large number of points. 
   This can be fixed by increasing the value of 
   ".NUMBER OF SD OR &le;CR&gt;=2.3:". This increases the scale of the 
   factor map. The pixel factor maps below were created from a screen  
d459 14
a472 4
<p align=center>
<a href="save/1vs2pix.gif">Factor 1 vs. Factor 2</a>      ---
<a href="save/1vs3pix.gif">Factor 1 vs. Factor 3</a>      ---  
<a href="save/2vs3pix.gif">Factor 2 vs. Factor 3</a>
d475 1
a475 1
<!-- xxxxxxxxxxxxxx Controlled Hierarchical Clustering xxxxxxxxxxxxxxxxxxxx -->
d478 3
a480 1
<a name="clhc"><h4>Controlled Hierarchical Clustering</h4>
d509 4
a512 2
    invokes 'CL HC' which reads the CA/PCA files from 'CA S' and creates
    dendroram plot files and document files.</p>
d514 2
a515 1
<p>Screen snaphots of the PostScript dendrogram from 'CL HC'
d517 15
a531 5
    and option 5 (Ward's method):
   <div align=center>
      <a href="save/clhc_dend_2.jpg">Complete linkage</a>     ---      
      <a href="save/clhc_dend_5.jpg">Ward's method</a> </div>
   </p>
d534 14
a547 4
   <div align=center>
      <a href="save/clhc_dend_2.dat">Complete linkage doc</a>     ---   
      <a href="save/clhc_dend_5.dat">Ward's method doc</a></div>
   <p />
d553 14
a566 3
  close to the eigenvalue for noise:
  <div align="center" <a href="save/web_clhc_dend_2.jpg">Dendrogram snapshot</a> </div>
</p>
d570 1
a570 1
   <a href="../../man/clhc.html">'CL HC'</a> or
d572 1
a572 1
   a <a href="save/clhc_dend_class.dat">
d576 2
a577 1
   to viewing the dendrogram in <a href="../../../../web/docs/web.html">Web</a>, 
d586 1
a586 1
  (e.g. <a href="save/clhc_dend_class_001.dat">class : 1</a>) ,
d595 15
a609 4
   The class averages are then placed in a
   <a href="save/clhc_class_montage.jpg">montage</a>.
   The images are classified  
   perfectly according to head shape and eye direction.</p>
a610 1
<!-- xxxxxxxxxxxxxx Automatic Clustering and Hierarchical Ascendant.. xxxxxxxxxxxxxxxxxxxx -->
d612 1
a613 1
<a name="hac">
d618 4
a621 2
   of information with minimal loss. Some output of 'CL CLA' can also 
   work with 'CA SM' to produce more meaningful maps.</p>
d623 2
a624 1
<p>'CL CLA' differs from the other clustering operations in that for 
d634 2
a635 1
   cluster, one "level" higher. </p> 
d654 2
a655 2
   <li>"OCCUPANCY LEVEL FOR CLASS CUTTOFF" is the level or elements/images at which
        a class is not included in dendogram. </li>
d657 2
a658 2
   <li>The "DENDROGRAM POSTSCRIPT OUTPUT FILE" plot is useful to show the relationship between 
       clusters/classes.  </li>
d672 2
a673 2
   <a href="save/clcla_dend.jpg">dendrogram plot</a> containing 
    an image of a PostScript dendrogram output. A vertical and horizontal line 
d675 2
a676 1
   reconstruction can be formed for each class with a 'CA SR' comand. 
d679 3
a681 2
   with an increase of the "% cutoff" command. The <i>jpg</i> file was obtained 
   by using screen snapshot. </p>
d683 1
a683 1
  The <a href="save/clcla_results.dat">results</a> file that is 
d692 1
a692 1
<p>K-Means is a method of clustering that devides the data into a 
d697 2
a698 1
   is VERY dependent on which image seeds are the first chosen.</p>
d701 2
a702 2
   images are identical, except the random noise, and the exact 
   number of clusters. The output discussed was obtained with 8 classes, 
d705 2
a706 1
   different noise from other runs discussed in this tutorial)</p>
d708 4
a711 2
<p>The doc file: <a href="save/IMC453doc.dat">IMC453doc.dat</a> was
   produced by a run of 'CL KM' with the above input values with a random seed 
a720 2
<p align="center"><img width="64" height="64" src="save/sca020.gif">
                  <img width="64" height="64" src="save/sca040.gif"></p>
d722 7
a728 2
<p>The doc file: <a href="save/IMC789doc.dat">IMC789doc.dat</a> is a file 
   from a 'CL KM' run exactly same as the previous, except with 
d735 12
a746 9
   the average images for 1-10 and 21-30. </p>
<p align="center"><img width="64" height="64" src="save/sca010.gif">
                  <img width="64" height="64" src="save/sca030.gif"></p>

<p>The doc files: <a href="save/SEQ453doc.dat">SEQ453doc.dat</a> and 
                  <a href="save/PIX453doc.dat">PIX453doc.dat</a> 
   are outputs from 
   'CL KM' being run on the same data as above, but using the <i>SEQ </i> and 
    <i>PIX</i> files, respectively. The PIX453doc.dat file is 95Kb in size. 
d750 2
a751 1
   the PIXELS in eight different classes. </p>
a753 1

d759 1
a759 1
   <li>"RANDOM SEEDSTARTING NUMBER", this should be made a note of, you are supposedly 
d763 1
a763 1
   <li>DOCUMENT FILE,'CL KM' also returns one large file that tells the cluster 
d768 2
a769 1
   invokes 'CL KM' and created class averages for specified number of classes.
d772 1
d774 1
d776 1
a776 1
<a name="recon"><h4>Re-Create Images From Eigenvectors</h4>
d780 3
a782 4
   compression. Below, is an  <a href="save/sma069.jpg">image</a>
   from our sample data set and four 
   seperate reconstructions using the first four eigenvectors. 
   The "halo" of noise and dark corners is a result of the masking 
d784 1
a784 1
   (<a href="face.spi">face.spi</a> and 
d786 2
a787 1
   used to create this data.</p>
d820 4
a823 4
The procedure file: <a href="casr.spi">casr.spi</a> 
invokes 'CA SR' to re-constitute any image, or images, 
from the eigenvectors.</p>

d834 1
a834 1
<p align=center><img width="557" height="350" src="save/40faces.gif"></p>
d837 1
d839 2
a840 2

<a name="virtual"><h4>Create Arbitrary "Virtual" Images From Eigenvectors</h4>
d847 1
d849 1
a849 1
<br/>To choose what values to use for eigenvalues, use the 
d852 2
a853 1
   will be difficult to predict and interpret.</p>
d862 2
a863 1
   that they actually exist, i.e. the factor maps.</p>
d866 5
a870 4
   <img width="64" height="64" src="save/casrv_0-6.gif">
   <img width="64" height="64" src="save/casrv_0-7.gif">
   <img width="64" height="64" src="save/casrv_0-2.gif">
   <img width="64" height="64" src="save/casrv_0-3.gif"></p>
d883 1
a883 1
  was used to create the image below. <br/>
d900 1
a900 1
<p align=center><img src="save/18fade.gif"></p>
d910 2
a911 1
   classify images by.</p>
d923 2
a924 1
file to change them. Example results.</p>
d926 4
a929 4
<p align=center><img width="64" height="64" src="save/eig1.gif">
                <img width="64" height="64" src="save/eig2.gif">
                <img width="64" height="64" src="save/eig3.gif">
                <img                        src="save/eig01to03.jpg"></p>
d932 1
d934 1
a935 1
<a name="diff">
d941 5
a945 4
<p align=center><img width="64" height="64" src="save/avg180.gif">
                <img width="64" height="64" src="save/casrd1_69.gif">
                <img width="64" height="64" src="save/casrd2_69.gif">
                <img width="64" height="64" src="save/casrd3_69.gif"></p>
d962 5
a966 4
<p align=center><img width="64" height="64" src="save/casrd4_19.gif">
                <img width="64" height="64" src="save/casrd5_19.gif">
                <img width="64" height="64" src="save/casrd6_19.gif">
                <img width="64" height="64" src="save/casrd8_19.gif"></p>
d976 4
a979 3
<p align=center><img width="64" height="64" src="save/avg180.gif">
                <img width="64" height="64" src="save/casrd8_19.gif">
                <img width="64" height="64" src="save/addiff.gif"></p>
d995 1
d1024 2
a1025 2
      standout on a factor map (one class inactive, all others active), 
      use <a href="../../man/casm.html">'CA SM'</a> with (S)ymbol option
d1041 28
a1068 7
<p align=center><a href="save/casmireg1.gif">Factor 1 vs. Factor 2</a>     ---
                <a href="save/casmireg2.gif">Factor 1 vs. Factor 3</a>     ---  
                <a href="save/casmireg3.gif">Factor 2 vs. Factor 3</a></p>

<p align=center><a href="save/casmiod1.gif">Factor 1 vs. Factor 2</a>      ---
                <a href="save/casmiod2.gif">Factor 1 vs. Factor 3</a>      ---  
                <a href="save/casmiod3.gif">Factor 2 vs. Factor 3</a></p>
d1071 1
d1073 1
a1074 1
<a name="web">
d1079 1
a1079 1
   using <a href="#hac">CL CLA</a>. Should also work with the output 
d1083 2
a1084 1
   below a threshold, and the number of images in each average.</p>
d1112 2
a1113 3
   invokes 'CL CLA' so that a new dendrogram 
   document file is the only thing created, used to change the 
   lower threshold.<br/>
d1115 1
a1115 1
   The document file: <a href="save/webdendoc.dat">webdendoc.dat</a> 
d1120 3
a1122 2
   can be used to change the extensions of a whole series of images. Should not 
   be a problem if follow hint number three above.</p>
d1125 1
d1131 2
a1132 2
<p>In <a href="../../../../web/docs/web.html">Web</a>
   you view a factor map and select which images are similar 
d1135 4
a1138 2
   a SPIDER document file can be printed to what class each image 
   was placed in. I believe that only images can be used, not pixels. </p>
d1142 1
a1142 1
   <li>Run the <a href="../../man/sdc.html">'SD C'</a> command in SPIDER. </li>
d1151 2
a1152 1
       files and the 'SD C' doc. file should be in the same 
d1180 1
a1180 1
          image. The "overlap" toggle controls where the average is displayed. </li>
d1201 3
a1203 2
<p>The doc. file: <a href="save/sdcout.dat">sdcout.dat</a> is the result of running 
   'SD C' on a <i>_IMC file</i>. It lists the image number and factor co-ordinates 
d1207 5
a1211 3
<p>The image: 
   <a href="save/corrmap.gif">corrmap.gif</a> is a screen-shot of 
   a corr-map run. Note the placement of the average 
d1214 5
a1218 3
   being compared in this factor map, head shape and eye direction.<br/>
   <a href="save/docimg001.dat">docimg001.dat</a> is the 
   file created with the "save images in Doc. file" option. 
d1236 1
a1236 1
 <p></p>
d1244 1
a1244 1
<p></p>
d1250 2
a1251 2
Source:      tutorial.html  &nbsp;&nbsp;&nbsp;  
Last update: 01 Feb 2012    &nbsp;&nbsp;&nbsp;
@


1.5
log
@Updated of usge of eigendoc.py, substituted Gnuplot script for gnu2gif shell script
@
text
@d364 1
a364 1
           the top of <b><a href="ploteigen.gnu"><i>ploteigen.gnu</i></b></a>
@


1.4
log
@?
@
text
@d351 1
a351 1
           <i>name_EIG.*</i> > <i>gnuplot_file</i> </b_command> <br />
d356 2
a357 2
      <li><i>gnuplot_file</i> is a file of gnuplot commands for 
          displaying the histogram.</li>
d361 4
a364 4
   <li>View file of gnuplot commands: 
            <b_command>gnuplot -persist <i>gnuplot_file</i></b_command> <br />
       Note: The gnuplot output can be converted to a <i>gif</i> image
       using: <b_command><a href="gnu2gif">gnu2gif</a></b_command>
d1113 1
a1113 1
Last update: 19 June 2009    &nbsp;&nbsp;&nbsp;
@


1.3
log
@complete rewrite
@
text
@d212 1
a212 1
   contains listing of eigenvectors for each image, pixel, etc..
d255 1
a255 1
	<tr><td>ACT</td>             <td> Transposed flag. </td>
d279 1
d375 1
a375 1
   and which are noise, we can see if there are any clear groupings. 
d414 1
a414 1
   the SPIDER procedure: <a href="casm.spi">casm.spi</a> 
d532 1
a532 1
   The images are grouped 
d549 1
a549 1
   the final grouping is very dependent of what seeds are initially 
d556 1
a556 1
   group, one "level" higher. </p> 
d572 2
a573 2
   <li>"NUMBER OF PARTITIONS" signifies the number of groups 'CL CLA' will 
        initally expect.  </li>
d578 2
a579 2
   <li>The dendrogram plot is useful to show the relationship between 
       groups/classes.  </li>
d582 1
a582 1
       dendrogram to remove excess branches.  </li>
d584 1
a584 1
   <li>The "DENDROGRAM DOC FILE" is used by the 
d587 1
a587 1
       <a href="../../man/clhe.html">'CL HC'</a> and
d595 2
a596 2
    meeting signify the joining of two groups below it. A representitive  
   reconstruction can be formed for each group with a 'CA SR' comand. 
d598 1
a598 1
   groups. The many small differences at the bottom can be eliminated 
d612 1
a612 1
   user defined number of groups. Two random images "seeds" are chosen, 
d620 1
a620 1
   number of groups. The output discussed was obtained with 8 classes, 
d629 1
a629 1
   were all placed in group 6, which is what we expect because they are 
d631 1
a631 1
   the same protoimage grouped together somewhat, except for the last 
d633 1
a633 1
   in the same group, instead of each giving them each their own group. 
d642 3
a644 3
   the correct protoimage group correctly, except for the last few images. 
   But in addition to images 11-20 and 31-40 being grouped together, 
   images 1-10 and 21-30 were placed in the same group as well. This 
d667 1
a667 1
   <li>"NUMBER OF CLASSES" = different groups.</li>
d670 1
a670 1
   <li>"TEMPLATE FILENAME", for each group requested, 'CL KM' outputs a file 
d672 1
a672 1
   <li>DOCUMENT FILE,'CL KM' also returns one large file that tells the group 
d751 1
a751 1
   in between groups.
d896 1
a896 1
   images into active/inactive groups. It appears that this 
d918 1
a918 1
      standout on a factor map (one group inactive, all others active), 
d1003 1
a1003 1
   using a "lasso" interface. Then the average of that group 
d1005 1
a1005 1
   a SPIDER document file can be printed to what group each image 
d1082 1
a1082 1
   order of group it was formed from. This particular group 
@


1.2
log
@merged old tutorial.html with lebarron-index.html and rewrote
@
text
@d3 1
a3 1
<title> Classification and Clustering </title>
a10 1

a15 1

d17 1
a17 1
<h1 align="center">Classification and Clustering</h1>
d28 5
a32 10
   <li><a href="#CAPCA">Correspondence or Principal Component Analysis</a>.</li>

   <li><a href="#histo">Determine what variations are attribute or noise based</a>.</li>
 
   <li><a href="#fm">Create Factor Maps </a>.</li>

   <li><a href="#clhc">Controlled Clustering and Hierarchical Classification</a>.</li>

   <li><a href="#recon">Re-create certain images from eigenvectors</a>.</li>

d34 3
a36 5

   <li><a href="#web">View dendrogram averages & factor (correspondence)
        map averages</a>.</li>

   <li><a href="#ref">References</a>.</li>
d167 1
a167 1
   <li><a href="../../../../web/docs/web.html">WEB</a> Use
d174 1
d179 2
a180 2
<p>SPIDER procedures: <a href="tut_txt/makefaces.bat">makefaces.bat</a> (and 
   the <a href="tut_txt/face.bat">face.bat</a> procedure which it calls) 
d191 1
a191 1
<p align=center><img width="557" height="143" src="tut_images/16faces.gif">
d194 2
a195 1
<hr>
d208 1
a208 1
   The procedure file: <a href="tut_txt/cas.bat">cas.bat</a> invokes the
d210 3
a212 3
   user-defined circular mask. The procedure <i>cas.bat</i> also produces  
   <a href="tut_txt/eigendoc.dat">eigendoc.dat</a> document file which 
   contains listing of eigenvectors for each image, pixel,etc..
d216 1
a216 1
Hints for: <a href="../../man/cas.html">'CA S' </a> <br>
d222 1
a222 1
       more than enough. for our example, but see 
d234 1
a234 1
   <li><a href="tut_txt/control_IMC.dat"><i>*_IMC</i></a> is a text file 
d241 1
a241 1
	<tr><td>NSAM,NROW</td> <td> X and Y values of images, respectively </td>
d252 2
a253 1
	<tr><td>DOR</td>             <td> Distance of the image to the origin of the new vector space</td>
d255 1
d259 1
a259 1
   <li><a href="tut_txt/control_PIX.dat"><i>*_PIX</i></a> is a text file that stores 
d269 1
d282 1
a282 1
   <li><a href="tut_txt/control_EIG.dat">*_EIG</a> is a text file that stores 
d291 1
d300 1
d317 2
a318 2
      <a href="../../../../web/web.html">WEB</a> 
       and only useful internally to other 'CA' operations. 
d323 1
a323 1
    <li>*_SET is a binary file with transposed data. This file is and 
d330 1
a330 1

d333 1
a333 1
<img src="tut_images/ploteigen.gif" align="right">
d336 2
a337 2
<a name="histo"></a>
<h4> Determining What Eigenvalues Are Useful, And What Is Noise</h4>
d340 1
a340 1
   to view a histogram of them. As the histrogram to the right shows, the last 
d349 2
a350 2
      <b_command>python <a href="tut_txt/eigendoc.py">eigendoc.py</a> 
                <i>name_EIG.*</i> > <i>gnuplot_file</i> </b_command> <br />
d363 1
a363 1
       using: <b_command><a href="tut_txt/gnu2gif">gnu2gif</a></b_command>
d368 2
a369 1
<hr \>
d376 1
a376 1
   <a href="../../man/casm.html">CA SM</a> is an operation used to view 
d383 1
a383 1
Hints for: <a href="../../man/casm.html">CA SM</a>
d386 1
a386 1
  <li>Input for: "Image or pixel coordinates" should almost always be "I", 
d394 1
a394 1
  <li>"# of horizontal patches"  Usually zero, UNLESS 
d398 1
a398 1
  <li>"(S)ymbol, (A)ssign symbol, (C)lass, (D)oc, (I)D", 
d400 2
a401 1
  <li>"Postcript file for map" should usually be yes, unless you 
d403 1
a403 1
      <a href="tut_txt/ascii12.dat">ascii12.dat</a>. </li>
d408 1
a408 1
  <li>Everything after "Postscript output file" should generally 
d412 7
a418 5
The procedure file: <a href="tut_txt/casm.bat">casm.bat</a>  
   invokes 'CA SM'. It runs under the assumptions that you 
   want image space with "id's" for a PostScript graph. <br>
The procedure file: <a href="tut_txt/factor.bat">factor.bat</a> runs 
   <i>casm.bat</i> three times,and prints out three PostScript plots.<br>
d420 2
a421 2
<p>The three factor maps below are of images and were created 
    using GNUplot. Postscript files are similar.</p>
d424 4
a427 3
   <a href="tut_images/plot12.gif">Factor 1 vs. Factor 2</a> ---
   <a href="tut_images/plot13.gif">Factor 1 vs. Factor 3</a> ---      
   <a href="tut_images/plot23.gif">Factor 2 vs. Factor 3</a></p>
d429 1
a429 1
<p>'CA SM' also works for pixel factor maps as well. 
d431 1
a431 1
   "*** ERROR: *** MAP ABORTED, MORE THAN 264 POINTS ON FRAME" 
d434 1
a434 1
   ".NUMBER OF SD OR <CR>=2.3:". This increases the scale of the 
d436 1
a436 1
   snapshot. The large numver of pixels located in the 
d440 5
a444 3
<p align=center><a href="tut_images/1vs2pix.gif">Factor 1 vs. Factor 2</a>      ---
<a href="tut_images/1vs3pix.gif">Factor 1 vs. Factor 3</a>      ---  
<a href="tut_images/2vs3pix.gif">Factor 2 vs. Factor 3</a></p>
d446 2
a447 1
<hr>
d451 1
a451 1
<p>The operation <a href="../../man/clcla.html"> CLCLA</a>
d453 1
a453 1
   <a href="../../man/clhc.html">CL HC</a> is more robust because 
d458 1
a458 1
Hints for: <a href="../../man/clhc.html">CL HC</a> 
d460 1
a460 1
   <li>"Coran/PCA file" is the name of the file from 'CA S'. 
d462 1
a462 1
       must include one of these endings to set each kind of file apart.</li> 
d464 1
a464 1
   <li>"Factor Weights" influence the clustering and the dendrograms. 
d468 1
a468 1
   <li>"Clustering Criterion".  Option 5 is the method 'CL CLA' uses.</li>
d470 5
a474 3
   <li>A "Dendrogram Doc file" is used with 
         <a href="../../../../web/docs/web.html">WEB</a> 
         to produce dendrograms with cluster averages.</li>
d477 11
a487 16

<p>The procedure file: <a href="tut_txt/clhc.bat">clhc.bat</a> invokes 'CL HC'.</p>

Factor maps from running 'CL HC': <br />
<div align=center>
   <a href="tut_images/1vs2pix.gif">Factor 1 vs. Factor 2</a>      ---
   <a href="tut_images/1vs3pix.gif">Factor 1 vs. Factor 3</a>      ---  
   <a href="tut_images/2vs3pix.gif">Factor 2 vs. Factor 3</a></div>
</p>

Screen snaphots of the PostScript dendrogram for our "faces" data using 
    clustering option 2 (complete linkage) and option 5 (Ward's method):<br />
<div align=center>
   <a href="tut_images/CLHCdendro02.gif">Complete linkage</a>     ---      
   <a href="tut_images/CLHCdendro05.gif">Ward's method</a> </div>
</p>
d489 5
a493 5
Dendrogram <i>doc</i> files affiliated with the above dendrograms:<br />
<div align=center>
   <a href="tut_txt/clhcdoc02.dat">Complete linkage doc</a>     ---   
   <a href="tut_txt/clhcdoc05.dat">Ward's method doc</a></div>
</p>
d495 2
a496 2
  Screen snapshot of <a href="../../../../web/docs/web.html">WEB</a>
  display of the complete linkage dendrogram. 
d499 2
a500 3
  close to the eigenvalue for noise. <br />

<div align="center" <a href="tut_images/clhcweb2.gif">Dendrogram snapshot</a> </div>
d503 9
a511 4
<p>The operation: <a href="../../man/clhd.html">CL HD</a> is used with output
   from 'CL CLA' and 'CL HC'. It determines how many classes there are and how 
   many images are in each class for a given threshold. It is similar 
   to viewing the dendrogram in <a href="../../../../web/docs/web.html">WEB</a>, 
d513 19
a531 17
   the number of images and the number above each image. 
   The <a href="tut_txt/clhd02.dat">output doc file</a> from
   this operation with a threshold of: 0.15 corresponds exactly 
   with the <a href="../../../../web/docs/web.html">WEB</a> 
   screenshot above.</p>

<p>The operation: <a href="../../man/clhe.html">CL HE</a> is another operation 
   used with output from 'CL HC'. It's purpose is to create 
   lists of the images that 
   are in each class, for a given threshold. To recreate the average image 
   of a given class at a certain threshold, this command will output 
   which images need to be averaged together. The doc files: 
   <a href="tut_txt/clhe201.dat">Clhe201.dat</a> ,
   <a href="tut_txt/clhe202.dat">Clhe202.dat</a> ,
   <a href="tut_txt/clhe203.dat">Clhe203.dat</a> ,
   <a href="tut_txt/clhe204.dat">Clhe204.dat</a> are 
   from a 'CL HE' run with a threshold of 0.5. The images are grouped 
d534 1
d540 2
a541 2
<p>With the "useful" eigenvectors known, we can much more effeciently 
   determine the representitive clusters. This also allows compression 
d545 1
a545 1
<p>CL CLA differs from the other clustering operations in that for 
d554 2
a555 2
    differ the least between each other will be merged and create a new 
    group, one "level" higher. </p> 
d557 1
a557 1
Hints for: <a href="../../man/clcla.html">CL CLA</a> 
d560 2
a561 2
   <li>"File prefix" is the response given for the 
       "output file prefix" question from 'CA S'. </li>
d563 3
a565 3
   <li>"Cluster output file" is the file to use with 'CA SM' to name 
       image points by cluster. Otherwise unreadable by 
       <a href="../../../../web/docs/web.html">WEB</a> or SPIDER.</li>
d568 2
a569 2
       many times the center is moved, and the # of centers is how many 
       points are initially used, per partition. </li>
d571 1
a571 1
   <li>"# of partitions" signifies the number of groups 'CL CLA' will 
d574 2
a575 2
   <li>"% Cutoff" is the difference between groups where the 
        dendogram stops reporting. </li>
d577 2
a578 2
   <li>A dendrogram plot is usually useful. It shows the 
       relationship between groups.  </li>
d580 8
a587 2
   <li>The "cluster.doc file" is used by the <a href="../../../../web/docs/web.html">WEB</a> 
        dendrogram program </li>
d590 5
a594 4
<p>The file: <a href="tut_images/dendro.gif">dendro.gif</a> contains
    an image of 
   a PostScript dendrogram output. A vertical and horizontal line 
   meeting signify the joining of two groups below it. A representitive 
d597 2
a598 2
   groups. The many small difference at the bottom can be eliminated 
   with an increase of the "% cutoff" command. The <i>gif</i> file was obtained 
d601 1
a601 1
  The <a href="tut_txt/caclaResults">results</a> file that is 
d605 2
a606 1
<hr \>
d621 2
a622 1
   three factors.</p>
d624 1
a624 1
<p>The doc file: <a href="tut_txt/IMC453doc.dat">IMC453doc.dat</a> was
d635 2
a636 2
<p align="center"><img width="64" height="64" src="tut_images/sca020.gif">
                 <img width="64" height="64" src="tut_images/sca040.gif"></p>
d638 1
a638 1
<p>The doc file: <a href="tut_txt/IMC789doc.dat">IMC789doc.dat</a> is a file 
d647 2
a648 2
<p align="center"><img width="64" height="64" src="tut_images/sca010.gif">
                 <img width="64" height="64" src="tut_images/sca030.gif"></p>
d650 3
a652 2
<p>The doc files: <a href="tut_txt/SEQ453doc.dat">SEQ453doc.dat</a> and 
   <a href="tut_txt/PIX453doc.dat">PIX453doc.dat</a> are outputs from 
d655 1
a655 1
   The results for the  <i>SEQ</i> run should be the same reuslt as the 
d660 1
a660 1
Hints for: <a href="../../man/clkm.html">CL KM</a> 
d663 1
a663 1
   <li>"Coran/PCA file" must be the FULL name of the file you want 
d666 2
a667 2
   <li>"Number of classes" = different groups.</li>
   <li>"Random number", this should be made a note of, you are supposedly 
d669 1
a669 1
   <li>For each group requested, 'CL KM' outputs a file 
d671 1
a671 1
   <li>'CL KM' also returns one large file that tells the group 
d675 2
a676 3
<p>The procedure file: <a href="tut_txt/clkm.bat">clkm.bat</a>  
   invokes 'CL KM'. It places all its output in a directory named with 
   the random number used.
d678 2
a679 1
<hr>
d685 3
a687 2
   compression. Below, is a image from our sample data set and four 
   seperate reconstructions from the first four eigenvectors. 
d689 4
a692 10
   function in the procedure files used to create this data.
   (<a href="tut_txt/face.bat">face.bat</a> and 
    <a href="tut_txt/makefaces.bat">makefaces.bat</a>)</p>

<p align =center>
<img width="64" height="64" src="tut_images/sma069.gif">
<img width="64" height="64" src="tut_images/casrF01out_069.gif">
<img width="64" height="64" src="tut_images/casrF02out_069.gif">
<img width="64" height="64" src="tut_images/casrF03out_069.gif">
<img width="64" height="64" src="tut_images/casrF04out_069.gif"></p>
d694 3
a696 1
<p>It is difficult to see what traits it has because of noise. 
d701 1
a701 1
   Threfore the fourth carries only noise </p>
d704 1
a704 1
   first three eigenvectors combined. The image is from the seventh 
d707 1
a707 4
<p align =center>
   <img width="64" height="64" src="tut_images/sma069.gif">
   <img width="64" height="64" src="tut_images/casrF1_3out_069.gif">
</p>
d709 1
a709 1
Hints for: <a href="../../man/casr.html">CA SR</a> 
d712 1
a712 1
   <li>"File prefix" is the response given for the "output file prefix" 
d715 1
a715 1
   <li>"File #'s to be used" = file numbers of images.</li>
d717 1
a717 1
   <li>"Factors to be used" stands for which factors to be 
d720 1
a720 1
   <li>"Output file template" needs at least one <i>*</i> at the end 
d725 1
a725 1
The procedure file: <a href="tut_txt/casr.bat">casr.bat</a> 
d729 1
d739 1
a739 1
<p align=center><img width="557" height="350" src="tut_images/40faces.gif"></p>
d741 2
a742 1
<hr>
d746 1
a746 1
<p>The operation: <a href="../../man/casra.html">CA SRA</a>
d752 1
a752 1
<br>To choose what values to use for eigenvalues, use the 
d766 5
a770 4
<p align=center><img width="64" height="64" src="tut_images/casrv_0-6.gif">
<img width="64" height="64" src="tut_images/casrv_0-7.gif">
<img width="64" height="64" src="tut_images/casrv_0-2.gif">
<img width="64" height="64" src="tut_images/casrv_0-3.gif"></p>
d772 1
a772 1
Hints for: <a href="../../man/casra.html">CA SRA</a> 
d780 18
a797 19
<p>The procedure file: <a href="tut_txt/casra.bat">casra.bat</a> 
   invokes 'CA SR'. <br>

The procedure file: <a href="tut_txt/casramontage.bat">casramontage.bat</a> 
was used to create the image below.<br>

The virtual images are created by changing only one 
eigenvalue at a time from -0.2 to 0.2 at regular intervals. 
The top row is eigenvalue one, and the bottom row 
eigenvalue three. Along each row all other eigenvalues 
were held to zero. The center column is identical 
because it is at this point that the varrying 
eigenvalues are equal to zero. Reconstitution with all 
eigenvalues set to zero is equivalent to reconstiting 
the average of the series. If reconstitution of each 
indiviual eigenvalue had progressed to one, the result 
would be the first three images directly above. 
Reconstitution of the three eigenvalues together will result 
in the fourth image above.
d800 1
a800 1
<p align=center><img src="tut_images/18fade.gif"></p>
d802 1
d807 4
a810 4
<p>The operation:  <a href="../../man/casre.html">CA SRE</a>
creates eigenimages from 'CA S' outputs. With eigenimages, the user can easily 
see what the computer has determined as the factors to 
classify images by.</p>
d812 1
a812 1
Hints for: <a href="../../man/casre.html">CA SRE</a> 
d814 1
a814 1
<li>None, ss the manual page.</li>
d817 1
a817 1
<p>The procedure file:<a href="tut_txt/casre.bat">casre.bat</a> 
d824 4
a827 4
<p align=center><img width="64" height="64" src="tut_images/eig1.gif">
                <img width="64" height="64" src="tut_images/eig2.gif">
                <img width="64" height="64" src="tut_images/eig3.gif">
                <img width="64" height="64" src="tut_images/eig1to3.gif"></p>
d829 2
a830 1
<hr>
d835 1
a835 1
<p> Use <a href="../../man/casrd.html">CA SRD </a> 
d838 4
a841 4
<p align=center><img width="64" height="64" src="tut_images/avg180.gif">
                <img width="64" height="64" src="tut_images/casrd1_69.gif">
                <img width="64" height="64" src="tut_images/casrd2_69.gif">
                <img width="64" height="64" src="tut_images/casrd3_69.gif"></p>
d850 1
a850 1
   the fourth image this image has a wide mouth . <br>
d852 1
a852 1
<br>Below are the seperate difference eigenimages for another 
d858 4
a861 4
<p align=center><img width="64" height="64" src="tut_images/casrd4_19.gif">
                <img width="64" height="64" src="tut_images/casrd5_19.gif">
                <img width="64" height="64" src="tut_images/casrd6_19.gif">
                <img width="64" height="64" src="tut_images/casrd8_19.gif"></p>
d871 3
a873 3
<p align=center><img width="64" height="64" src="tut_images/avg180.gif">
                <img width="64" height="64" src="tut_images/casrd8_19.gif">
                 <img width="64" height="64" src="tut_images/addiff.gif"></p>
d875 1
a875 1
<p>Hints for: <a href="../../man/casrd.html">CA SRD </a></p> 
d878 1
a878 2
   <li>"prefix" is the base name before <i>_SEQ, _IMC, _PIX,</i> etc.</li>

a879 1

d883 1
a883 1
<p>The procedure file: <a href="tut_txt/casrd.bat">casrd.bat</a> invokes
d885 1
a885 1
   <a href="tut_txt/casr.bat">casr.bat</a> except for minor changes. 
d888 2
a889 1
<hr>
d893 1
a893 1
<p> Use <a href="../../man/casmi.html">CA SMI </a> 
d903 1
a903 1
<p>Hints for: <a href="../../man/casmi.html">CA SMI </a></p> 
d918 1
a918 1
      use <a href="../../man/casm.html">CA SM</a> with (S)ymbol option
d922 1
a922 2
<p>The procedure file: <a href="tut_txt/casmi.bat">casmi.bat</a> 
   invokes 'CA SMI'. <br>
d934 7
a940 7
<p align=center><a href="tut_images/casmireg1.gif">Factor 1 vs. Factor 2</a>      ---
                <a href="tut_images/casmireg2.gif">Factor 1 vs. Factor 3</a>      ---  
                <a href="tut_images/casmreg3.gif">Factor 2 vs. Factor 3</a></p>

<p align=center><a href="tut_images/casmiod1.gif">Factor 1 vs. Factor 2</a>      ---
                <a href="tut_images/casmiod2.gif">Factor 1 vs. Factor 3</a>      ---  
                <a href="tut_images/casmod3.gif">Factor 2 vs. Factor 3</a></p>
d942 2
a943 1
<hr /> 
d946 1
a946 2
<h4>View Dendrogram In 
      <a href="../../../../web/docs/web.html">WEB</a></h4>
d948 1
a948 1
<p><a href="../../../../web/docs/web.html">WEB</a>
d952 1
a952 1
   <a href="../../../../web/docs/web.html">WEB</a> will display 
d956 1
a956 1
How To Use The <a href="../../../../web/docs/web.html">WEB</a> Dendrogram 
d958 1
a958 3
   <li>Run 'CL CLA' (or 'CL HC'), and request a cluster doc file. The doc. 
       file will use the minimum threshold as it's lowest value. 
       Any information below this will be lost. </li>
d960 1
a960 1
   <li>Make sure that your image files and <i>dendro doc file</i> have 
d963 2
a964 2
   <li>Start <a href="../../../../web/docs/web.html">WEB</a> with your extension 
       (i.e."<a href="../../../../web/docs/web.html">WEB</a> dat &") and select 
d972 1
a972 1
       variation that was carried over from the 'CL CLA' operation is 
d975 1
a975 1
   <li>If the "show average images" option is selected, WEB will 
d981 1
a981 1
<p>The procedure file: <a href="tut_txt/webdendro.bat">webdendro.bat</a>  
d984 1
a984 1
   lower threshold.<br>
d986 3
a988 2
The document file: <a href="tut_txt/webdendoc.dat">webdendoc.dat</a> 
   is an example of a dendrogram document file. <br>
d990 3
a992 3
<p>The procedure file: <a href="tut_txt/numbers.bat">numbers.bat</a> is a procedure file 
   to change the extensions of a whole series of images. Should not 
   be a problem if follow number three above.</p>
d994 2
a995 1
<hr>
d998 1
a998 1
    <a href="../../../web/docs/web.html">WEB</a> and Compute Averages</h4>
d1000 1
a1000 1
<p>In <a href="../../../../web/docs/web.html">WEB</a>
d1007 1
a1007 1
How To Use The <a href="../../../../web/docs/web.html">WEB</a> Factor Map
d1009 1
a1009 1
   <li>Run the <a href="../../man/sdc.html">SD C</a> command in SPIDER. </li>
d1011 1
a1011 1
   <li>Start <a href="../../../../web/docs/web.html">WEB</a>
d1013 1
a1013 1
       (i.e."<a href="../../../../web/docs/web.html">WEB</a> dat &") 
d1021 1
a1021 1
   <li>In <a href="../../../../web/docs/web.html">WEB</a>, 
d1025 1
a1025 1
   <li>When you "accept", a <a href="../../../../web/docs/web.html">WEB</a> 
d1067 1
a1067 1
<p>The doc. file: <a href="tut_txt/sdcout.dat">sdcout.dat</a> is the result of running 
d1072 2
a1073 1
<p>The image: <a href="tut_images/corrmap.gif">corrmap.gif</a> is a screen-shot of 
d1075 1
a1075 1
   images. The upper-right image is overlaped with it's 
d1077 2
a1078 2
   being compared in this factor map, head shape and eye direction.<br>
   <a href="tut_txt/docimg001.dat">docimg001.dat</a> is the 
d1086 1
d1111 2
a1112 2
Source:      class-tutorial.html  &nbsp;&nbsp;&nbsp;  
Last update: 15 Dec. 2008    &nbsp;&nbsp;&nbsp;
@


1.1
log
@Initial revision
@
text
@d3 1
a3 1
   <title> Automatic Classification/Clustering </title>
d6 9
d17 37
a53 1
<h2>Classification and Clustering</h2>
d55 12
d69 115
a183 48
<table border=1 cellpadding=4 cellspacing=2>
<tr><th>Table of Contents</th><th>SPIDER operation</th></tr>
<tr>
<td><a href="#CAPCA">Correspondence Analysis or Principal Component Analysis</a></td>
<td align="center"><a href="../../man/cas.html">CA S</a></td>
</tr>
<tr>
<td><a href="#histo">Eigenvalues</a> : determine what variations 
are attribute or noise based</td><td>view with Gnuplot</td>
</tr>      
<tr>
<td><a href="#fm">Factor Maps</a></td>
<td align="center"><a href="../../man/casm.html">CA SM</a></td>
</tr>
<tr>
<td><a href="#clhc">Clustering and Hierarchical Classification</a></td>
<td align="center"><a href="../../man/clhc.html">CL HC</a></td>
</tr>
<tr>
<td><a href="#recon">Reconstitute images from eigenvectors</a></td>
<td align="center"><a href="../../man/casr.html">CA SR</a></td>
</tr>
<tr>
<td><a href="#virtual">Create "virtual" images from eigenvectors</a></td>
<td align="center"><a href="../../man/casr.html">CA SR</a></td>
</tr>
<tr>
<td><a href="#diff">Difference images</a></td>
<td align="center"><a href="../../man/casrd.html">CA SRD</a></td>
</tr>
<tr>
<td><a href="#web">Dendrograms</a></td> 
<td align="center">View in <a href="../../../../web/docs/web.html">WEB</a></td>
</tr>
<tr>
<td><a href="#casmi">Subgrouping images</a></td> 
<td align="center"><a href="../../man/casmi.html">CA SMI</a></td>
</tr>
<tr>
<td><a href="#casre">Viewing Eigenimages</a></td> 
<td align="center"><a href="../../man/casre.html">CA SRE</a></td>
</tr>
<tr>
<td><a href="#casra">Reconstitute Arbitary (Virtual) Images</a></td> 
<td align="center"><a href="../../man/casra.html">CA SRA</a></td>
</tr>
<tr><td><a href="#ref">References</a></td><td> </td></tr>
</table>
d185 17
d204 20
a223 1
<h4>Automatic Classification/Clustering -- General Steps</h4>
a224 1
Create Orthogonal Vectors
d226 8
a233 5
   <li>Run CA S
   <ul>
      <li>does either PCA or CA analysis
      <li>create data files that are input to everything else
   </ul>
d235 9
d245 126
a370 1
Determine What Factors Are Important
d372 14
d387 23
a409 2
<li>Histogram
<li>CA SM - show vector map of data, either images or pixels
d412 32
a443 1
Cluster & Classification
d445 8
d454 31
a484 17
   <li>CL HC - I believe currently only images. uses various cluster methods, 
       makes dendrogram plot to use with WEB for dendrogram & corr-map
       <ol>
          <li>single linkage
          <li>complete linkage
          <li>average linkage
          <li>centroid method
          <li>Ward's method
       </ol>
   <li>CL HD - only after CL HC counts number of classes and images in each class, 
       for a given threshold
   <li>CL HE - only after CL HC, Creates doc files describing which images in 
       each class,  for a given threshold. 
   <li>CL CLA - for either pixels or images. compares tables of K-means runs, 
       then builds up with HAC, creates dendrogram plot
   <li>CL KM - uses the K-means method of clustering, no classification
</ul> 
d486 63
a548 1
View Images
d550 22
a571 5
   <li>CA SR - Reconstitute images from eigenvalues & create "virtual" image 
        from arbitrary eigenvector values 
   <li>CA SRD - Reconstitute Differential images
   <li>CA SRE - Reconstitute eigenimages
   <li>CA SRI - Reconstitute importance images
d574 68
a641 1
WEB Tricks
d643 10
a652 2
   <li>View Dendrogram and average images, for a given threshold
   <li>View the factor map/create average images regardless of class
d655 4
d661 41
a701 1
<h4 align="left">Source Data</h4>
d703 2
a704 9
<p><a href="WebText/makefaces.bat">Makefaces.bat</a> and <a
href="WebText/face.bat">face.bat</a> were used to create the eight
original faces below.  The faces differ in three ways: oval vs. round
head, left vs. right eyes, and big vs.  small mouth. Ten copies of each
face with random noise created the sample data set.  These procedure files
create four kinds of files. Scr* files are the face templates, seen
here.  Sma* files are the noise-filled data set, example below. Sca*
files carry the average of the ten noise images for each template, and
scv* hold the variance for each template.</p>
d706 3
a708 1
<p align=center><img width="557" height="143" src="WebImage/16faces.gif"><br></p>
d710 13
a722 1
<hr>
d724 1
a724 2
<p><a name="CAPCA"></a><h4>Correspondence Analysis(CA) or 
   Principal Component Analysis(PCA)</h4></p> 
d726 1
a726 57
<p>CA is the prefered method of
finding variations and we will principally be discussing inter-image
variance. PCA computes the distance between data vectors with Euclidean
distances. While CA uses Chi-squared distance. This is superior because
it ignores differences in exposure between images, eliminating the need
to rescale between images.<br> <a href="WebText/cas.bat">Cas.bat</a> is
a procedure file that runs the CA S command. The procedure file assumes you
prefer CA and creates a user-defined circular mask. Cas.bat also
creates <a href="WebText/eigendoc.dat">eigendoc.dat</a></p>

<p><a href="http://www.wadsworth.org/spider_doc/spider/docs/man/cas.html">CA S </a> Hints<br>

<ul>
   <li>The "number of factors" value should be larger than the expected
       number of variations.  This is to see the characteristic slope
       of noise after the "useful" eigenvalues. Typically 10 should be
       more than enough.

   <li>"Output file prefix" names all output files. A "Control" entry will result in 
      "Control_SEQ", "Control_IMC, etc.
</ul>

Description of Output Files (links lead to output from faces example)
<ul>
   <li>*_SEQ in a binary file that stores the selected pixel values from all the 
      images. Pixels are selected with the mask option in CA S. This file is NOT 
      viewable in WEB and only useful to other operations. 
      <br>

   <li><a href="WebText/control_IMC.dat">*_IMC</a> is a text file that stores the 
     coordinates of each IMAGE in the new vector space. The contents on the first line are:
      <ol>
	<li>NUMIM = # of images included in analysis
	<li>NFAC = # of factors requested,entry to "number of factors" question
	<li>NSAM,NROW = X and Y values of images, respectively
	<li>PCA = 1 if PCA analysis was used, 0 if CA 
      </ol>

   There is a line for each image included. The outputs for this are:
      <ol> 
	 <li>IMAGE(#)...NFAC) = the coordinates for each image, in the vector space. 
             The number of entries depend on how many factors were requested.
	 <li>WEIGHTP = the relative weight of each image, = # of pixels in this image/# 
             of pixels in all images
	 <li>DOR = distance of the image to the origin of the new vector space
	 <li>FIM = the # of the image. The first, 32nd, etc.
      </ol> <br>

<li><a href="WebText/control_PIX.dat">*_PIX</a> is a text file that stores 
    the coordinates of each PIXEL. Very similar to *_IMC. The contents on the 
    first line are:
   <ol>
      <li>NPIX = # of pixels included in each image, determined by the mask
      <li>NFAC = same as *_IMC
      <li>NSAM,NROW = same as *_IMC
      <li>NUMIM = same as *_IMC
   </ol>
d728 1
a728 1
There is a line for each pixel included. The outputs for this are:
d730 24
a753 7
   <ol> 
      <li>PIXEL(#)...NFAC) = the coordinates for each pixel, in the vector space. 
            The number of entries depend on how many factors were requested.
      <li>WEIGHTP = the relative weight of each pixel
      <li>CO = distance of the pixel to the origin of the new vector space
      <li>FPIX = the # of the pixel. The first, 32nd, etc.
   </ol> <br>
d755 7
a761 7
<li><a href="WebText/control_EIG.dat">*_EIG</a> is a text file that stores the 
       eigenvector values. The contents on the first line are:
   <ol>
      <li>NFAC = same as *_IMC
      <li>TOTAL WEIGHT = the sum of all the pixels used. Not the # of them. 
      <li>TRACE = sum of the diagonal of the eigenvector array
   </ol>
d763 2
a764 8
There is a line for each factor requested. The outputs for this are: 
   <ol>
      <li>EIGENVALUE = the eigenvalue, listed largest first. 
      <li>% = the % of the total interimage variance this eigenvalue is responsible for.
      <li>CUMULATIVE % = a running tally of how much interimage variance is 
          accounted for by eigenvalues
   </ol>
   <br>
d766 2
a767 3
   <li>*_MAS is the SPIDER image file is a circular mask created by the 
       procedure file. The mask must be made before the CA S run, if one is used.<br>
</ol>
d769 14
a782 1
<h4>NOTE: CA S format has <a href="#feb04">changed</a></h4>
d784 1
a784 1
<hr>
d786 1
a786 2
<a name="histo"></a>
<h4><p>Determining Useful Eigenvalues</h4>
d788 1
a788 5
<p>Display the eigenvalues as a histogram to see which ones contain useful 
   information. The histogram below shows most information is contained 
   in the first three eigenvalues, indicating they represent most of the 
   inter-image variance. The last five eigenvalues are small and level, 
   which is typical of noise.</p>
d790 4
a793 4
<img src="WebImage/ploteigen.gif">
<br>
<p>
To create an Eigenvalue histogram :</p>
d795 1
d797 14
a810 9
<li>
Download <a href="WebText/eigenhist.py">eigenhist.py</a>, 
and run the command: <br>
   &nbsp;&nbsp;&nbsp;&nbsp;<b><code>python eigenhist.py xxx_EIG.ext 
  [output_docfile] > gnuplot_file</code></b><br>
where <ul>
<li><code>xxx_EIG.ext</code> is the output from  <a href="#CAPCA">CA S</a>, </li>
<li><code>output_docfile</code> is a doc file of eigenvalues as percentages (this argument is optional - the default value is <code>eigenhist.doc</code>)</li>
<li><code>gnuplot_file</code> is a file of gnuplot commands for displaying the histogram.</li></ul>
d812 1
a812 2
<li>View the file of gnuplot commands:<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b><code>gnuplot -persist gnuplot_file</code></b>
d814 2
d817 2
a818 2
<br>The gnuplot image can be converted to a gif file with <a href="WebText/gnu2gif">gnu2gif</a> </li>
</ul>
d820 36
a855 1
<hr><a name="fm"></a><h4><p>Creating Factor Maps to View Groupings, If Any</h4></p>
d857 1
a857 4
<p>With it known which eigenvectors that have some meaning and which
   are noise, we can see if there are any clear groupings.  CA SM is the
   operation used to view 2D factor maps (graphs) of selected eigenvalues.
   To view these maps <a href="#CAPCA">CA S</a> MUST be run first.</p>
a858 1
<a href="../../man/casm.html">CA SM</a> Hints
d860 5
a864 11
   <li>"image or pixel coordinates" should almost always be "I", unless 
      you are interested in "the images changing around the pixels". This also determines if 
      CA SM will read *_PIX or *_IMC.
   <li>"file prefix" is the value entered for the "outputfile prefix" from CA S
   <li>"# of horizontal patches" ?
   <li>"SACDI" "I" is typically the best choice. All options except "doc" were 
      tried and worked for images. ID is known to work for pixels.
   <li>"postcript file for map" should usually be yes, unless you prefer an ASCII 
      map like <a href="WebText/ascii12.dat">ascii12.dat</a>.
   <li>Flip #1 exchanges the map left-right. Flip #2 exchanges up-down.
   <li>Everything after "POSTSCRIPT OUTPUT FILE" should generally be left alone. 
d867 8
a874 5
<a href="WebText/casm.bat">Casm.bat</a> is a procedure file that automates
   calling CA SM. It runs under the assumptions that you want image space
   with id's on a PostScript graph. <br> 
   <a href="WebText/factor.bat">Factor.bat</a> runs casm.bat three times,and
   prints out three PostScript plots.<br>
d876 9
a884 2
<p>The three factor maps below are of images and were created using 
    GNUplot. Postscript files are similar.</p>
d886 1
a886 80
<p align=center>
          <a href="WebImage/plot12.gif">Factor 1 vs. Factor 2</a>
      --- <a href="WebImage/plot13.gif">Factor 1 vs. Factor 3</a>
      --- <a href="WebImage/plot23.gif">Factor 2 vs. Factor 3</a></p>

<p>CA SM is also known to work for pixel factor maps as well. A common 
   problem when creating a pixel factor map is the 
   "*** ERROR: *** MAP ABORTED, MORE THAN 264 POINTS ON FRAME" error message. 
  This is because of the large number of points. This can be fixed by increasing 
  the value of ".NUMBER OF SD OR <CR>=2.3:". This increases the scale of the factor map. 
  The pixel factor maps below were created using the IRIX snapshot command. The large amount 
   of pixels located in the center show that most pixels very little if at 
   all between eigenvectors. </p>

<p align=center><a href="WebImage/1vs2pix.gif">Factor 1 vs. Factor 2</a>      ---
                <a href="WebImage/1vs3pix.gif">Factor 1 vs. Factor 3</a>      ---  
                <a href="WebImage/2vs3pix.gif">Factor 2 vs. Factor 3</a></p>

<hr><a name="clhc"><h4>Controlled Hierarchical Clustering</h4>

<h4>Optimization <a href="#feb04">NOTE</a></h4>

<p>CL CLA is limited in that it only uses Diday's and Ward's methods. CL HC is 
   more robust because the user controls the clustering criterion and can alter 
   the "weights" for each factor. To best represent the "truth" set all factor 
   weights equal to each other. It has been tested with only _IMC files produced 
   with CORAN analysis.</P>

<a href="../../man/clhc.html"> CLHC</a> Help
<ul>
   <li>CORAN/PCA file is the name of the file from CA S. CL HC can accept _IMC, _SEQ, 
       or _PIX files. So this entry must include one of these endings to set each 
       kind of file apart. 
   <li>Factor Weights influence the clustering and the dendrograms. The larger the 
       weight, the more importance a factor has as compared to the other factors. 
    Zero sets all the rest of the factors to 1.0
   <li>Clustering Criterion. Exactly as on the manual page. Option 5 is 
       the method CL CLA uses.
   <li>Dendrogram Doc file is used with WEB to produce dendrograms with 
       cluster averages.
</ul>


<p><a href="WebText/clhc.bat">Clhc.bat</a> is a procedure file used to automate running CL HC.<br>
<a href="WebImage/CLHCdendro02.gif">CLHCdendro02.gif</a> and 
<a href="WebImage/CLHCdendro05.gif">CLHCdendro05.gif</a> 
are IRIX snaphots of the PostScript dendrogram of the face data using 
clustering option 2 (complete linkage) and option 5 (Ward's method), 
respectively.<br>

<a href="WebText/clhcdoc02.dat">Clhcdoc02.dat</a> and 
<a href="WebText/clhcdoc05.dat">Clhcdoc05.dat</a> are 
the dendrogram .doc files affiliated with the above dendrograms.<br>

<a href="WebImage/clhcweb2.gif">Clhcweb2.gif</a> is a screenshot of 
WEB displaying the complete linkage dendrogram. Note that all of the 
images are properly seperated by their head shape and eye direction. 
Mouth size is not so clear because it's eigenvalue is close to the 
eigenvalue for noise.</p>

<p><a href="../../man/clhd.html">CL HD</a> 
is a operation to be used with CL HC. It determines how many classes there are and 
how many images are in each class for a given threshold. It is similar to viewing 
the dendrogram in WEB, setting a threshold, and recording the number of images 
and the number above each image. <br>
<a href="WebText/clhd02.dat">Clhd02.dat</a> is the result of a CL HD run set at 0.15 
threshold using clhcdoc02.dat as input. It corresponds exactly with the WEB 
screenshot above.</p>

<p><a href="../../man/clhe.html">CL HE</a> 
   is another operation it be used after CL HC. It's purpose is to create lists of the 
   images that are in each class, for a given threshold. To recreate the average 
   image of a given class at a certain threshold, this operation will output which 
   images need to be averaged together. <br>
   <a href="WebText/clhe201.dat">Clhe201.dat</a> ,
   <a href="WebText/clhe202.dat">Clhe202.dat</a> ,
   <a href="WebText/clhe203.dat">Clhe203.dat</a> ,
   <a href="WebText/clhe204.dat">Clhe204.dat</a> 
   are output files from a CL HE run with a threshold of 0.5. 
   The images are grouped perfectly according to head shape and eye direction.</p>
d888 2
a889 1
<hr><h4>Automatic Clustering and Hierarchical Ascendant Classifications (HAC)</h4>
d891 13
a903 122
<a name="hac">
<p>With the "useful" eigenvectors known, we can much more effeciently determine 
   the representitive clusters. This also allows compression of information with 
   minimal loss. Some output of CL CLA can also work with CA SM to produce more 
   meaningful maps.</p>

<p>CL CLA differs from the other clustering operations in that for clustering 
   it uses Diday's method, and for HAC it uses only Ward's criterion. A disadvantage 
   of the K-means method is that the final grouping is very dependent of what seeds 
   are initially chosen. Diday surpassed this by appplying the K-means technique 
   multiple times with different seeds. Then, cross-tabuluating the results, and 
   using only the clusters that were repeatedly formed. Ward's criterion states 
   that merging HAC clusters should be focused on minimizing the added interclass 
   variance. The two clusters that differ the least between each other will be 
   merged and create a new group, one "level" higher. </p> 

<a href="../../man/clcla.html">CL CLA</a> Hints

<ul>
   <li>CL CLA may only work with image, not pixel, data. 
   <li>"file prefix" is the response given for the "output file prefix" 
       question from CA S
   <li>"cluster output file" is the file to use with CA SM to name image 
       points by cluster. Otherwise unreadable by WEB or SPIDER
   <li>CL CLA uses the "moving center" method. Iterations are how many times 
       the center is moved, and the # of centers is how many points are 
       initially used, per partition. (correct??)
   <li>"# of partitions" signifies the number of groups CL CLA will initally expect. 
   <li>"% cutoff" is the difference between groups where the dendogram stops reporting
   <li>A dendrogram plot is usually useful. It shows the relationship between groups. 
   <li>The cluster.doc file is used by the WEB dendrogram program</ul>

<p><a href="WebImage/dendro.gif">Dendro.gif</a> is a .gif conversion of a 
   PostScript dendrogram output. A vertical and horizontal line meeting signify 
   the joining of two groups below it. A representitive reconstruction can be formed 
   for each group with a CA SR comand. The larger vertical bars signify a greater 
   difference between groups. The many small difference at the bottom can be 
   eliminated with an increase of the "% cutoff" command. The .gif file was obtained 
   by using the IRIX snapshot command. </p>

The <a href="WebText/caclaResults">results.bat.* </a>files that are formed after 
   every SPIDER run also hold a large amount of information after a CA CLA run. 
   The useful information begins after line 93 "OPENED (SU):"</p>

<hr><h4>Examination Of K-Means Clustering</h4>

<p>K-Means is a method of clustering that devides the data into a user defined 
   number of groups. Two random images "seeds" are chosen, and their centers of 
   gravity are computed. A partition is drawn down the middle between the centers, 
   the new centers of gravity are computed, and the process is repeated for a 
   given number of times. The final result is VERY dependent on which image 
   seeds are the first chosen.</p>

<p>Because our faces data set is manufactured. We know exactly which images 
   are identical, except the random noise, and the exact number of groups. 
   The output discussed was obtained with 8 classes, using factors 1-3, and 
   an even factor weight of 1.0 between those three factors.</p>

<p><a href="WebText/IMC453doc.dat">IMC453doc.dat</a> is the summary 
   file of a run of CL KM with the above input values with a random 
   seed number of 453. The third column describes the image number and 
   the fourth column is the class that CL KM placed the image in. 
   Images 1-10 were all placed in group 6, which is what we expect because 
   they are all noisy images of the same protoimage. CL KM kept the images 
   from the same protoimage grouped together somewhat, except for the last 
   ten images. However, it prefered to place images 11-20 and 31-40 in the 
   same group, instead of each giving them each their own group. The average 
   image for images 11-20 and 31-40 are shown below. They differ by their 
   mouth size. </p>

<p align =center><img width="64" height="64" src="WebImage/sca020.gif">
<img width="64" height="64" src="WebImage/sca040.gif"></p>

<p><a href="WebText/IMC789doc.dat">IMC789doc.dat</a> is the file from a 
   CL KM run with the exact same as the previous, except with a random 
   number of 789. Once again, most images were placed into the correct 
   protoimage group correctly, except for the last few images. But in 
   addition to images 11-20 and 31-40 being grouped together, images 
   1-10 and 21-30 were placed in the same group as well. This clearly 
   demonstrates that K-means is highly dependent on the first image 
   chosen, and should be used with extreme caution. Below are the 
   average images for 1-10 and 21-30. </p>
<p align =center><img width="64" height="64" src="WebImage/sca010.gif">
<img width="64" height="64" src="WebImage/sca030.gif"></p>

<p><a href="WebText/SEQ453doc.dat">SEQ453doc.dat</a> and 
   <a href="WebText/PIX453doc.dat">PIX453doc.dat</a> are outputs 
   of CL KM being run on the same data as above, but the SEQ and 
   PIX files, respectively. The PIX453doc.dat file is 95Kb in size. 
   The results for the SEQ run should be the same reuslt as the 
   previous runs, because it is still comparing images. However, 
   the PIX results are expected to be different because it is trying 
   to place the PIXELS in eight different classes. </p>

<a href="../../man/clkm.html">CL KM</a> Hints
<ul>
   <li>"coran/pca file" must be the FULL name of the file you want to use
      (minus .dat), this is because it can take SEQ, PIX or IMC files
   <li>classes = different groups
   <li>random number, this should be made a note of, you are supposedly able 
      to re-create runs with the same data and random number.
   <li>for each group requested, CL KM outputs a file with this prefix
   <li>CL KM also returns one large file that tells the group assigned 
      for each image/pixel used.
</ul>

<p><a href="WebText/clkm.bat">Clkm.bat</a> is a procedure file that
automates CL KM. It also places all outputs in a folder named with the
random number used.

<hr><a name="recon"><h4>Re-Create Images From Eigenvectors</h4>

<h4>Some new operations have been added that may be better, see <a href="#feb04">here</a></h4>

<p>Re-creation of sample images from eigenvectors can eliminate the
noise in the reconstituted image, this also results in large data
compression. Below, is a image from our sample data set and four
seperate reconstructions from the first four eigenvectors. The "halo"
of noise and dark corners is a result of the masking function in the
procedure files used to create this data.(<a
href="WebText/face.bat">face.bat</a> and <a
href="WebText/makefaces.bat">makefaces.bat</a>)</p>
d905 12
a916 147
<p align =center>
<img width="64" height="64" src="WebImage/sma069.gif">
<img width="64" height="64" src="WebImage/casrF01out_069.gif">
<img width="64" height="64" src="WebImage/casrF02out_069.gif">
<img width="64" height="64" src="WebImage/casrF03out_069.gif">
<img width="64" height="64" src="WebImage/casrF04out_069.gif"></p>

<p>It is difficult to see what traits it has because of noise. With the
first three single eigenvalue reconstructions we can see that it has an
oval head, with eyes looking left, and a small mouth. The fourth
eigenvector does not "add" anything to our knowledge of the image
because there are only three attributes that carry information.
Threfore the fourth carries only noise </p>

<p>Below is the sample image again, and a reconstruction from the first
three eigenvectors combined. The image is from the seventh prototype
image shown in the source data area.</p>

<p align =center> <img width="64" height="64"
src="WebImage/sma069.gif"> <img width="64" height="64"
src="WebImage/casrF1_3out_069.gif"></p>

<a href="../../man/casr.html">CA SR</a> Hints
<ul>
   <li>"file prefix" is the response given for the "output file prefix" question from CA S 
   <li>"file #'s to be used" enter file numbers of images, if you enter a value 
        outside of #  of images (i.e. -1) then it can create a "virtual" image. 
        <a href="#virtual">See below</a>
   <li>"factors to be used" stands for which factors to be involved with the reconstitution
   <li>"output file template" needs at least one * at the end or it aborts program</ul>

<a href="WebText/casr.bat">Casr.bat</a> is a procedure file that will run
CA SR to re-constitute any image, or images, from the eigenvectors.

<p>Below we have the same "protoimage"images used to create the source
data, a sample image from each protoimage,and we also have re-created
the noisy samples using each eigenvector. The first row is the
protoimages used to create the 80 sample images, and the second row
consists of a sample image created from the protoimage above it. The
third row is each sample image re-created with only the first
eigenvector used. The next row includes the second eigenvector, and the
last includes all relevant eigenvectors.

<p align=center><img width="557" height="350"
src="WebImage/40faces.gif"><br></p>

<hr><a name="virtual"><h4>Create "Virtual" Images From Eigenvectors</h4>

<h4>Some new operations have been added that may be better, see <a href="#feb04">here</a></h4>

<p>CA SRD can create images or pixels that were not actually captured,
using eigenimages. To do this, the eigenvalues must be given. This can
be useful to interpolate images in between groups.

<br>To choose what values to use for eigenvalues, use the <a
href="#fm">factor maps.</a> If you try to use a value outside the range
of values for an eigenvalue, the results will be difficult to predict
and interpret.</p>

<p>The images for eigenvector 1 equal to -0.1 and 0.1 are shown in the
first two images. They "make sense" in that this vector controls
headshape only. These values were chosen because they are the most
extreme values shown on the factor maps.But the images for eigenvector
1 equal to -1 and 1,the last two images, do not represent "extreme"
roundness like one might think. This is because these values are
outside the range that they actually exist, i.e. the factor maps.</p>

<p align=center><img width="64" height="64" src="WebImage/casrv_0-6.gif">
<img width="64" height="64" src="WebImage/casrv_0-7.gif">
<img width="64" height="64" src="WebImage/casrv_0-2.gif">
<img width="64" height="64" src="WebImage/casrv_0-3.gif"></p>

<a href="../../man/casr.html">CA SR "Virtual"</a> Hints

<ul>
   <li>To begin the "virtual" reconstruction, user must enter a value 
       outside of their range of images(-1).
   <li>To determine coordinate values, consult a factor map.
   <li>Do not assume that a zero will fill the rest of the factor values to zero
   <li>see hints for CA SR above
</ul>

<a href="WebText/casrv.bat">Casrv.bat</a> is a procedure file that will
automate the creation of virtual images with CA SR operation.

<hr><a name="diff"><h4>Show Differences Between Images (Eigenimages)</h4>

<h4>Some new operations have been added that may be better, 
    see <a href="#feb04">here</a></h4>

<p>If it is useful to see the different eigenimages that are used to 
   recreate images, use CA SRD.</p>

<p align=center><img width="64" height="64" src="WebImage/avg180.gif">
<img width="64" height="64" src="WebImage/casrd1_69.gif">
<img width="64" height="64" src="WebImage/casrd2_69.gif">
<img width="64" height="64" src="WebImage/casrd3_69.gif"></p>

<p>The first image is the average among all 80 sample images. The next
three are the difference image for each useful eigenvector for one
image. The dark slivers in the first eigenvector image show that in
order to obtain the correct head shape for this image, we must add
black to either side of the face. Similarily, for the eyes we would
make the left side of each eye socket brighter, and the right side
darker. From the fourth image this image has a wide mouth .
<br><br>Below are the seperate difference eigenimages for another
image, as well as the combination of all three. This image has the
opposite of every trait of the image represented above. We can tell
because of white slivers on a dark background, right-hand side of the
eyes light, etc. The last image below is the composite of the first
three eigenimages.</p>

<p align=center><img width="64" height="64" src="WebImage/casrd4_19.gif">
<img width="64" height="64" src="WebImage/casrd5_19.gif">
<img width="64" height="64" src="WebImage/casrd6_19.gif">
<img width="64" height="64" src="WebImage/casrd8_19.gif"></p>

<p>Below is the average of all the images as well as the composite
difference eigenimage from above. When we add (superimpose) these
together we get the third image, a re-creation of the original sample
image. However, the re-creation has no noise. This is because we only
used the first three eigenimages. If we included the other five, then
we would have re-created the sample image, with noise.</p>

<p align=center><img width="64" height="64" src="WebImage/avg180.gif">
<img width="64" height="64" src="WebImage/casrd8_19.gif">
<img width="64" height="64" src="WebImage/addiff.gif"></p>

<a href="../../man/casrd.html">CA SRD </a> Hints<br>

<ul>
   <li>"prefix" is the name before _SEQ, _IMC, _PIX, etc.
   <li>an entry out of bounds has no useful purpose
   <li>see hints for CA SR above
</ul>

<a href="WebText/casrd.bat">Casrd.bat</a> is a procedure file that will run
CA SRD for you. Note that it is similar to <a
href="WebText/casr.bat">casr.bat</a> except for minor changes.

<hr><a name="web"><h4>View Dendrogram In WEB</h4>

<p>WEB can be used to view a dendrogram of the data instead of using <a
href="#hac">CL CLA</a>. Should also work with the output of <a
href="#clhc">CL HC</a>. WEB will display not only the usual dendrogram,
but also the average of all the images below a threshold, and the
number of images in each average.</p>
d918 21
a938 1
How To Use The WEB Dendrogram
d940 1
d942 24
a965 35
   <li>Run CL CLA(or CL HC), and request a cluster doc file. The doc
      file will use the minimum threshold as it's lowest value. Any
      information below this will be lost.
   <li>Make sure that your image files and dendro doc file have the
      same extension and are in the same folder, it's easier
   <li>Start WEB with your extension (i.e."WEB dat &") and use the
      command -> image to navigate to where the images and cluster files
      are. Press "OK".
   <li>Commands -> Dendrogram and select the cluster file.
   <li>When the Dendrogram window pops up, to see all of what you
      selected, choose lowest threshold option. All the variation that was
      carried over from the CL CLA operation is scaled from what the
      lowest level selected  to +1 above.
   <li>If the "show average images" option is selected, WEB will show
      the average of the lowest level shown. This is why having the images
      in the same folder as the dendrogram doc file is easier.</ol>

<p><a href="WebText/webdendro.bat">Webdendro.bat</a> is a procedure file that 
automates the running of CL CLA so that a new dendrogram document file is the 
only thing created, used to change the lower threshold.<br>

<a href="WebText/webdendoc.dat">Webdendoc.dat</a> is an example of 
a dendrogram document file. <br>

<a href="WebText/numbers.bat">Numbers.bat</a> is a procedure file to change the 
extensions of a whole series of images. Should not be a problem if follow 
number three above.</p>

<hr><h4>View Factor(Correspondence) Map In WEB and Compute Averages</h4>

<p>In WEB you view a factor map and select which images are similar using a 
"lasso" interface. Then the average of that group is computed and can be 
viewed or stored as a new image. Also, a SPIDER document file can be printed 
to what group each image was placed in. I believe that only images can be used, 
not pixels. </p>
d967 11
a977 1
How To Use The WEB Factor Map
d979 4
a982 13
<ol>
   <li>Run the <a href="../../man/sdc.html">SD C</a> command in SPIDER
   <li>Start WEB with your extension (i.e."WEB dat &") and use 
       the command -> image and "accept" to navigate to where the cluster file is
   <li>If you are going to make image averages, the data files and 
       the SD C doc. file should be in the same folder and have the 
       same extension. It is easier
   <li>In WEB, Commands -> Corr-map. For explanation of window options, go 
       <a href="http://www.wadsworth.org/spider_doc/web/docs/corrmap.html">here</a>.
   <li>When you "accept", a WEB window will appear, with either numbers or circles 
       representing the images, depending on the "show image numbers" toggle. 
   <li>"Lasso" a group of images with the left mouse button, and after completely  
        enclosing the intended images, press the center button. A new window will appear.
d984 6
a989 21
   <ul>
      <li>"save images in Doc file" will open another window. From this new window 
          you can name the file, and specify which registers carries the X co-ordinate, 
          Y co-ordinate, and the order of that paticular group created during the run 
          of Corr-map. The first register always is the image number. Please remember 
          that the X and Y co-ordinates are actually the values of the eigenvectors 
         that was specified during the begining of corr-map. 
      <li>"display avg. image" will show an average of all included images on the screen. 
          It will not save that image. The "overlap" toggle controls where the 
          average is displayed.
      <li>"store avg. image" will save the average of the selected images, 
          but it will not be displayed on the screen.
      <li>"new masking" will return you to the image factor map
      <li>"continue masking" will do the same as new masking, except all the 
          selected image markers will be shadowed in green. Useful to see what 
          image markers have allready been catagorized.
      <li>"stop mapping" ends the corr-map function
   </ul>
   <li>Continue selecting image markers with new/continue masking until satisfied. 
       Note that one image can be in many different groups.
</ol>
d991 3
a993 46
<p><a href="WebText/sdcout.dat">Sdcout.dat</a> is the result of running
SD C on a _IMC file. It lists the image number and factor co-ordinates
of each image.<br> <a href="WebImage/corrmap.gif">Corrmap.gif</a> is a
screen-shot of a corr-map run. Please note the placement of the average
images. The upper-right image is overlaped with it's respective mask.
We can also see what two traits were being compared in this factor map,
head shape and eye direction.<br> 

<a href="WebText/docimg001.dat">Docimg001.dat</a> is the file created with
the "save images in Doc. file" option. It lists the image number, X and
Y co-ordinates and the order of group it was formed from. This
paticular group was the third formed, but the first image document
list.</p>

<h4><a name="casmi">CA SMI - Subgrouping images</h4>

<p>The primary purpose of CA SMI is to separate a series of images into
active/inactive groups. It appears that this can actually perform
operations on a series of images using the CA S files from another
series. This has not been tested. If the images used in CA SMI will be
used with their CA S run, it is a good idea to create a Postscript map
before running CA SMI for comparison later. The online manual page is
straightfoward, with a minor change.</p>

<a href="file:/net/bali/usr1/spider/docs/man/casmi.html">CA SMI</a> Hints

<ul>
   <li>Only tested with CORAN CA S output.
   <li>As of 5/11/04, the program does not ask for initial images/pixel
       input.
   <li>If using images with their "native" CA S run, be sure to compare
       the Postcript maps of before and after CA SMI. If they are not very
       similar, you must re-run CA S with "CN" instead of "C" as the fifth
       input.
   <li>As of 5/11/04, after CA SMI, if an odd factor is chosen in CA
       SM, it's axis will be flipped.
   <li>If using this to force certain images, from the same series,
       standout on a factor map(one group inactive, all others active), use
       <a href="#fm">CA SM</a> with (S)ymbol option(it's quicker).
</ul>

<p><a href="WebText/casmi.bat">Casmi.bat</a> is a procedure file that
automates the command. It is correct as of 5/11/04.<br> 
Below are the CA SM maps with no CA SMI input, and below those maps with CA SMI
input. Note the labeled images are the same in all three, but the axis
switch with an odd numbered factor.
d995 49
a1043 1
<h4>NOTE:</h4>
d1045 5
a1049 6
<p>
5/13/04 The axis switch is caused 
by using non-transposed data set. In order to have CA SMI run on this data, 
I forced CAS to not transpose the data, with the CN entry. Because of this, 
CA SM reads in the images different the transposed data. Be sure to take note 
of axes if using CA SMI -> CA SM</p>
d1051 4
a1054 4
<p align=center>
<a href="WebImage/casmireg1.gif">Factor 1 vs. Factor 2</a>      ---
<a href="WebImage/casmireg2.gif">Factor 1 vs. Factor 3</a>      ---  
<a href="WebImage/casmreg3.gif">Factor 2 vs. Factor 3</a></p>
d1056 11
a1066 49
<p align=center>
<a href="WebImage/casmiod1.gif">Factor 1 vs. Factor 2</a>      ---
<a href="WebImage/casmiod2.gif">Factor 1 vs. Factor 3</a>      ---  
<a href="WebImage/casmod3.gif">Factor 2 vs. Factor 3</a></p>

<h4><a name="casre">CA SRE - Viewing Eigenimages</h4>
<p>The purpose of CA SRE is to easily create eigenimages from CA S 
outputs. With eigenimages, the user can easily see what the computer 
has determined as the factors to classify images by. Tested this with 
CORAN output only.</p>

<a href="file:/net/bali/usr1/spider/docs/man/casre.html">CA SRE</a> Hints
<ul><li>None, works exactly as it should. Use the manual page.</ul>

<p><a href="WebText/casre.bat">Casre.bat</a> is a procedure file to automate 
running CA SRE. It assumes that if you want more than one factor, they 
are continuous. Also assumes that you are using CORAN output. Both of 
these assumptions are in the procedure file, not the operation. Edit the 
procedure file to change them. Below are some example results.</p>

<p align=center><img width="64" height="64" src="WebImage/eig1.gif">
<img width="64" height="64" src="WebImage/eig2.gif">
<img width="64" height="64" src="WebImage/eig3.gif">
<img width="64" height="64" src="WebImage/eig1to3.gif"></p>

<h4><a name="casra">CA SRA - To reconstitute Arbitary(Virtual) Images</h4>

<p>Very similar to <a href="#virtual">Virtual CA SR</a> above, but 
simpler. CA SRA does not require the input of a non-existing image 
to begin the virtual reconstitution.</p>

<a href="file:/net/bali/usr1/spider/docs/man/casra.html">CA SRA</a> Hints
<p><ul>
   <li>None, works exactly as it should. Use the manual page.
</ul></p>

<p><a href="WebText/casra.bat">Casra.bat</a> is the procedure file automation. </p>

<p><a href="WebText/casramontage.bat">Casramontage.bat</a> is the procedure file 
wrote to create the image below.<br>
The image below shows virtual images by changing only one eigenvalue at a time 
from -0.2 to 0.2 at regular intervals. The top row is eigenvalue one, and the 
bottom row eigenvalue three. Along each row all other eigenvalues were held to 
zero. The center column is identical baecause it is at this point that the 
varying eigenvalues are equal to zero. Reconstitution with all eigenvalues set 
to zero is equivalent to reconstiting the average of the series. If 
reconstitution of each indiviual eigenvalue had progressed to one, the result 
would be the first three images directly above. Reconstitution of the three 
eigenvalues together will result in the fourth image above.</p>
a1067 1
<p align=center><img src="WebImage/18fade.gif"></p>
d1069 1
a1069 1
<hr>
d1073 13
a1085 3
<p>The official SPIDER web page. 
<a href="../../master.html">http://www.wadsworth.org/spider_doc/spider/docs/master.html</a>
</p>
d1088 8
a1095 1
Frank, J. (2006) <i>Three-Dimensional Electron Microscopy of Macromolecular Assemblies</i>. Oxford University Press, New York. 
d1097 1
a1097 2
<hr> 
<p><small>Updated: Jan 19, 2006</small></p>
@
