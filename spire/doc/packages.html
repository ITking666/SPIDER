<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>SPIRE - Installing prerequisites</title>
  <LINK href="style.css" type= text/css rel=stylesheet>
</head>
<body>
<table class="navi" cellpadding=8>
<tr>
<td>
Back: <a href="download.html">Download</a></td>
<td align="center">
Home: <a href="index.html">Table of Contents</a></td>
<td align="right">
Next: <a href="project.html">Spire Projects</a></td>
</tr></table>

<p></p>
<h2 align="center">Installing the required packages for Spire</h2>

<p>
<a href="#Required">Required packages</a><br>
<a href="#InstallNotes">Installation notes</a><br>
  <a href="#DefaultDirs"><span class="indent1">Default installation directories</span></a><br>
  <a href="#UnixPath"><span class="indent1">The PATH and multiple program versions</span></a><br>

<a href="#TclTk">Tcl/Tk</a><br>
  <a href="#InstallTcl"><span class="indent1">Installing Tcl/Tk</span></a><br>
  <a href="#checkBLT"><span class="indent1">The BLT package</span></a><br>

<a href="#Python">Python</a><br>
  <a href="#PythonVersion"><span class="indent1">Checking Python version</span></a><br>
  <a href="#InstallPython"><span class="indent1">Installing Python</span></a><br>
  <a href="#PyExec"><span class="indent1">Which executable version of Python is running?</span></a><br>
  <a href="#PyTclTk"><span class="indent1">Is Python seeing the correct Tcl/Tk?</span></a><br>

<a href="#Packages">Python packages</a><br>
    <a href="#site-pkg"><span class="indent1">The <code>site-packages</code> directory</span></a><br>
    <a href="#gotTkinter"><span class="indent1">Does Python have Tk?</span></a><br>
    <a href="#Pmw"><span class="indent1">Pmw</span></a><br>
    <a href="#PythonBLT"><span class="indent1">Can Python access BLT?</span></a><br>
    <a href="#PIL"><span class="indent1">PIL : the Python Imaging Library</span></a><br>
    <a href="#Numpy"><span class="indent1">Numpy</span></a><br>
    <a href="#Gnuplot"><span class="indent1">Gnuplot for Python</span></a><br>
</p>

<p><hr></p>

<p><a name="Required"></a><h3>Required packages</h3></p>

<p>Spire requires <b>SPIDER version 13</b> or later.</p>

<p>Spire is written in Python, and requires Python version 2.3 or later. For graphics, 
it uses Tkinter, the Python interface to Tcl/Tk (version 8.4 or later). Spire requires 
the following software packages (your system may already have these installed):</p>

<!-- ****** table of required packages and their links *********** -->
<p>
<table border=1 cellpadding=4 cellspacing=2 bgcolor="white">
<tr>
  <td> Tcl/Tk8.4  (or later)</td>  
  <td><a href="http://www.tcl.tk/software/tcltk">www.tcl.tk/software/tcltk</a></td>
</tr>
<tr>
  <td> BLT</td>  
  <td><a href="http://sourceforge.net/projects/blt/">sourceforge.net/projects/blt</a></td>
</tr>
<tr>
  <td> Python2.3 (or later)</td>
  <td><a href="http://www.python.org/download">www.python.org/download</a></td>
</tr>
<tr>
  <td> Python megawidgets (Pmw) </td> 
  <td><a href="http://sourceforge.net/projects/pmw">sourceforge.net/projects/pmw</a></td>
</tr>
<tr>
  <td> Python Imaging Library (PIL)</td>  
  <td><a href="http://www.pythonware.com/products/pil">www.pythonware.com/products/pil</a></td>
</tr>
<tr>
  <td> Numpy </td>  
  <td><a href="http://sourceforge.net/projects/numpy">sourceforge.net/projects/numpy</a></td>
</tr>
<tr>
  <td> Gnuplot.py </td>  
  <td><a href="http://gnuplot-py.sourceforge.net">gnuplot-py.sourceforge.net</a></td>
</tr>
</table>
</p>

<ul>
<p><li>Your system may already have these installed. Run testinstall.py in the Spire 
installation directory. If it finds all the necessary libraries then you are ready to install Spire.</li></p>

<p><li>
<i><b>If some packages are not installed on your system, they may be available on the 
Linux system disks, and the administrative tools may help resolve any dependencies. 
Many of the above packages are also available as Linux rpms.</b></i></li></p>

<p><li> 
Most computers come with Python and Tcl/Tk preinstalled. If Python is already present, 
you will need write permission in the <code>lib/python2.x/site-packages</code> directory 
to install Spire there. If you don't have write permission, or if the Python version is 
too old, you will need to <a href="#InstallPython">install your own Python</a>. This latter 
approach may require some changes to your <a href="#UnixPath">Unix PATH</a>.</li></p>

<p><li>
If you have problems with the project database, you may need 
<i>Berkeley DB system 4.1</i> from 
<a href="http://www.sleepycat.com/download/db/index.shtml">www.sleepycat.com/download/db/</a>, 
but this is standard on most Unix systems.</li></p>


</ul>

<p><hr></p>
<!-- ************ Install section ***************** -->
<p><a name="InstallNotes"></a><h3>Installation notes</h3></p>

<ol>
<li>
<p><a name="DefaultDirs"/><b>Default installation directories</b></p>

<p>Where a directory name is indicated in the examples below, be sure to substitute 
your own local directory.</p>

<p>
On Linux most of the following packages are installed in directories under 
<code>/usr/local</code> by default. A different installation directory may be specified, 
usually with the software package's configure command:
<pre>
    ./configure  --prefix=/your_preferred_installation_directory
</pre>
If you specify the installation directory, then make sure all packages refer to the same directory.
<p>NB: The installation directory is different from the source directory. The source 
directory is where you extract the *.tar.gz files, while the installation directory is the 
destination of the libraries and executables.</p>
</p></li>

<li>
<p><a name="UnixPath"/><b>The PATH variable and multiple program versions</b></p> 
<p>
Sometimes multiple versions of a software packages are installed in different directories. 
This can result in considerable confusion unless you specify explicitly which version of 
Python, Tcl/Tk, etc. you wish to use. The PATH environmental variable is a list of 
directories that are searched for executable programs. The following presumes some basic 
knowledge about Unix and the PATH variable, and also assumes you are running the C shell.</p>
<p>
To see your path, type the following at the Unix prompt (here shown as <code>#</code>)
<pre>
    # echo $PATH
    /bin:/usr/bin:/usr/local/bin:.
</pre>
This indicates that when a command is typed at the system prompt, these four directories 
(<code>bin, /usr/bin, /usr/local/bin</code>, and ".") are seached for an executable program.  
Often the path is set in the user's .cshrc file. You may have to alter your path to make 
sure that when you type <code>python</code> or <code>tclsh</code>, the desired version is 
executed.  After editing your .cshrc file to make path changes, you must run 
<code>source ~/.cshrc</code> before the changes can take effect (or open a new Unix window).
</p>

<p>
The Unix <i>where</i> command lists all locations of a program that can be found on your path:
<pre>
     # where python
    /usr/bin/python
    /usr/local/bin/python
</pre>
This listing shows there are two versions of Python installed.<br> The Unix <i>which</i> 
command shows which program would actually get executed from the command line.
<pre>
     # which python
    /usr/bin/python
</pre>
This indicates that <code>/usr/bin/python</code> would be executed if I typed in "python", 
because <code>/usr/bin</code> comes before <code>/usr/local/bin</code> on my path. 
</p></li>

<p><li>
The <code>extract</code> command shown below is a little script you can easily make: <br>
type <code>gunzip < $1 | tar xvf -</code> into a file called "extract", and make it executable:
<code>chmod 775 extract</code></li></p>

<p><li>
If you encounter an error and need to run <code>make</code> again, first run 
<code>make clean</code> to remove old files. To see options of the <code>configure</code> command, use
<pre>
    ./configure --help
</pre>
</li></p>
</ol>

<p><a name="TclTk"/><h3>Tcl/Tk</h3></p>

<p>Tcl and Tk are two different packages, and each must be installed. Tk, the graphics part, 
requires that Tcl is already installed.</p>

<p> <b>Check the Tcl version</b>: At the Unix prompt, type <code>tclsh</code>. This starts 
the Tcl prompt (<font class="tkprompt"><code>%</code></font>). To see the version, 
type <code>info tclversion</code>:
<pre>
    # tclsh
    <font class="tkprompt">%</font> info tclversion
    8.4
    <font class="tkprompt">%</font> exit
</pre>
(<code>info patchlevel</code> gives more version detail.)</p>

<p>If the version is 8.4 or greater, <a href="#checkBLT"> see if BLT is installed</a></p>

<p>If <code>tclsh</code> is not found, or the version is less than 8.4, then install Tcl and Tk
<a name="InstallTcl"/>  </p>

<p><b>Installing Tcl and Tk</i></b>
<p>
In the steps below, substitute your version for "8.4.x", and replace "/your/install/dir" 
with your actual installation directory.</p>
In the source directory with the zipped tcl tar file, extract the tar file, change to the 
tcl directory, and run the config program:
<pre>
    extract tcl8.4.x-src.tar.gz  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   # or:  gunzip tcl8.4.x-src.tar.gz | tar xvf
    cd tcl8.4.x/unix 
    ./configure  --prefix=/your/install/dir
</pre>
or just
<pre>
    ./configure
</pre>
If you do not specify a directory, Tcl will be installed under the <code>/usr/local</code> tree. 
After setting the configuration, compile the program:
<pre>
    make 
    make install
    cd ../..
</pre>
Then install Tk:
<pre>
    extract tk8.4.x-src.tar.gz
    cd tk8.4.x/unix
    ./configure  --prefix=/your/install/dir  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   # same dir as above
    make
    make install
    cd ../..
</pre>

<p>
The executable files (<code>tclsh8.4</code> and <code>wish8.4</code>) should now be in 
<code>/your/install_dir/bin</code>. For instance, if you installed Tcl with<br>
<code>./configure --prefix=/usr/local/spire</code><br>
then the above executables will be in <code>/usr/local/spire/bin</code>. This bin directory 
should be on your path (before any others with conflicting versions of Tcl/Tk). E.g., you can 
add the following line to the end of your .cshrc file:
<pre>
 set path =(/usr/your/install/dir/bin  $path)
</pre>
<p>
If you type <code>tclsh</code> at the Unix prompt, it may not find the newly installed version, 
because the name is actually <code>tclsh8.4</code>. One way around this is to make a symbolic 
link to the executable (Tk runs as a program called <code>wish</code>):
<pre>
    cd /usr/your/install/dir/bin
    ln -s tclsh8.4 tclsh
    ln -s wish8.4 wish
</pre>
If you now have <a href="#UnixPath">multiple versions</a> of Tcl, check which one gets executed. 
At the tclsh prompt, use the command <code>info nameofexecutable</code> to see the program that 
gets called when you type <code>tclsh</code>:
<pre>
    # tclsh
    <font class="tkprompt">%</font> info nameofexecutable
    /your/install/dir/bin/tclsh8.4
</pre>
You should see <code>bin/tclsh8.4</code> in the desired directory (e.g., the installation 
directory you specified with the <code>./configure</code> command).

<p><a name="checkBLT"/><b>BLT : a plotting package for Tk</b></p>

<p><i>Does Tcl have the BLT library?</i></p>
At the Tcl prompt (<font class="tkprompt"><code>%</code></font>), see if BLT 
is available with the <code>package require</code> command. If it finds BLT, it will print out the version:
<pre>
    # tclsh
    <font class="tkprompt">%</font> package require BLT
    2.4
</pre>
<p>If can't find it, then install BLT

<p><i>Installing BLT</i></p> Do the usual:
<pre>
    extract  BLT2.4z.tar.gz
    cd blt2.4z
    ./configure --prefix=/your/install/dir 
    make
    make install
</pre>
Check if your Tcl version now has the BLT package (you may have to 
<code>source .cshrc</code> or open a new window). Before you can check 
<a href="#PythonBLT">if Python can access BLT</a>, you need to have the 
<a href="#Pmw">Pmw</a> package installed.
<p>
The graphics tools <a href="guitools/ctfdemo.html">ctfdemo.py</a>,  
<a href="guitools/ctfmatch.html">ctfmatch.py</a>, and 
<a href="guitools/ctfgroup.html">ctfgroup.py</a> use the BLT package.</p>
<p><hr></p>

<p><a name="Python"/><h2>Python</h2></p>

<p><a name="PythonVersion"/><b>Check the version of Python</b></p>

At the Unix prompt, type <code>python</code>, which gives you the python prompt 
(<font class="pyprompt"><code>&gt;&gt;&gt;</code></font>). The version number 
appears right after the word "Python".
<pre>
    # python
    Python 2.3.3 (#2, May 25 2004, 10:53:39) [C] on irix6
    <font class="pyprompt">>>></font> (ctrl-D exits)
</pre>
If the version is 2.3 or greater, then <a href="#gotTkinter">see if Python can access Tk</a>.<br>
If Python is not found or the version is less than 2.3, then install Python.


<p><a name="InstallPython"/><b>Installing Python</b></p>
Substitute your Python version in place of "Python-2.5.1" below.
<pre>
    extract Python-2.5.1.tgz
    cd Python-2.5.1
    ./configure --prefix=/your/install/dir
    make
   (make test)   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # optional. It takes awhile.
    make install
</pre>
In a new window, can you run the <a href="#UnixPath">correct version of Python</a>? 
(you may have to <code>source .cshrc</code> or open a new window).

<p><a name="PyExec"/><b>Which executable version of Python is running?</b></p>
<p>
You can check if the python running is in fact the one you just installed by viewing 
the <code>sys.executable</code> attribute in Python:
<pre>
   # python
   <font class="pyprompt">>>></font> import sys
   <font class="pyprompt">>>></font> sys.executable
   '/your/install/dir/bin/python2.5'
</pre>
You can also check <a href="#Packages">Python's internal path</a> to see if it is in the correct location.

<p><a name="PyTclTk"/><b>Is Python seeing the correct Tcl/Tk?</b></p>

<p>Import Tkinter and start a Tk process (root), then use the process to send a command to Tcl:
<pre>
<font class="pyprompt">>>></font> import Tkinter
<font class="pyprompt">>>></font> root = Tkinter.Tk()
<font class="pyprompt">>>></font> root.tk.eval('info library')
'/your/install/dir/lib/tcl8.4'
</pre> 
You should see <code>lib/tcl8.4</code> in the directory containing the desired Tcl version.

<p><hr></p>

<p><a name="Packages"/><h3>Packages for Python</h3></p>

<p><a name="site-pkg"/><b>The <code>site-packages</code> directory</b></p>
<p>Packages are loaded into Python with the <code>import</code> command. Generally, you 
will get an error message if Python cannot import the package, otherwise it simply 
returns the Python prompt. Usually the package's <code>setup.py</code> program 
automatically installs the package into the Python <code>site_packages</code> directory. 
But sometimes you must copy the files there yourself. To find where the 
<code>site_packages</code> directory resides, import the <code>sys</code> module 
and view its path attribute:
<pre>
    # python
    <font class="pyprompt">>>></font> import sys
    <font class="pyprompt">>>></font> sys.path
    ['/usr/local/spire/lib/python25.zip','/usr/local/spire/lib/python2.5',
'/usr/local/spire/lib/python2.5/plat-linux2',...]
</pre>
<code>sys.path</code> is the list of directories Python searches. To make it a little easier to read, try:
<pre>
    <font class="pyprompt">>>></font> for p in sys.path: print p
    ... 

    /usr/local/spire/lib/python25.zip
    /usr/local/spire/lib/python2.5
    /usr/local/spire/lib/python2.5/plat-linux2
    /usr/local/spire/lib/python2.5/lib-tk
    /usr/local/spire/lib/python2.5/lib-dynload
    /usr/local/spire/lib/python2.5/site-packages
    <font class="pyprompt">>>></font> 
</pre>
In this example, Python was installed under <code>/usr/local/spire</code>, and the site-packages 
directory is <code>/usr/local/spire/lib/python2.4/site-packages</code>.

<p><a name="gotTkinter"/><b>Does Python have Tk?</b></p>

<p>Can Python access Tk? And is it the correct version? The Python interface to Tk is called 
<code>Tkinter</code>. Be careful with capitalization:
<pre>
    # python
    <font class="pyprompt">>>></font> import Tkinter
    <font class="pyprompt">>>></font> Tkinter.TkVersion
    8.4
</pre>
If it can't import Tkinter, or you see the wrong version, check that you're running the 
<a href="#Python">correct version of Python</a> when you type <code>python</code> at 
the Unix prompt (that is, <a href="#InstallPython">the version you installed</a>).

<p><a name="Pmw"/><b>Pmw : Python Megawidgets</b></p>

<p>See if Pmw is installed. Try to import Pmw at the Python prompt:
<pre>
    <font class="pyprompt">>>></font> import Pmw
    ImportError: No module named Pmw
</pre>
If it cannot find Pmw, check <a href="#Python">the Python version</a>.<br>
If Python is the correct version, then Pmw is not present: <a href="#InstallPmw">install Pmw</a>.

<p><a name="InstallPmw"/><i>Installing Pmw</i></p>

<p><a href="#Required">Download</a> and extract the Pmw distribution. There is no 
<code> configuration</code> or <code>make</code>, just copy the <code>Pmw</code> directory 
to the <a href="#Packages"><code>site_packages</code> directory</a>:
<pre>
    cp -r Pmw /usr/local/spire/lib/python2.4/site-packages
</pre>
Check that Python can now import Pmw.

<p><a name="PythonBLT"/><b>Can Python access BLT?</b></p>

Python accesses BLT via Pmw, so you need to first import Tkinter and Pmw, then start a Tkinter root window:
<pre>
    # python
    <font class="pyprompt">>>></font> import Tkinter
    <font class="pyprompt">>>></font> import Pmw
    <font class="pyprompt">>>></font> root = Tkinter.Tk()
    <font class="pyprompt">>>></font> Pmw.Blt.haveblt(root)
    True
</pre>
If it does not return <code>True</code>, check that <a href="#PyTclTk">
Python is accessing the correct Tcl</a>, and that <a href="#checkBLT">Tcl has BLT</a>.

<p><hr></p>
The following 3 packages usually just install with a variant of 
<code>setup.py</code>  (or <code>python setup.py</code>).

<p><a name="PIL"/><b>PIL : the Python Imaging Library</b></p>
<p>
<a href="#Required">PIL version 1.1.6</a> can handle the 
<a href="../../../docs/formats.html">SPIDER image format</a>.</p>
<pre>
   # extract Imaging-1.1.6.tar.gz
   # cd Imaging-1.1.6
   # python setup.py install
</pre>
   Then you should be able to import the Image module:
<pre>
   # python
   <font class="pyprompt">>>></font> import Image
   <font class="pyprompt">>>></font>
</pre>
<p>
The graphics tools <a href="guitools/qview.html">qview.py</a>,  
<a href="guitools/montage.html">montage.py</a>, and 
<a href="guitools/classavg.html">classavg.py</a> use the Image module.</p>

<p><a name="Numpy"/><b>Numpy</b></p>
<p>
Numpy, a Python package for scientific computing, is required by Gnuplot.py. 
</p>
<pre>
   extract numpy-1.1.1.tar.gz
   cd numpy-1.1.1
   python setup.py install
</pre>
<p>
In addition, you can can convert SPIDER images into Numeric arrays using the 
<a href="../../../docs/python/spipylib/array.html">SPIDER Python Library<a/>.</p>

<p><a name="Gnuplot"/><b>Gnuplot for Python</b></p>
<p>
Gnuplot.py is an interface that allows a Python program to send commands to gnuplot. 
Therefore it requires that gnuplot is installed.</p>
<pre>
   extract gnuplot-py-1.8.tar.gz
   cd gnuplot-py-1.8
   python setup.py install
</pre>

<p>
The <a href="guitools/pyplot.html">pyplot.py</a> utility uses the Gnuplot module.</p>


<p>
<img src="pics/spiderline.gif"><br>
<a href="download.html"><img src="pics/left_button.gif"></a>
<a href="index.html"><img src="pics/up_button.gif"></a>
<a href="project.html"><img src="pics/right_button.gif"></a>
</p>

</body>
</html>
