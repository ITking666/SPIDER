head	1.13;
access;
symbols
	best-code:1.10
	pre-named-reg:1.10
	pre_GPL:1.10
	prec_CA:1.9
	oct21:1.5;
locks; strict;
comment	@# @;


1.13
date	2014.01.12.16.39.33;	author leith;	state Exp;
branches;
next	1.12;

1.12
date	2012.01.06.16.57.09;	author leith;	state Exp;
branches;
next	1.11;

1.11
date	2009.09.09.12.32.22;	author leith;	state Exp;
branches;
next	1.10;

1.10
date	2005.07.15.16.46.32;	author leith;	state Exp;
branches;
next	1.9;

1.9
date	2002.02.12.18.14.37;	author leith;	state Exp;
branches;
next	1.8;

1.8
date	2001.10.09.20.02.47;	author leith;	state Exp;
branches;
next	1.7;

1.7
date	2001.03.02.20.38.11;	author leith;	state Exp;
branches;
next	1.6;

1.6
date	2001.01.03.22.15.54;	author pawel;	state Exp;
branches;
next	1.5;

1.5
date	99.07.30.14.15.06;	author pawel;	state Exp;
branches;
next	1.4;

1.4
date	98.12.29.20.12.04;	author pawel;	state Exp;
branches;
next	1.3;

1.3
date	98.12.28.18.33.13;	author leith;	state Exp;
branches;
next	1.2;

1.2
date	98.12.23.18.40.21;	author pawel;	state Exp;
branches;
next	1.1;

1.1
date	98.12.23.17.04.52;	author pawel;	state Exp;
branches;
next	;


desc
@OP command.
@


1.13
log
@enter
@
text
@
OP        Orientation of Projections in terms of Eulerian angles.   OP    
                                                               07/15/05

PURPOSE:  Determines orientations of N=>3 projections
          in terms of three Eulerian angles.

USAGE:    OP

          .IMAGES: IMG***
          [Enter template for 2D image file series.]

          .FILE NUMBERS: 1-11
          [Enter file numbers.]

	  .LENGTH OF LINE PROJECTION: 79
          [Enter length of 1D line projection to be used internally by the
           program.  The length has to be less than NX.]

	  .MINIMUM, MAXIMUM FREQUENCY: 0.0, 0.25
          [For each line projection only frequencies between minimum and maximum 
           will be used.  The default is 0.0, 0.5, which is the full 
           range.]

	  .ACCURACY OF THETA: 5
          [Enter accuracy of search in terms of theta angle.
           Theta accuracy will define a set of quasi-evenly distributed projections
           directions to be used in the program.  It is the same set as
           generated by command 'VO EA' for the same delta theta.]

          .MAXIMUM NUMBER OF CYCLES: 200
          [Enter maximum number of cycles the program should perform.  In some
           cases program may fail to terminate, so to prevent an 
           endless loop the maximum number of cycles has to set.]

          .DOCUMENT FILE WITH INITIAL ANGLES: initial_angles
          [Enter the name of the document file containing initial
           Eulerian angles for 2D images (psi, theta, phi).
           The angles can be either random, or can be estimated
           by other means.]

	  .DOCUMENT FILE: angles002
          [Enter the name of the output document file.  For each cycle
           resulting in a decrease of the discrepancy measure, new
           results will be appended to this document file.
           Key "-1" will have two columns: the current cycle number
           and the current value of the discrepancy measure.
           Keys from one to the number of 2D input images specified
           will contain Eulerian angles (psi, theta, phi) found.]

NOTES: 1. Input projections have to be centered.

       2. Eulerian angles can be used directly in 3D reconstruction
          programs to calculate a 3D structure.

       3. Implemented by P. Penczek.

       4. Command 'OP' implements orientation search strategy described
          in: Penczek P., J. Zhun, J. Frank.  A common-lines based method for determining 
          orientations for N>3 particle projections simultaneously.
          Ultramicroscopy, 63, 205-218 (1996).

SUBROUTINES: POLQS

CALLER:      UTIL3

'<pre>'
; Example

DE
  angsett

; Generate an initial set of random Eulerian angles
[dum]=0.0
DO  [i]=1,16
   [a] = RAN([dum])*360.
   [b] = RAN([dum])*180.
   [c] = RAN([dum])*360.
   SD [i],[a],[b],[c]
   angsett
ENDDO

SD E
  angsett

OP
  ahr***
  1-16
  80
  0.0, 0.156
  5
  20
  angsett
  rangles001

; Calculate 3D structure for the solution found.
DOC CREATE
  select
  1
  1-16

BP RP
  ahr***
  select
  40
  rangles001
  N
  rvol001
  1.0e-4,0.0
  60,0
  0,0
  0.5

EN
'</pre>'
@


1.12
log
@nx
@
text
@d13 1
a13 1
          .ENTER FILE NUMBERS: 1-11
@


1.11
log
@*** empty log message ***
@
text
@d18 1
a18 1
           program.  The length has to be less than NSAM.]
d71 1
a71 1
angsett
d82 1
d84 1
a84 1
angsett
d87 8
a94 8
ahr***
1-16
80
0.0, 0.156
5
20
angsett
rangles001
d98 3
a100 3
select
1
1-16
d103 10
a112 10
ahr***
select
40
rangles001
N
rvol001
1.0e-4,0.0
60,0
0,0
0.5
@


1.10
log
@Pawels bug fix for accuracy of theta only
@
text
@d67 1
d74 6
a79 5
DO LB1 I=1,16
   X21=RAN(X88)*360.
   X22=RAN(X88)*180.
   X23=RAN(X88)*360.
   SD X0,X21,X22,X23
d81 1
a81 1
LB1
d95 1
a95 1
; calculate 3D structure for the solution found.
d114 1
@


1.9
log
@*** empty log message ***
@
text
@d2 2
a3 2
OP        Orientation of Projections in terms of Eulerian angles. ||   OP    
                                                               02/12/02
d20 1
a20 1
	  .MINIMUM, MAXIMUM FREQUENCY: 0.0,0.25
d22 2
a23 1
           will be used.  The default is 0.0, 0.5, which is the full range.]
d25 2
a26 3
	  .ACCURACY OF PSI AND THETA: 1,5
          [Enter accuracy of search in terms of psi and theta angles.
           It is recommended to use psi accuracy = 1 (default).  
d87 2
a88 2
0.0,0.156
0,5
@


1.8
log
@cosmetic
@
text
@d3 1
a3 1
                                                               07/30/99
a72 1

a82 5
IMG
MD
SET MP
8

a97 1

@


1.7
log
@alignment
@
text
@d18 1
a18 1
	   program.  The length has to be less than NSAM.]
d29 1
a29 1
           generated by command VO EA for the same delta theta.]
d44 1
a44 1
	   resulting in a decrease of the discrepancy measure, new
@


1.6
log
@||
@
text
@d16 2
a17 2
	  .Length of line projection: 79
	  [Enter length of 1D line projection to be used internally by the
d20 2
a21 2
	  .Minimum, Maximum frequency: 0.0,0.25
	  [For each line projection only frequencies between minimum and maximum 
d25 2
a26 2
	  [Enter accuracy of search in terms of psi and theta angles.
	   It is recommended to use psi accuracy = 1 (default).  
d28 2
a29 2
	   directions to be used in the program.  It is the same set as
	   generated by command VO EA for the same delta theta.]
d43 1
a43 1
	  [Enter the name of the output document file.  For each cycle
d69 1
a69 1
de
d74 8
a81 5
do lb1 i=1,16
x21=ran(x88)*360.
x22=ran(x88)*180.
x23=ran(x88)*360.
sd x0,x21,x22,x23
a82 3
lb1
sd e
angsett
d85 2
a86 2
md
set mp
d89 1
a89 1
op
d100 1
a100 1
doc create
d111 1
a111 1
n
d118 1
a118 1
en
@


1.5
log
@*** empty log message ***
@
text
@d2 1
a2 1
OP        Orientation of Projections in terms of Eulerian angles.    OP    
@


1.4
log
@*** empty log message ***
@
text
@d3 1
a3 1
                                                               12/23/98
d13 1
a13 1
          .ENTER FILE NUMBERS:   1-11
d16 1
a16 1
	  .LENGTH OF PROJECTION, NUMBER OF FOURIER COEFFS.: 79,28
d18 1
a18 4
	   program.  The length has to be less than NSAM.  Enter number
	   of Fourier coefficients of line projections to be used.  It
	   has to be less than (length of projection -1)/2.  Only
	   Fourier coefficients from 1 to 28 will be used.
d20 4
d26 2
a27 2
	   It is recommended to use psi accuracy = 1.  Theta accuracy
	   will define a set of quasi-evenly distributed projections
d66 53
@


1.3
log
@source file name wrong & cosmetic
@
text
@d5 1
a5 1
PURPOSE:  Determines orientation of N=>3 projections
d17 1
a17 1
	  [Enter length of 1D line projection used internally by the
d31 2
a32 2
          [Enter maximum number of cycles the program will perform.  In some
           cases program will fail to terminate, so to prevent an 
d37 3
a39 1
           Eulerian angles for 2D images (psi, theta, phi).]
d43 6
a48 7
	  resulting
	   in a decrease of the discrepancy measure new results will be
	   appended to this document file.  Key "-1" will have two
	   columns: current cycle number and current value of the
	   discrepancy measure.  Keys from one to the number of 2D
	   input images specified will contain Eulerian angles (psi,
	   theta, phi) found.]
d53 1
a53 1
          programs to calculate 3D structure.
@


1.2
log
@*** empty log message ***
@
text
@d2 1
a2 1
OP        Orientation of Projections in terms of Eulerian angles.   OP    
d10 1
a10 1
          .Images: IMG***
d13 1
a13 1
          .ENTER FILE NUMBERS:      1-11
d16 13
a28 13
          .Length of projection, number of Fourier coeffs.: 79,28
          [Enter length of 1D line projection used internally by the
           program.  The length has to be less than NSAM.
           Enter number of Fourier coefficients of line projections to be used.
           It has to be less than (length of projection -1)/2.  Only Fourier
           coefficients from 1 to 28 will be used.
          
          .Accuracy of psi and theta:1,5
          [Enter accuracy of search in terms of psi and theta angles.
           It is recommended to use psi accuracy = 1.
           Theta accuracy will define a set of quasi-evenly distributed
           projections directions to be used in the program.  It is the same
           set as generated by command VO EA for the same delta theta.]
d30 1
a30 1
          .Maximum number of cycles: 200
d32 2
a33 2
           cases program will fail to terminate, so to prevent an endless
           loop the maximum number of cycles has to set.]
d35 1
a35 1
          .Document with initial angles FILE:initial_angles
d39 9
a47 7
          .DOCUMENT FILE:angles002
          [Enter the name of the output document file.  For each cycle resulting
           in a decrease of the discrepancy measure new results will be appended
           to this document file.  Key "-1" will have two columns: current cycle
           number and current value of the discrepancy measure.  Keys from one to
           the number of 2D input images specified will contain Eulerian angles
           (psi, theta, phi) found.]
d52 1
a52 1
          program to calculate 3D structure.
d56 1
a56 1
       4. Command OP implements orientation search strategy described
d61 1
a61 2

SUBROUTINES: POLSQ
@


1.1
log
@Initial revision
@
text
@d2 2
a3 2
OP        Orientation of Projections -                    OP    
          in terms of Eulerian angles.                   12/23/98
d35 1
a35 1
          .Document with initial angles FILE:initial_angless
d55 1
a55 1
          in: Penczek P., J. Zhun, J. Frank.  A common-linesbased method for determining 
@
